---
title: Объекты Principal и Identity
description: Ознакомьтесь с объектами Identity, которые представляют пользователей в .NET. Также ознакомьтесь с основными объектами, которые инкапсулируют объект Identity & роли.
ms.date: 07/15/2020
helpviewer_keywords:
- WindowsIdentity objects
- GenericIdentity objects
- GenericPrincipal objects
- identity objects, about identity objects
- security [.NET], identity objects
- principal objects, about principal objects
- security [.NET], principals
- WindowsPrincipal objects
ms.assetid: aa5930ad-f3d7-40aa-b6f6-c6edcd5c64f7
ms.openlocfilehash: daa851e22ab70826395fa86a4d3aae9901e01be7
ms.sourcegitcommit: aab60b21144bf04b3057b5d59aa7c58edaef32d1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2021
ms.locfileid: "107494419"
---
# <a name="principal-and-identity-objects"></a>Объекты Principal и Identity

> [!NOTE]
> Эта статья относится к Windows.
>
> Сведения о ASP.NET Core см. в разделе [ASP.NET Core Security](/aspnet/core/security/).

Управляемый код может обнаружить удостоверение или роль участника с помощью <xref:System.Security.Principal.IPrincipal> объекта, который содержит ссылку на <xref:System.Security.Principal.IIdentity> объект. Может быть полезно сравнить объекты Identity и Principal с привычными понятиями, такими как учетные записи пользователей и групп. В большинстве сетевых сред учетные записи пользователей представляют пользователей или программы, а учетные записи групп — определенные категории пользователей и предоставленные им права. Аналогичным образом объекты удостоверений .NET представляют пользователей, а роли представляют членства и контексты безопасности. В .NET объект Principal инкапсулирует как объект Identity, так и роль. Приложения .NET предоставляют участникам права на основе удостоверения или, как правило, членства в роли.  
  
## <a name="identity-objects"></a>Объекты Identity

Identity — объект инкапсулирует сведения о проверяемом пользователе или сущности. На самом базовом уровне объект Identity содержит имя и тип проверки подлинности. В качестве имени может использоваться имя пользователя или учетной записи Windows, тогда как типом проверки подлинности может быть поддерживаемый протокол входа в систему, например Kerberos V5 или пользовательское значение. .NET определяет <xref:System.Security.Principal.GenericIdentity> объект, который можно использовать для большинства сценариев входа в систему, и более специализированный <xref:System.Security.Principal.WindowsIdentity> объект, который можно использовать, если приложение должно полагаться на проверку подлинности Windows. Кроме того, можно определить свой собственный класс Identity, который инкапсулирует особую информацию пользователя.  
  
<xref:System.Security.Principal.IIdentity>Интерфейс определяет свойства для доступа к имени и типу проверки подлинности, например Kerberos V5 или NTLM. Все классы **Identity** реализуют интерфейс **IIdentity**. Между объектом **Identity** и токеном процесса Windows, в котором выполняется поток, отсутствует обязательная связь. Однако если объект **Identity** является объектом **WindowsIdentity** , предполагается, что удостоверение представляет маркер безопасности Windows.  
  
## <a name="principal-objects"></a>Объекты Principal

Объект Principal, представляющий контекст безопасности, в котором работает код. Приложения, реализующие безопасность на основе ролей, предоставляют права на основании роли, связанной с объектом Principal. Как и объекты Identity, .NET предоставляет <xref:System.Security.Principal.GenericPrincipal> объект и <xref:System.Security.Principal.WindowsPrincipal> объект. Можно также определить собственные пользовательские классы Principal.  
  
<xref:System.Security.Principal.IPrincipal>Интерфейс определяет свойство для доступа к связанному объекту **Identity** , а также метод для определения того, является ли пользователь, определяемый объектом **Principal** , членом данной роли. Все классы **Principal** реализуют интерфейс **IPrincipal**, а также любые необходимые дополнительные свойства и методы. Например, среда CLR предоставляет класс **WindowsPrincipal** , который реализует дополнительные функции для сопоставления членства в группах с ролями.  
  
Объект **Principal** привязан к объекту контекста вызова ( <xref:System.Runtime.Remoting.Messaging.CallContext> ) в домене приложения ( <xref:System.AppDomain> ). Контекст вызова по умолчанию всегда создается с каждым новым **AppDomain**, поэтому всегда доступен контекст вызова для принятия объекта **Principal** . При создании нового потока для него также создается объект **CallContext**. Ссылка на объект **Principal** автоматически копируется из создаваемого потока в объект **CallContext** нового потока. Если среда выполнения не может определить, какой объект **Principal** принадлежит создателю потока, она применяет политику по умолчанию для создания объектов **Principal** и **Identity**.  
  
Настраиваемая политика для домена приложения определяет правила выбора типа объекта **Principal** для связи с новым доменом приложения. Если позволяет политика безопасности, среда выполнения может создать объекты **Principal** и **Identity**, которые отражают токен операционной системы, связанный с текущим потоком выполнения. По умолчанию среда выполнения использует объекты **Principal** и **Identity**, представляющие пользователей, не прошедших проверку подлинности. Среда выполнения не создаст такие объекты **Principal** и **Identity**, пока код не попытается получить к ним доступ.  
  
Доверенный код, создающий домен приложения, может установить политику домена приложения, которая управляет процессом создания объектов по умолчанию **Principal** и **Identity**. Такая политика домена приложения применяется ко всем выполняемым потокам в данном домене приложения. Неуправляемый доверенный узел по сути имеет возможность установить эту политику, но управляемый код, задающий эту политику, должен иметь <xref:System.Security.Permissions.SecurityPermission?displayProperty=nameWithType> для управления политикой домена.  
  
При передаче объекта **Principal** через домены приложений, но в рамках одного процесса (и, следовательно, на том же компьютере), инфраструктура удаленного взаимодействия копирует ссылку на объект **Principal**, связанный с контекстом вызывающей функции, в вызываемую функцию.  
  
## <a name="see-also"></a>См. также раздел

- [Практическое руководство. Создание объекта WindowsPrincipal](how-to-create-a-windowsprincipal-object.md)
- [Практическое руководство. Создание объектов GenericPrincipal и GenericIdentity](how-to-create-genericprincipal-and-genericidentity-objects.md)
- [Замена объекта Principal](replacing-a-principal-object.md)
- [Олицетворение и возвращение](impersonating-and-reverting.md)
- [Безопасность на основе ролей](role-based-security.md)
- [Основные понятия безопасности](key-security-concepts.md)
- [Безопасность ASP.NET Core](/aspnet/core/security/)
