---
title: Анализ кода в .NET
titleSuffix: ''
description: Сведения об анализе исходного кода в пакете SDK для .NET.
ms.date: 12/04/2020
ms.topic: overview
ms.custom: updateeachrelease
helpviewer_keywords:
- code analysis
- code analyzers
ms.openlocfilehash: 9fbeee7475b49a5b6514d4983142ae3be5a2f026
ms.sourcegitcommit: 46cfed35d79d70e08c313b9c664c7e76babab39e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/10/2021
ms.locfileid: "102605299"
---
# <a name="overview-of-net-source-code-analysis"></a><span data-ttu-id="5e0d2-103">Обзор анализа исходного кода .NET</span><span class="sxs-lookup"><span data-stu-id="5e0d2-103">Overview of .NET source code analysis</span></span>

<span data-ttu-id="5e0d2-104">Анализаторы .NET Compiler Platform (Roslyn) проверяют код C# или Visual Basic на наличие проблем с качеством и стилем.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-104">.NET compiler platform (Roslyn) analyzers inspect your C# or Visual Basic code for code quality and style issues.</span></span> <span data-ttu-id="5e0d2-105">Начиная с .NET 5.0, эти анализаторы включены в пакет SDK для .NET. Их не нужно устанавливать отдельно.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-105">Starting in .NET 5.0, these analyzers are included with the .NET SDK and you don't need to install them separately.</span></span> <span data-ttu-id="5e0d2-106">Если ваш проект предназначен для .NET 5 или более поздней версии, анализ кода будет включен по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-106">If your project targets .NET 5 or later, code analysis is enabled by default.</span></span> <span data-ttu-id="5e0d2-107">Если ваш проект предназначен для другой реализации .NET, например .NET Core, .NET Standard или .NET Framework, необходимо вручную включить анализ кода, установив для свойства [EnableNETAnalyzers](../../core/project-sdk/msbuild-props.md#enablenetanalyzers) значение `true`.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-107">If your project targets a different .NET implementation, for example, .NET Core, .NET Standard, or .NET Framework, you must manually enable code analysis by setting the [EnableNETAnalyzers](../../core/project-sdk/msbuild-props.md#enablenetanalyzers) property to `true`.</span></span>

<span data-ttu-id="5e0d2-108">Если вы не хотите переходить на использование пакета SDK для .NET 5+, работаете с проектом, стиль которого отличается от стиля пакета SDK для .NET Framework, или предпочитаете использовать модель на основе пакетов NuGet, тогда вы можете воспользоваться анализаторами, которые также доступны в [пакете NuGet Microsoft.CodeAnalysis .NetAnalyzers](https://www.nuget.org/packages/Microsoft.CodeAnalysis.NetAnalyzers).</span><span class="sxs-lookup"><span data-stu-id="5e0d2-108">If you don't want to move to the .NET 5+ SDK, have a non-SDK-style .NET Framework project, or prefer a NuGet package-based model, the analyzers are also available in the [Microsoft.CodeAnalysis.NetAnalyzers NuGet package](https://www.nuget.org/packages/Microsoft.CodeAnalysis.NetAnalyzers).</span></span> <span data-ttu-id="5e0d2-109">Возможно, вы предпочтете модель на основе пакета для обновлений версий по требованию.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-109">You might prefer a package-based model for on-demand version updates.</span></span>

> [!NOTE]
> <span data-ttu-id="5e0d2-110">Анализаторы .NET не зависят от целевой платформы.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-110">.NET analyzers are target-framework agnostic.</span></span> <span data-ttu-id="5e0d2-111">То есть при работе с проектом не нужно ориентироваться на конкретную реализацию .NET.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-111">That is, your project does not need to target a specific .NET implementation.</span></span> <span data-ttu-id="5e0d2-112">Анализаторы можно использовать для проектов, предназначенных для `net5.0`, а также для более ранних версий .NET, таких как `netcoreapp3.1` и `net472`.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-112">The analyzers work for projects that target `net5.0` as well as earlier .NET versions, such as `netcoreapp3.1` and `net472`.</span></span> <span data-ttu-id="5e0d2-113">Однако для включения анализа кода с помощью свойства [EnableNETAnalyzers](../../core/project-sdk/msbuild-props.md#enablenetanalyzers) ваш проект должен содержать ссылку на [пакет SDK проекта](../../core/project-sdk/overview.md).</span><span class="sxs-lookup"><span data-stu-id="5e0d2-113">However, to enable code analysis using the [EnableNETAnalyzers](../../core/project-sdk/msbuild-props.md#enablenetanalyzers) property, your project must reference a [project SDK](../../core/project-sdk/overview.md).</span></span>

<span data-ttu-id="5e0d2-114">Если анализатор обнаруживает нарушения правил, он отправляет о них оповещение в виде предложения, предупреждения или ошибки, в зависимости от [настройки](configuration-options.md) каждого правила.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-114">If rule violations are found by an analyzer, they're reported as a suggestion, warning, or error, depending on how each rule is [configured](configuration-options.md).</span></span> <span data-ttu-id="5e0d2-115">Нарушения анализа кода появляются с префиксом CA или IDE. Этот префикс отличает их от ошибок компилятора.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-115">Code analysis violations appear with the prefix "CA" or "IDE" to differentiate them from compiler errors.</span></span>

## <a name="code-quality-analysis"></a><span data-ttu-id="5e0d2-116">Анализ качества кода</span><span class="sxs-lookup"><span data-stu-id="5e0d2-116">Code quality analysis</span></span>

<span data-ttu-id="5e0d2-117">Правила *анализа качества кода* (CAxxxx) проверяют код C# или Visual Basic на наличие проблем с безопасностью, производительностью, дизайном и т. д.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-117">*Code quality analysis* ("CAxxxx") rules inspect your C# or Visual Basic code for security, performance, design and other issues.</span></span> <span data-ttu-id="5e0d2-118">По умолчанию анализ включен для проектов, предназначенных для .NET 5.0 или более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-118">Analysis is enabled, by default, for projects that target .NET 5.0 or later.</span></span> <span data-ttu-id="5e0d2-119">Можно включить анализ кода для проектов, предназначенных для более ранних версий .NET, задав для свойства [EnableNETAnalyzers](../../core/project-sdk/msbuild-props.md#enablenetanalyzers) значение `true`.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-119">You can enable code analysis on projects that target earlier .NET versions by setting the [EnableNETAnalyzers](../../core/project-sdk/msbuild-props.md#enablenetanalyzers) property to `true`.</span></span> <span data-ttu-id="5e0d2-120">Кроме того, вы можете отключить анализ кода для своего проекта, установив для `EnableNETAnalyzers` значение `false`.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-120">You can also disable code analysis for your project by setting `EnableNETAnalyzers` to `false`.</span></span>

> [!TIP]
> <span data-ttu-id="5e0d2-121">Если вы используете Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="5e0d2-121">If you're using Visual Studio:</span></span>
>
> - <span data-ttu-id="5e0d2-122">Многие правила анализатора связаны с *исправлениями кода*, которые можно применить для устранения проблемы.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-122">Many analyzer rules have associated *code fixes* that you can apply to correct the problem.</span></span> <span data-ttu-id="5e0d2-123">Исправления кода показаны в меню со значком лампочки.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-123">Code fixes are shown in the light bulb icon menu.</span></span>
> - <span data-ttu-id="5e0d2-124">Вы можете включить или отключить анализ кода, щелкнув правой кнопкой мыши проект в Обозревателе решений и выбрав **Свойства** > **Анализ кода** > **Enable .NET analyzers** (Включить анализаторы .NET).</span><span class="sxs-lookup"><span data-stu-id="5e0d2-124">You can enable or disable code analysis by right-clicking on a project in Solution Explorer and selecting **Properties** > **Code Analysis** tab > **Enable .NET analyzers**.</span></span>

### <a name="enabled-rules"></a><span data-ttu-id="5e0d2-125">Включенные правила</span><span class="sxs-lookup"><span data-stu-id="5e0d2-125">Enabled rules</span></span>

<span data-ttu-id="5e0d2-126">По умолчанию в .NET 5.0 включены указанные ниже правила.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-126">The following rules are enabled, by default, in .NET 5.0.</span></span>

| <span data-ttu-id="5e0d2-127">ИД диагностики</span><span class="sxs-lookup"><span data-stu-id="5e0d2-127">Diagnostic ID</span></span> | <span data-ttu-id="5e0d2-128">Категория</span><span class="sxs-lookup"><span data-stu-id="5e0d2-128">Category</span></span> | <span data-ttu-id="5e0d2-129">Уровень серьезности</span><span class="sxs-lookup"><span data-stu-id="5e0d2-129">Severity</span></span> | <span data-ttu-id="5e0d2-130">Описание:</span><span class="sxs-lookup"><span data-stu-id="5e0d2-130">Description</span></span> |
| - | - | - | - |
| [<span data-ttu-id="5e0d2-131">CA1416</span><span class="sxs-lookup"><span data-stu-id="5e0d2-131">CA1416</span></span>](/visualstudio/code-quality/ca1416) | <span data-ttu-id="5e0d2-132">Совместимость</span><span class="sxs-lookup"><span data-stu-id="5e0d2-132">Interoperability</span></span> | <span data-ttu-id="5e0d2-133">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="5e0d2-133">Warning</span></span> | <span data-ttu-id="5e0d2-134">Анализатор совместимости платформ</span><span class="sxs-lookup"><span data-stu-id="5e0d2-134">Platform compatibility analyzer</span></span> |
| [<span data-ttu-id="5e0d2-135">CA1417</span><span class="sxs-lookup"><span data-stu-id="5e0d2-135">CA1417</span></span>](/visualstudio/code-quality/ca1417) | <span data-ttu-id="5e0d2-136">Совместимость</span><span class="sxs-lookup"><span data-stu-id="5e0d2-136">Interoperability</span></span> | <span data-ttu-id="5e0d2-137">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="5e0d2-137">Warning</span></span> | <span data-ttu-id="5e0d2-138">Не используйте `OutAttribute` в параметрах строки для P/Invokes</span><span class="sxs-lookup"><span data-stu-id="5e0d2-138">Do not use `OutAttribute` on string parameters for P/Invokes</span></span> |
| [<span data-ttu-id="5e0d2-139">CA1831</span><span class="sxs-lookup"><span data-stu-id="5e0d2-139">CA1831</span></span>](/visualstudio/code-quality/ca1831) | <span data-ttu-id="5e0d2-140">Производительность</span><span class="sxs-lookup"><span data-stu-id="5e0d2-140">Performance</span></span> | <span data-ttu-id="5e0d2-141">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="5e0d2-141">Warning</span></span> | <span data-ttu-id="5e0d2-142">При необходимости используйте `AsSpan` вместо индексаторов на основе диапазона для строки</span><span class="sxs-lookup"><span data-stu-id="5e0d2-142">Use `AsSpan` instead of range-based indexers for string when appropriate</span></span> |
| [<span data-ttu-id="5e0d2-143">CA2013</span><span class="sxs-lookup"><span data-stu-id="5e0d2-143">CA2013</span></span>](/visualstudio/code-quality/ca2013) | <span data-ttu-id="5e0d2-144">надежность;</span><span class="sxs-lookup"><span data-stu-id="5e0d2-144">Reliability</span></span> | <span data-ttu-id="5e0d2-145">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="5e0d2-145">Warning</span></span> | <span data-ttu-id="5e0d2-146">Не используйте `ReferenceEquals` с типами значений</span><span class="sxs-lookup"><span data-stu-id="5e0d2-146">Do not use `ReferenceEquals` with value types</span></span> |
| [<span data-ttu-id="5e0d2-147">CA2014</span><span class="sxs-lookup"><span data-stu-id="5e0d2-147">CA2014</span></span>](/visualstudio/code-quality/ca2014) | <span data-ttu-id="5e0d2-148">надежность;</span><span class="sxs-lookup"><span data-stu-id="5e0d2-148">Reliability</span></span> | <span data-ttu-id="5e0d2-149">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="5e0d2-149">Warning</span></span> | <span data-ttu-id="5e0d2-150">Не используйте `stackalloc` в циклах</span><span class="sxs-lookup"><span data-stu-id="5e0d2-150">Do not use `stackalloc` in loops</span></span> |
| [<span data-ttu-id="5e0d2-151">CA2015</span><span class="sxs-lookup"><span data-stu-id="5e0d2-151">CA2015</span></span>](/visualstudio/code-quality/ca2015) | <span data-ttu-id="5e0d2-152">надежность;</span><span class="sxs-lookup"><span data-stu-id="5e0d2-152">Reliability</span></span> | <span data-ttu-id="5e0d2-153">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="5e0d2-153">Warning</span></span> | <span data-ttu-id="5e0d2-154">Не определяйте методы завершения для типов, производных от <xref:System.Buffers.MemoryManager%601></span><span class="sxs-lookup"><span data-stu-id="5e0d2-154">Do not define finalizers for types derived from <xref:System.Buffers.MemoryManager%601></span></span> |
| [<span data-ttu-id="5e0d2-155">CA2200</span><span class="sxs-lookup"><span data-stu-id="5e0d2-155">CA2200</span></span>](/visualstudio/code-quality/ca2200) | <span data-ttu-id="5e0d2-156">Использование</span><span class="sxs-lookup"><span data-stu-id="5e0d2-156">Usage</span></span> | <span data-ttu-id="5e0d2-157">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="5e0d2-157">Warning</span></span> | <span data-ttu-id="5e0d2-158">Повторно порождайте исключения для сохранения сведений стека</span><span class="sxs-lookup"><span data-stu-id="5e0d2-158">Rethrow to preserve stack details</span></span>
| [<span data-ttu-id="5e0d2-159">CA2247</span><span class="sxs-lookup"><span data-stu-id="5e0d2-159">CA2247</span></span>](/visualstudio/code-quality/ca2247) | <span data-ttu-id="5e0d2-160">Использование</span><span class="sxs-lookup"><span data-stu-id="5e0d2-160">Usage</span></span> | <span data-ttu-id="5e0d2-161">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="5e0d2-161">Warning</span></span> | <span data-ttu-id="5e0d2-162">Аргумент, передаваемый конструктору TaskCompletionSource, должен иметь значение перечисления <xref:System.Threading.Tasks.TaskCreationOptions> вместо <xref:System.Threading.Tasks.TaskContinuationOptions></span><span class="sxs-lookup"><span data-stu-id="5e0d2-162">Argument passed to TaskCompletionSource constructor should be <xref:System.Threading.Tasks.TaskCreationOptions> enum instead of <xref:System.Threading.Tasks.TaskContinuationOptions></span></span> |

<span data-ttu-id="5e0d2-163">Вы можете изменить важность этих правил, чтобы отключить их или повысить их до уровня ошибок.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-163">You can change the severity of these rules to disable them or elevate them to errors.</span></span> <span data-ttu-id="5e0d2-164">Вы также можете [включить большее количество правил](#enable-additional-rules).</span><span class="sxs-lookup"><span data-stu-id="5e0d2-164">You can also [enable more rules](#enable-additional-rules).</span></span>

- <span data-ttu-id="5e0d2-165">Список правил, включенных в каждую версию пакета SDK для .NET, см. на странице[Выпуски анализатора](https://github.com/dotnet/roslyn-analyzers/blob/master/src/NetAnalyzers/Core/AnalyzerReleases.Shipped.md).</span><span class="sxs-lookup"><span data-stu-id="5e0d2-165">For a list of rules that are included with each .NET SDK version, see [Analyzer releases](https://github.com/dotnet/roslyn-analyzers/blob/master/src/NetAnalyzers/Core/AnalyzerReleases.Shipped.md).</span></span>
- <span data-ttu-id="5e0d2-166">Список всех правил качества кода см. на [этой странице](quality-rules/index.md).</span><span class="sxs-lookup"><span data-stu-id="5e0d2-166">For a list of all the code quality rules, see [Code quality rules](quality-rules/index.md).</span></span>

### <a name="enable-additional-rules"></a><span data-ttu-id="5e0d2-167">Включение дополнительных правил</span><span class="sxs-lookup"><span data-stu-id="5e0d2-167">Enable additional rules</span></span>

<span data-ttu-id="5e0d2-168">*Режим анализа* относится к предопределенной конфигурации анализа кода, в которой правила отключены или включены (несколько или все).</span><span class="sxs-lookup"><span data-stu-id="5e0d2-168">*Analysis mode* refers to a predefined code analysis configuration where none, some, or all rules are enabled.</span></span> <span data-ttu-id="5e0d2-169">В режиме анализа по умолчанию лишь небольшое количество правил [включено в качестве предупреждений сборки](#enabled-rules).</span><span class="sxs-lookup"><span data-stu-id="5e0d2-169">In the default analysis mode, only a small number of rules are [enabled as build warnings](#enabled-rules).</span></span> <span data-ttu-id="5e0d2-170">Вы можете изменить режим анализа для своего проекта, установив свойство [\<AnalysisMode>](../../core/project-sdk/msbuild-props.md#analysismode) в файле проекта.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-170">You can change the analysis mode for your project by setting the [\<AnalysisMode>](../../core/project-sdk/msbuild-props.md#analysismode) property in the project file.</span></span> <span data-ttu-id="5e0d2-171">Допустимые значения:</span><span class="sxs-lookup"><span data-stu-id="5e0d2-171">The allowable values are:</span></span>

| <span data-ttu-id="5e0d2-172">Значение</span><span class="sxs-lookup"><span data-stu-id="5e0d2-172">Value</span></span> | <span data-ttu-id="5e0d2-173">Описание</span><span class="sxs-lookup"><span data-stu-id="5e0d2-173">Description</span></span> |
| - | - |
| `AllDisabledByDefault` | <span data-ttu-id="5e0d2-174">Это самый консервативный режим.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-174">This is the most conservative mode.</span></span> <span data-ttu-id="5e0d2-175">По умолчанию все правила отключены.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-175">All rules are disabled by default.</span></span> <span data-ttu-id="5e0d2-176">Можно выборочно [принять](configuration-options.md) отдельные правила, чтобы включить их.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-176">You can selectively [opt into](configuration-options.md) individual rules to enable them.</span></span><br /><br />`<AnalysisMode>AllDisabledByDefault</AnalysisMode>` |
| `AllEnabledByDefault` | <span data-ttu-id="5e0d2-177">Это самый агрессивный режим.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-177">This is the most aggressive mode.</span></span> <span data-ttu-id="5e0d2-178">Все правила включены как предупреждения сборки.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-178">All rules are enabled as build warnings.</span></span> <span data-ttu-id="5e0d2-179">Вы можете выборочно [отказаться от](configuration-options.md) отдельных правил, чтобы отключить их.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-179">You can selectively [opt out of](configuration-options.md) individual rules to disable them.</span></span><br /><br />`<AnalysisMode>AllEnabledByDefault</AnalysisMode>` |
| `Default` | <span data-ttu-id="5e0d2-180">Режим по умолчанию, в котором одни правила включены как предупреждения, другие — только как предложения IDE Visual Studio с соответствующими исправлениями кода, а третьи — полностью отключены.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-180">The default mode, where a handful of rules are enabled as warnings, others are enabled only as Visual Studio IDE suggestions with corresponding code fixes, and the rest are disabled completely.</span></span> <span data-ttu-id="5e0d2-181">Вы можете выборочно [принять отдельные правила или отключить их](configuration-options.md).</span><span class="sxs-lookup"><span data-stu-id="5e0d2-181">You can selectively [opt into or out of](configuration-options.md) individual rules to disable them.</span></span><br /><br />`<AnalysisMode>Default</AnalysisMode>` |

<span data-ttu-id="5e0d2-182">Чтобы узнать уровень важности по умолчанию для каждого доступного правила и определить, включено ли правило в режиме анализа по умолчанию, см. [полный список правил](https://github.com/dotnet/roslyn-analyzers/blob/master/src/NetAnalyzers/Core/AnalyzerReleases.Shipped.md).</span><span class="sxs-lookup"><span data-stu-id="5e0d2-182">To find the default severity for each available rule and whether or not the rule is enabled in the default analysis mode, see the [full list of rules](https://github.com/dotnet/roslyn-analyzers/blob/master/src/NetAnalyzers/Core/AnalyzerReleases.Shipped.md).</span></span>

### <a name="treat-warnings-as-errors"></a><span data-ttu-id="5e0d2-183">Рассматривать предупреждения как ошибки</span><span class="sxs-lookup"><span data-stu-id="5e0d2-183">Treat warnings as errors</span></span>

<span data-ttu-id="5e0d2-184">Если вы используете флажок `-warnaserror` при сборке проектов, все предупреждения анализа кода также обрабатываются как ошибки.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-184">If you use the `-warnaserror` flag when you build your projects, all code analysis warnings are also treated as errors.</span></span> <span data-ttu-id="5e0d2-185">Если вы не хотите, чтобы предупреждения о качестве кода (CAxxxx) рассматривались как ошибки при наличии `-warnaserror`, вы можете установить для свойства MSBuild `CodeAnalysisTreatWarningsAsErrors` значение `false` в файле проекта.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-185">If you do not want code quality warnings (CAxxxx) to be treated as errors in presence of `-warnaserror`, you can set the `CodeAnalysisTreatWarningsAsErrors` MSBuild property to `false` in your project file.</span></span>

```xml
<PropertyGroup>
  <CodeAnalysisTreatWarningsAsErrors>false</CodeAnalysisTreatWarningsAsErrors>
</PropertyGroup>
```

<span data-ttu-id="5e0d2-186">Предупреждения анализа кода будут отображаться по-прежнему, но при этом они не будут нарушать сборку.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-186">You'll still see any code analysis warnings, but they won't break your build.</span></span>

### <a name="latest-updates"></a><span data-ttu-id="5e0d2-187">Последние обновления</span><span class="sxs-lookup"><span data-stu-id="5e0d2-187">Latest updates</span></span>

<span data-ttu-id="5e0d2-188">По умолчанию вы будете получать последние правила анализа кода и стандартные уровни важности правил при обновлении до более новых версий пакета SDK для .NET.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-188">By default, you'll get the latest code analysis rules and default rule severities as you upgrade to newer versions of the .NET SDK.</span></span> <span data-ttu-id="5e0d2-189">Если такое поведение вас не устраивает, например, если вы хотите убедиться, что новые правила включены или отключены, вы можете переопределить его одним из следующих способов:</span><span class="sxs-lookup"><span data-stu-id="5e0d2-189">If you don't want this behavior, for example, if you want to ensure that no new rules are enabled or disabled, you can override it in one of the following ways:</span></span>

- <span data-ttu-id="5e0d2-190">Задайте для свойства MSBuild `AnalysisLevel` определенное значение, чтобы заблокировать предупреждения для этого набора.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-190">Set the `AnalysisLevel` MSBuild property to a specific value to lock the warnings to that set.</span></span> <span data-ttu-id="5e0d2-191">При обновлении до более новой версии пакета SDK вы по-прежнему будете получать исправления ошибок для этих предупреждений, однако новые предупреждения не будут включены, а существующие не будут отключены.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-191">When you upgrade to a newer SDK, you'll still get bug fixes for those warnings, but no new warnings will be enabled and no existing warnings will be disabled.</span></span> <span data-ttu-id="5e0d2-192">Например, чтобы заблокировать набор правил для предупреждений, поставляемых с версией 5.0 пакета SDK для .NET, добавьте приведенную ниже запись в файл проекта.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-192">For example, to lock the set of rules to those that ship with version 5.0 of the .NET SDK, add the following entry to your project file.</span></span>

  ```xml
  <PropertyGroup>
    <AnalysisLevel>5.0</AnalysisLevel>
  </PropertyGroup>
  ```

  > [!TIP]
  > <span data-ttu-id="5e0d2-193">Значение по умолчанию для свойства `AnalysisLevel` — `latest`. Это означает, что вы всегда получаете последние правила анализа кода при переходе к использованию более новых версий пакета SDK для .NET.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-193">The default value for the `AnalysisLevel` property is `latest`, which means you always get the latest code analysis rules as you move to newer versions of the .NET SDK.</span></span>

  <span data-ttu-id="5e0d2-194">Дополнительные сведения и список возможных значений см. на странице [AnalysisLevel](../../core/project-sdk/msbuild-props.md#analysislevel).</span><span class="sxs-lookup"><span data-stu-id="5e0d2-194">For more information, and to see a list of possible values, see [AnalysisLevel](../../core/project-sdk/msbuild-props.md#analysislevel).</span></span>

- <span data-ttu-id="5e0d2-195">Установите [пакет NuGet Microsoft.CodeAnalysis.NetAnalyzers](https://github.com/dotnet/roslyn-analyzers#microsoftcodeanalysisnetanalyzers), чтобы отделить обновления правил от обновлений пакета SDK для .NET.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-195">Install the [Microsoft.CodeAnalysis.NetAnalyzers NuGet package](https://github.com/dotnet/roslyn-analyzers#microsoftcodeanalysisnetanalyzers) to decouple rule updates from .NET SDK updates.</span></span> <span data-ttu-id="5e0d2-196">Для проектов, предназначенных для .NET 5+, при установке пакета отключаются встроенные анализаторы SDK.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-196">For projects that target .NET 5+, installing the package turns off the built-in SDK analyzers.</span></span> <span data-ttu-id="5e0d2-197">Вы получите предупреждение о сборке, если пакет SDK содержит более новую версию сборки анализатора, чем пакет NuGet.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-197">You'll get a build warning if the SDK contains a newer analyzer assembly version than that of the NuGet package.</span></span> <span data-ttu-id="5e0d2-198">Чтобы отключить предупреждение, установите для свойства `_SkipUpgradeNetAnalyzersNuGetWarning` значение `true`.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-198">To disable the warning, set the `_SkipUpgradeNetAnalyzersNuGetWarning` property to `true`.</span></span>

  > [!NOTE]
  > <span data-ttu-id="5e0d2-199">При установке пакета NuGet Microsoft.CodeAnalysis.NetAnalyzers не нужно добавлять свойство [EnableNETAnalyzers](../../core/project-sdk/msbuild-props.md#enablenetanalyzers) в файл проекта или в файл *Directory.Build.props*.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-199">If you install the Microsoft.CodeAnalysis.NetAnalyzers NuGet package, you should not add the [EnableNETAnalyzers](../../core/project-sdk/msbuild-props.md#enablenetanalyzers) property to either your project file or a *Directory.Build.props* file.</span></span> <span data-ttu-id="5e0d2-200">После установки пакета NuGet и задания для свойства `EnableNETAnalyzers` значения `true` создастся предупреждение сборки.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-200">When the NuGet package is installed and the `EnableNETAnalyzers` property is set to `true`, a build warning is generated.</span></span>

## <a name="code-style-analysis"></a><span data-ttu-id="5e0d2-201">Анализ стиля кода</span><span class="sxs-lookup"><span data-stu-id="5e0d2-201">Code-style analysis</span></span>

<span data-ttu-id="5e0d2-202">Правила *анализа стиля кода* (IDExxxx) позволяют определять и поддерживать согласованный стиль кода в базе кода.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-202">*Code-style analysis* ("IDExxxx") rules enable you to define and maintain consistent code style in your codebase.</span></span> <span data-ttu-id="5e0d2-203">Параметры включения по умолчанию:</span><span class="sxs-lookup"><span data-stu-id="5e0d2-203">The default enablement settings are:</span></span>

- <span data-ttu-id="5e0d2-204">Сборка из командной строки: анализ стиля кода по умолчанию отключен для всех проектов .NET при сборке из командной строки.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-204">Command-line build: Code-style analysis is disabled, by default, for all .NET projects on command-line builds.</span></span>

  <span data-ttu-id="5e0d2-205">Начиная с .NET 5.0, вы можете [включить анализ стиля кода при сборке](#enable-on-build) как в командной строке, так и внутри Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-205">Starting in .NET 5.0, you can [enable code-style analysis on build](#enable-on-build), both at the command line and inside Visual Studio.</span></span> <span data-ttu-id="5e0d2-206">Нарушения стиля кода отображаются в виде предупреждений или ошибок с префиксом IDE.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-206">Code style violations appear as warnings or errors with an "IDE" prefix.</span></span> <span data-ttu-id="5e0d2-207">Это позволяет вам применять согласованные стили кода во время сборки.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-207">This enables you to enforce consistent code styles at build time.</span></span>

- <span data-ttu-id="5e0d2-208">Visual Studio: анализ стиля кода включен по умолчанию для всех проектов .NET внутри Visual Studio в виде [быстрых действий по рефакторингу кода](/visualstudio/ide/code-generation-in-visual-studio).</span><span class="sxs-lookup"><span data-stu-id="5e0d2-208">Visual Studio: Code-style analysis is enabled, by default, for all .NET projects inside Visual Studio as [code refactoring quick actions](/visualstudio/ide/code-generation-in-visual-studio).</span></span>

<span data-ttu-id="5e0d2-209">Полный список правил анализа стиля кода см. на [этой странице](style-rules/index.md).</span><span class="sxs-lookup"><span data-stu-id="5e0d2-209">For a full list of code-style analysis rules, see [Code style rules](style-rules/index.md).</span></span>

### <a name="enable-on-build"></a><span data-ttu-id="5e0d2-210">Включение при сборке</span><span class="sxs-lookup"><span data-stu-id="5e0d2-210">Enable on build</span></span>

<span data-ttu-id="5e0d2-211">С помощью пакета SDK для .NET 5.0 и более поздних версий вы можете включить анализ стиля кода при сборке из командной строки и в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-211">With the .NET 5.0 SDK and later versions, you can enable code-style analysis when building from the command-line and in Visual Studio.</span></span> <span data-ttu-id="5e0d2-212">(Однако по соображениям производительности [некоторые правила стиля кода](https://github.com/dotnet/roslyn/blob/9f87b444da9c48a4d492b19f8337339056bf2b95/src/Analyzers/Core/Analyzers/EnforceOnBuildValues.cs#L95) по-прежнему будут применяться только в IDE Visual Studio.)</span><span class="sxs-lookup"><span data-stu-id="5e0d2-212">(However, for performance reasons, [a handful of code-style rules](https://github.com/dotnet/roslyn/blob/9f87b444da9c48a4d492b19f8337339056bf2b95/src/Analyzers/Core/Analyzers/EnforceOnBuildValues.cs#L95) will still apply only in the Visual Studio IDE.)</span></span>

<span data-ttu-id="5e0d2-213">Выполните следующие действия, чтобы включить анализ стиля кода при сборке:</span><span class="sxs-lookup"><span data-stu-id="5e0d2-213">Follow these steps to enable code-style analysis on build:</span></span>

1. <span data-ttu-id="5e0d2-214">Установите для свойства MSBuild [EnforceCodeStyleInBuild](../../core/project-sdk/msbuild-props.md#enforcecodestyleinbuild) значение `true`.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-214">Set the MSBuild property [EnforceCodeStyleInBuild](../../core/project-sdk/msbuild-props.md#enforcecodestyleinbuild) to `true`.</span></span>

1. <span data-ttu-id="5e0d2-215">В файле *.editorconfig* [настройте](configuration-options.md) каждое правило стиля кода с префиксом IDE, которое вы хотите запускать при сборке как предупреждение или ошибку.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-215">In an *.editorconfig* file, [configure](configuration-options.md) each "IDE" code style rule that you wish to run on build as a warning or an error.</span></span> <span data-ttu-id="5e0d2-216">Пример.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-216">For example:</span></span>

   ```ini
   [*.{cs,vb}]
   # IDE0040: Accessibility modifiers required (escalated to a build warning)
   dotnet_diagnostic.IDE0040.severity = warning
   ```

   <span data-ttu-id="5e0d2-217">Кроме того, вы можете настроить всю категорию как предупреждение или ошибку по умолчанию, а затем выборочно отключить правила в этой категории, которые не нужно запускать при сборке.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-217">Alternatively, you can configure an entire category to be a warning or error, by default, and then selectively turn off rules in that category that you don't want to run on build.</span></span> <span data-ttu-id="5e0d2-218">Пример.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-218">For example:</span></span>

   ```ini
   [*.{cs,vb}]

   # Default severity for analyzer diagnostics with category 'Style' (escalated to build warnings)
   dotnet_analyzer_diagnostic.category-Style.severity = warning

   # IDE0040: Accessibility modifiers required (disabled on build)
   dotnet_diagnostic.IDE0040.severity = silent
   ```

> [!NOTE]
> <span data-ttu-id="5e0d2-219">Функция анализа стиля кода является экспериментальной и может отличаться в версиях .NET 5 и .NET 6.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-219">The code-style analysis feature is experimental and may change between the .NET 5 and .NET 6 releases.</span></span>

## <a name="suppress-a-warning"></a><span data-ttu-id="5e0d2-220">Отключение предупреждений</span><span class="sxs-lookup"><span data-stu-id="5e0d2-220">Suppress a warning</span></span>

<span data-ttu-id="5e0d2-221">Один из способов пропустить нарушение правила — установить для параметра важности этого идентификатора правила значение `none` в файле EditorConfig.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-221">One way to suppress a rule violation is to set the severity option for that rule ID to `none` in an EditorConfig file.</span></span> <span data-ttu-id="5e0d2-222">Пример.</span><span class="sxs-lookup"><span data-stu-id="5e0d2-222">For example:</span></span>

```ini
dotnet_diagnostic.CA1822.severity = none
```

<span data-ttu-id="5e0d2-223">Дополнительные сведения и другие способы отключения предупреждений см. на [этой странице](suppress-warnings.md).</span><span class="sxs-lookup"><span data-stu-id="5e0d2-223">For more information and other ways to suppress warnings, see [How to suppress code analysis warnings](suppress-warnings.md).</span></span>

## <a name="third-party-analyzers"></a><span data-ttu-id="5e0d2-224">Сторонние анализаторы</span><span class="sxs-lookup"><span data-stu-id="5e0d2-224">Third-party analyzers</span></span>

<span data-ttu-id="5e0d2-225">Помимо официальных анализаторов .NET, вы также можете установить сторонние анализаторы, такие как [StyleCop](https://www.nuget.org/packages/StyleCop.Analyzers/), [Roslynator](https://www.nuget.org/packages/Roslynator.Analyzers/), [XUnit Analyzers](https://www.nuget.org/packages/xunit.analyzers/) и [Sonar Analyzer](https://www.nuget.org/packages/SonarAnalyzer.CSharp/).</span><span class="sxs-lookup"><span data-stu-id="5e0d2-225">In addition to the official .NET analyzers, you can also install third party analyzers, such as [StyleCop](https://www.nuget.org/packages/StyleCop.Analyzers/), [Roslynator](https://www.nuget.org/packages/Roslynator.Analyzers/), [XUnit Analyzers](https://www.nuget.org/packages/xunit.analyzers/), and [Sonar Analyzer](https://www.nuget.org/packages/SonarAnalyzer.CSharp/).</span></span>

## <a name="see-also"></a><span data-ttu-id="5e0d2-226">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="5e0d2-226">See also</span></span>

- [<span data-ttu-id="5e0d2-227">Справочник по правилам анализа качества кода</span><span class="sxs-lookup"><span data-stu-id="5e0d2-227">Code quality analysis rule reference</span></span>](quality-rules/index.md)
- [<span data-ttu-id="5e0d2-228">Справочник по правилам анализа стиля кода</span><span class="sxs-lookup"><span data-stu-id="5e0d2-228">Code style analysis rule reference</span></span>](style-rules/index.md)
- [<span data-ttu-id="5e0d2-229">Анализ кода в Visual Studio</span><span class="sxs-lookup"><span data-stu-id="5e0d2-229">Code analysis in Visual Studio</span></span>](/visualstudio/code-quality/roslyn-analyzers-overview)
- [<span data-ttu-id="5e0d2-230">Пакет SDK для .NET Compiler Platform</span><span class="sxs-lookup"><span data-stu-id="5e0d2-230">.NET Compiler Platform SDK</span></span>](../../csharp/roslyn-sdk/index.md)
- [<span data-ttu-id="5e0d2-231">Учебник. Создание средства для анализа и исправления кода</span><span class="sxs-lookup"><span data-stu-id="5e0d2-231">Tutorial: Write your first analyzer and code fix</span></span>](../../csharp/roslyn-sdk/tutorials/how-to-write-csharp-analyzer-code-fix.md)
