---
title: 'CA2012: используйте ValueTasks правильно (анализ кода)'
description: 'Сведения о правиле анализа кода CA2012: используйте ValueTasks правильно'
ms.date: 06/18/2020
ms.topic: reference
f1_keywords:
- UseValueTasksCorrectly
- CA2012
helpviewer_keywords:
- UseValueTasksCorrectly
- CA2012
author: stephentoub
ms.author: stoub
ms.openlocfilehash: e6bf3b099ce31e72027b9b749aefcd4a11b1f470
ms.sourcegitcommit: 05d0087dfca85aac9ca2960f86c5efd218bf833f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/30/2021
ms.locfileid: "99754749"
---
# <a name="ca2012-use-valuetasks-correctly"></a>CA2012: используйте ValueTasks правильно

| | Значение |
|-|-|
| **Идентификатор правила** |CA2012|
| **Категория** |[Надежность](reliability-warnings.md)|
| **Исправление является критическим или не критическим** |Не критическое|

## <a name="cause"></a>Причина

Экземпляр <xref:System.Threading.Tasks.ValueTask>, возвращенный из вызова члена, используется способом, который может привести к возникновению исключений, повреждению или ухудшению производительности.

## <a name="rule-description"></a>Описание правила

Экземпляры <xref:System.Threading.Tasks.ValueTask>, возвращаемые из вызовов членов, предназначены для непосредственного ожидания.  Попытки использовать ValueTask несколько раз или для прямого доступа к результату до его завершения могут привести к возникновению исключения или повреждения.  Игнорирование ValueTask, скорее всего, указывает на функциональную ошибку и может привести к снижению производительности.

## <a name="how-to-fix-violations"></a>Устранение нарушений

Как правило, экземпляры ValueTask следует ожидать непосредственно, а не отменять или хранить в других местах, таких как локальные переменные или поля.

## <a name="when-to-suppress-warnings"></a>Условия для отключения предупреждений

Что касается экземпляров ValueTask, возвращенных из произвольных вызовов членов, вызывающий объект должен допускать, что ValueTask следует использовать (например, ожидать) только один раз.  Однако если разработчик также управляет вызываемым членом и имеет полное представление о его реализации, ему может быть известно, что это предупреждение можно отключить, например, если возвращаемый экземпляр ValueTask всегда заключает объект <xref:System.Threading.Tasks.Task> в оболочку.

## <a name="see-also"></a>См. также раздел

- [Правила надежности](reliability-warnings.md)
