---
title: 'CA1401: методы P/Invoke не должны быть видимыми (анализ кода)'
description: 'Сведения о правиле анализа кода "CA1401: методы P/Invoke не должны быть видимыми"'
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- PInvokesShouldNotBeVisible
- CA1401
helpviewer_keywords:
- CA1401
- PInvokesShouldNotBeVisible
author: gewarren
ms.author: gewarren
dev_langs:
- CSharp
- VB
ms.openlocfilehash: f90ca8df32004376873207ee5203f5cb8e0276b2
ms.sourcegitcommit: 05d0087dfca85aac9ca2960f86c5efd218bf833f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/30/2021
ms.locfileid: "99777402"
---
# <a name="ca1401-pinvokes-should-not-be-visible"></a><span data-ttu-id="093ba-103">CA1401: методы P/Invoke не должны быть видимыми</span><span class="sxs-lookup"><span data-stu-id="093ba-103">CA1401: P/Invokes should not be visible</span></span>

|                                     | <span data-ttu-id="093ba-104">Значение</span><span class="sxs-lookup"><span data-stu-id="093ba-104">Value</span></span>                      |
|-------------------------------------|----------------------------|
| <span data-ttu-id="093ba-105">**Идентификатор правила**</span><span class="sxs-lookup"><span data-stu-id="093ba-105">**Rule ID**</span></span>                          | <span data-ttu-id="093ba-106">CA1401</span><span class="sxs-lookup"><span data-stu-id="093ba-106">CA1401</span></span>                     |
| <span data-ttu-id="093ba-107">**Категория**</span><span class="sxs-lookup"><span data-stu-id="093ba-107">**Category**</span></span>                        | [<span data-ttu-id="093ba-108">Взаимодействие</span><span class="sxs-lookup"><span data-stu-id="093ba-108">Interoperability</span></span>](interoperability-warnings.md) |
| <span data-ttu-id="093ba-109">**Исправление является критическим или не критическим**</span><span class="sxs-lookup"><span data-stu-id="093ba-109">**Fix is breaking or non-breaking**</span></span> | <span data-ttu-id="093ba-110">Критическое</span><span class="sxs-lookup"><span data-stu-id="093ba-110">Breaking</span></span>                   |

## <a name="cause"></a><span data-ttu-id="093ba-111">Причина</span><span class="sxs-lookup"><span data-stu-id="093ba-111">Cause</span></span>

<span data-ttu-id="093ba-112">Общедоступный или защищенный метод в общедоступном типе имеет атрибут <xref:System.Runtime.InteropServices.DllImportAttribute?displayProperty=fullName> (также реализуется ключевым словом `Declare` в Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="093ba-112">A public or protected method in a public type has the <xref:System.Runtime.InteropServices.DllImportAttribute?displayProperty=fullName> attribute (also implemented by the `Declare` keyword in Visual Basic).</span></span>

## <a name="rule-description"></a><span data-ttu-id="093ba-113">Описание правила</span><span class="sxs-lookup"><span data-stu-id="093ba-113">Rule description</span></span>

<span data-ttu-id="093ba-114">Методы, помеченные атрибутом <xref:System.Runtime.InteropServices.DllImportAttribute>, или методы, определенные с помощью ключевого слова `Declare` в Visual Basic, используют службы Platform Invocation Services для доступа к неуправляемому коду.</span><span class="sxs-lookup"><span data-stu-id="093ba-114">Methods that are marked with the <xref:System.Runtime.InteropServices.DllImportAttribute> attribute (or methods that are defined by using the `Declare` keyword in Visual Basic) use Platform Invocation Services to access unmanaged code.</span></span> <span data-ttu-id="093ba-115">Такие методы не следует делать видимыми.</span><span class="sxs-lookup"><span data-stu-id="093ba-115">Such methods should not be exposed.</span></span> <span data-ttu-id="093ba-116">Поддерживая эти методы как частные или внутренние, вы можете быть уверены, что никто не сможет воспользоваться библиотекой для нарушения безопасности путем разрешения вызывающим объектам доступа к неуправляемым API, которые иначе нельзя будет вызвать.</span><span class="sxs-lookup"><span data-stu-id="093ba-116">By keeping these methods private or internal, you make sure that your library cannot be used to breach security by allowing callers access to unmanaged APIs that they could not call otherwise.</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="093ba-117">Устранение нарушений</span><span class="sxs-lookup"><span data-stu-id="093ba-117">How to fix violations</span></span>

<span data-ttu-id="093ba-118">Чтобы исправить нарушение этого правила, измените уровень доступа этого метода.</span><span class="sxs-lookup"><span data-stu-id="093ba-118">To fix a violation of this rule, change the access level of the method.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="093ba-119">Условия для отключения предупреждений</span><span class="sxs-lookup"><span data-stu-id="093ba-119">When to suppress warnings</span></span>

<span data-ttu-id="093ba-120">Для этого правила отключать вывод предупреждений не следует.</span><span class="sxs-lookup"><span data-stu-id="093ba-120">Do not suppress a warning from this rule.</span></span>

## <a name="example"></a><span data-ttu-id="093ba-121">Пример</span><span class="sxs-lookup"><span data-stu-id="093ba-121">Example</span></span>

<span data-ttu-id="093ba-122">В следующем примере объявляется метод, нарушающий это правило.</span><span class="sxs-lookup"><span data-stu-id="093ba-122">The following example declares a method that violates this rule.</span></span>

:::code language="csharp" source="snippets/csharp/all-rules/ca1401.cs" id="snippet1":::

:::code language="vb" source="snippets/vb/all-rules/ca1401-p-invokes-should-not-be-visible_1.vb":::
