---
title: 'CA3076: выполнение небезопасного скрипта XSLT (анализ кода)'
description: 'Сведения о правиле анализа кода CA3076: небезопасное выполнение скрипта XSLT'
ms.date: 11/04/2016
ms.topic: reference
author: gewarren
ms.author: gewarren
ms.openlocfilehash: 36162e79add24270e495fb6952b89fde6243195b
ms.sourcegitcommit: 05d0087dfca85aac9ca2960f86c5efd218bf833f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/30/2021
ms.locfileid: "99776180"
---
# <a name="ca3076-insecure-xslt-script-execution"></a><span data-ttu-id="0c6f6-103">CA3076. Выполнение небезопасного скрипта XSLT</span><span class="sxs-lookup"><span data-stu-id="0c6f6-103">CA3076: Insecure XSLT Script Execution</span></span>

| | <span data-ttu-id="0c6f6-104">Значение</span><span class="sxs-lookup"><span data-stu-id="0c6f6-104">Value</span></span> |
|-|-|
| <span data-ttu-id="0c6f6-105">**Идентификатор правила**</span><span class="sxs-lookup"><span data-stu-id="0c6f6-105">**Rule ID**</span></span> |<span data-ttu-id="0c6f6-106">CA3076</span><span class="sxs-lookup"><span data-stu-id="0c6f6-106">CA3076</span></span>|
| <span data-ttu-id="0c6f6-107">**Категория**</span><span class="sxs-lookup"><span data-stu-id="0c6f6-107">**Category**</span></span> |[<span data-ttu-id="0c6f6-108">Безопасность</span><span class="sxs-lookup"><span data-stu-id="0c6f6-108">Security</span></span>](security-warnings.md)|
| <span data-ttu-id="0c6f6-109">**Исправление является критическим или не критическим**</span><span class="sxs-lookup"><span data-stu-id="0c6f6-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="0c6f6-110">Не критическое</span><span class="sxs-lookup"><span data-stu-id="0c6f6-110">Non-breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="0c6f6-111">Причина</span><span class="sxs-lookup"><span data-stu-id="0c6f6-111">Cause</span></span>

<span data-ttu-id="0c6f6-112">При небезопасном выполнении XSLT в приложениях .NET обработчик может разрешить недоверенные ссылки URI, раскрывающие конфиденциальную информацию злоумышленникам, что приведет к атакам типа "отказ в обслуживании" и межсайтовым атакам.</span><span class="sxs-lookup"><span data-stu-id="0c6f6-112">If you execute Extensible Stylesheets Language Transformations (XSLT) in .NET applications insecurely, the processor may resolve untrusted URI references that could disclose sensitive information to attackers, leading to Denial of Service and Cross-Site attacks.</span></span> <span data-ttu-id="0c6f6-113">Дополнительные сведения см. в статье [Рекомендации по безопасности XSLT (руководство по .NET)](../../../standard/data/xml/xslt-security-considerations.md).</span><span class="sxs-lookup"><span data-stu-id="0c6f6-113">For more information, see [XSLT Security Considerations(.NET Guide)](../../../standard/data/xml/xslt-security-considerations.md).</span></span>

## <a name="rule-description"></a><span data-ttu-id="0c6f6-114">Описание правила</span><span class="sxs-lookup"><span data-stu-id="0c6f6-114">Rule description</span></span>

<span data-ttu-id="0c6f6-115">**XSLT** — это стандарт консорциума W3C для преобразования данных XML.</span><span class="sxs-lookup"><span data-stu-id="0c6f6-115">**XSLT** is a World Wide Web Consortium (W3C) standard for transforming XML data.</span></span> <span data-ttu-id="0c6f6-116">XSLT обычно используется для записи таблиц стилей в целях преобразования данных XML в другие форматы, такие как HTML, текст фиксированной длины, текст с разделителями-запятыми или другой формат XML.</span><span class="sxs-lookup"><span data-stu-id="0c6f6-116">XSLT is typically used to write style sheets to transform XML data to other formats such as HTML, fixed-length text, comma-separated text, or a different XML format.</span></span> <span data-ttu-id="0c6f6-117">Хотя эта возможность по умолчанию запрещена, вы можете включить ее для проекта.</span><span class="sxs-lookup"><span data-stu-id="0c6f6-117">Although prohibited by default, you may choose to enable it for your project.</span></span>

<span data-ttu-id="0c6f6-118">Чтобы обезопасить вас от атак, это правило активируется каждый раз, когда XslCompiledTransform.<xref:System.Xml.Xsl.XslCompiledTransform.Load%2A></span><span class="sxs-lookup"><span data-stu-id="0c6f6-118">To ensure you're not exposing an attack surface, this rule triggers whenever the XslCompiledTransform.<xref:System.Xml.Xsl.XslCompiledTransform.Load%2A></span></span> <span data-ttu-id="0c6f6-119">получает небезопасную комбинацию экземпляров <xref:System.Xml.Xsl.XsltSettings> и <xref:System.Xml.XmlResolver>, которая допускает обработку вредоносных скриптов.</span><span class="sxs-lookup"><span data-stu-id="0c6f6-119">receives insecure combination instances of <xref:System.Xml.Xsl.XsltSettings> and <xref:System.Xml.XmlResolver>, which allows malicious script processing.</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="0c6f6-120">Устранение нарушений</span><span class="sxs-lookup"><span data-stu-id="0c6f6-120">How to fix violations</span></span>

- <span data-ttu-id="0c6f6-121">Замените небезопасный аргумент XsltSettings на XsltSettings.<xref:System.Xml.Xsl.XsltSettings.Default%2A></span><span class="sxs-lookup"><span data-stu-id="0c6f6-121">Replace the insecure XsltSettings argument with XsltSettings.<xref:System.Xml.Xsl.XsltSettings.Default%2A></span></span> <span data-ttu-id="0c6f6-122">или на экземпляр с отключенными функциями документов и выполнением скриптов.</span><span class="sxs-lookup"><span data-stu-id="0c6f6-122">or with an instance that has disabled document function and script execution.</span></span>

- <span data-ttu-id="0c6f6-123">Замените аргумент <xref:System.Xml.XmlResolver> на NULL или экземпляр <xref:System.Xml.XmlSecureResolver> .</span><span class="sxs-lookup"><span data-stu-id="0c6f6-123">Replace the <xref:System.Xml.XmlResolver> argument with null or an <xref:System.Xml.XmlSecureResolver> instance.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="0c6f6-124">Условия для отключения предупреждений</span><span class="sxs-lookup"><span data-stu-id="0c6f6-124">When to suppress warnings</span></span>

<span data-ttu-id="0c6f6-125">Отключайте правило этого предупреждения, только если уверены, что входные данные получены из доверенного источника.</span><span class="sxs-lookup"><span data-stu-id="0c6f6-125">Unless you're sure that the input is known to be from a trusted source, do not suppress a rule from this warning.</span></span>

## <a name="pseudo-code-examples"></a><span data-ttu-id="0c6f6-126">Примеры псевдокода</span><span class="sxs-lookup"><span data-stu-id="0c6f6-126">Pseudo-code examples</span></span>

### <a name="violation-that-uses-xsltsettingstrustedxslt"></a><span data-ttu-id="0c6f6-127">Нарушение, использующее XsltSettings.TrustedXslt</span><span class="sxs-lookup"><span data-stu-id="0c6f6-127">Violation that uses XsltSettings.TrustedXslt</span></span>

```csharp
using System.Xml;
using System.Xml.Xsl;

namespace TestNamespace
{
    class TestClass
    {
         void TestMethod()
        {
             XslCompiledTransform xslCompiledTransform = new XslCompiledTransform();
             var settings = XsltSettings.TrustedXslt;
             var resolver = new XmlUrlResolver();
             xslCompiledTransform.Load("testStylesheet", settings, resolver); // warn
        }
    }
}
```

### <a name="solution-that-uses-xsltsettingsdefault"></a><span data-ttu-id="0c6f6-128">Решение, использующее XsltSettings.Default</span><span class="sxs-lookup"><span data-stu-id="0c6f6-128">Solution that uses XsltSettings.Default</span></span>

```csharp
using System.Xml;
using System.Xml.Xsl;

namespace TestNamespace
{
    class TestClass
    {
        void TestMethod()
        {
            XslCompiledTransform xslCompiledTransform = new XslCompiledTransform();
            var settings = XsltSettings.Default;
            var resolver = new XmlUrlResolver();
            xslCompiledTransform.Load("testStylesheet", settings, resolver);
        }
    }
}
```

### <a name="violationmdashdocument-function-and-script-execution-not-disabled"></a><span data-ttu-id="0c6f6-129">Нарушение&mdash;функции документов и выполнение скриптов не отключены</span><span class="sxs-lookup"><span data-stu-id="0c6f6-129">Violation&mdash;document function and script execution not disabled</span></span>

```csharp
using System.Xml;
using System.Xml.Xsl;

namespace TestNamespace
{
    class TestClass
    {
        private static void TestMethod(XsltSettings settings)
        {
            try
            {
                XslCompiledTransform xslCompiledTransform = new XslCompiledTransform();
                var resolver = new XmlUrlResolver();
                xslCompiledTransform.Load("testStylesheet", settings, resolver); // warn
            }
            catch { throw; }
            finally { }
        }
    }
}
```

### <a name="solutionmdashdisable-document-function-and-script-execution"></a><span data-ttu-id="0c6f6-130">Решение&mdash;отключите функции документов и выполнение скриптов</span><span class="sxs-lookup"><span data-stu-id="0c6f6-130">Solution&mdash;disable document function and script execution</span></span>

```csharp
using System.Xml;
using System.Xml.Xsl;

namespace TestNamespace
{
    class TestClass
    {
        private static void TestMethod(XsltSettings settings)
        {
            try
            {
                XslCompiledTransform xslCompiledTransform = new XslCompiledTransform();
                settings.EnableDocumentFunction = false;
                settings.EnableScript = false;
                var resolver = new XmlUrlResolver();
                xslCompiledTransform.Load("testStylesheet", settings, resolver);
            }
            catch { throw; }
            finally { }
        }
    }
}
```

## <a name="see-also"></a><span data-ttu-id="0c6f6-131">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="0c6f6-131">See also</span></span>

- [<span data-ttu-id="0c6f6-132">Рекомендации по безопасности XSLT (руководство по .NET)</span><span class="sxs-lookup"><span data-stu-id="0c6f6-132">XSLT Security Considerations(.NET Guide)</span></span>](../../../standard/data/xml/xslt-security-considerations.md)
