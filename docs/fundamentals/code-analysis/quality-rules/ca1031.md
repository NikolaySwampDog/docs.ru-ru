---
title: 'CA1031: не перехватывайте типы общих исключений (анализ кода)'
description: 'Сведения о правиле анализа кода "CA1031: не перехватывайте типы общих исключений"'
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- CA1031
- DoNotCatchGeneralExceptionTypes
helpviewer_keywords:
- CA1031
- DoNotCatchGeneralExceptionTypes
author: gewarren
ms.author: gewarren
dev_langs:
- CSharp
- VB
ms.openlocfilehash: 4ce9629a92f85b6402edce30916261d3effbd176
ms.sourcegitcommit: 05d0087dfca85aac9ca2960f86c5efd218bf833f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/30/2021
ms.locfileid: "99547288"
---
# <a name="ca1031-do-not-catch-general-exception-types"></a><span data-ttu-id="a0242-103">CA1031. Не перехватывайте типы общих исключений</span><span class="sxs-lookup"><span data-stu-id="a0242-103">CA1031: Do not catch general exception types</span></span>

| <span data-ttu-id="a0242-104">Элемент</span><span class="sxs-lookup"><span data-stu-id="a0242-104">Item</span></span>                                     | <span data-ttu-id="a0242-105">Значение</span><span class="sxs-lookup"><span data-stu-id="a0242-105">Value</span></span>            |
|------------------------------------------|------------------|
| <span data-ttu-id="a0242-106">Идентификатор правила</span><span class="sxs-lookup"><span data-stu-id="a0242-106">RuleId</span></span>                                   | <span data-ttu-id="a0242-107">CA1031</span><span class="sxs-lookup"><span data-stu-id="a0242-107">CA1031</span></span>           |
| <span data-ttu-id="a0242-108">Категория</span><span class="sxs-lookup"><span data-stu-id="a0242-108">Category</span></span>                                 | [<span data-ttu-id="a0242-109">Microsoft.Design</span><span class="sxs-lookup"><span data-stu-id="a0242-109">Microsoft.Design</span></span>](design-warnings.md) |
| <span data-ttu-id="a0242-110">Исправление является критическим или не критическим</span><span class="sxs-lookup"><span data-stu-id="a0242-110">Fix is breaking or non-breaking</span></span> | <span data-ttu-id="a0242-111">Не критическое</span><span class="sxs-lookup"><span data-stu-id="a0242-111">Non-breaking</span></span>     |

## <a name="cause"></a><span data-ttu-id="a0242-112">Причина</span><span class="sxs-lookup"><span data-stu-id="a0242-112">Cause</span></span>

<span data-ttu-id="a0242-113">В инструкции `catch` перехватывается общее исключение, такое как <xref:System.Exception?displayProperty=fullName> или <xref:System.SystemException?displayProperty=fullName>, или используется общее предложение catch, такое как `catch()`.</span><span class="sxs-lookup"><span data-stu-id="a0242-113">A general exception such as <xref:System.Exception?displayProperty=fullName> or <xref:System.SystemException?displayProperty=fullName> is caught in a `catch` statement, or a general catch clause such as `catch()` is used.</span></span>

<span data-ttu-id="a0242-114">По умолчанию это правило помечает только общие типы исключений, но это можно [настроить](#configure-code-to-analyze).</span><span class="sxs-lookup"><span data-stu-id="a0242-114">By default, this rule only flags general exception types being caught, but this is [configurable](#configure-code-to-analyze).</span></span>

## <a name="rule-description"></a><span data-ttu-id="a0242-115">Описание правила</span><span class="sxs-lookup"><span data-stu-id="a0242-115">Rule description</span></span>

<span data-ttu-id="a0242-116">Общие исключения не должны перехватываться.</span><span class="sxs-lookup"><span data-stu-id="a0242-116">General exceptions should not be caught.</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="a0242-117">Устранение нарушений</span><span class="sxs-lookup"><span data-stu-id="a0242-117">How to fix violations</span></span>

<span data-ttu-id="a0242-118">Чтобы исправить нарушение этого правила, следует перехватить более конкретное исключение или повторно вызвать общее исключение в последнем операторе блока `catch`.</span><span class="sxs-lookup"><span data-stu-id="a0242-118">To fix a violation of this rule, catch a more specific exception, or rethrow the general exception as the last statement in the `catch` block.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="a0242-119">Условия для отключения предупреждений</span><span class="sxs-lookup"><span data-stu-id="a0242-119">When to suppress warnings</span></span>

<span data-ttu-id="a0242-120">Для этого правила отключать вывод предупреждений не следует.</span><span class="sxs-lookup"><span data-stu-id="a0242-120">Do not suppress a warning from this rule.</span></span> <span data-ttu-id="a0242-121">Перехват типов общих исключений может скрыть проблемы времени выполнения пользователя библиотеки и усложнить отладку.</span><span class="sxs-lookup"><span data-stu-id="a0242-121">Catching general exception types can hide run-time problems from the library user and can make debugging more difficult.</span></span>

> [!NOTE]
> <span data-ttu-id="a0242-122">Начиная с .NET Framework 4 общеязыковая среда выполнения (CLR) больше не поставляет исключения поврежденного состояния, происходящие в операционной системе и управляемом коде, такие как нарушения прав доступа в Windows, для обработки управляемым кодом.</span><span class="sxs-lookup"><span data-stu-id="a0242-122">Starting with .NET Framework 4, the common language runtime (CLR) no longer delivers corrupted state exceptions that occur in the operating system and managed code, such as access violations in Windows, to be handled by managed code.</span></span> <span data-ttu-id="a0242-123">Если вы хотите компилировать приложение в .NET Framework 4 или более поздней версии и поддерживать обработку исключений поврежденного состояния, можно применить атрибут <xref:System.Runtime.ExceptionServices.HandleProcessCorruptedStateExceptionsAttribute> к методу, обрабатывающему исключение поврежденного состояния.</span><span class="sxs-lookup"><span data-stu-id="a0242-123">If you want to compile an application in .NET Framework 4 or later versions and maintain handling of corrupted state exceptions, you can apply the <xref:System.Runtime.ExceptionServices.HandleProcessCorruptedStateExceptionsAttribute> attribute to the method that handles the corrupted state exception.</span></span>

## <a name="configure-code-to-analyze"></a><span data-ttu-id="a0242-124">Настройка кода для анализа</span><span class="sxs-lookup"><span data-stu-id="a0242-124">Configure code to analyze</span></span>

<span data-ttu-id="a0242-125">Используйте следующий параметр, чтобы выбрать части базы кода для применения этого правила.</span><span class="sxs-lookup"><span data-stu-id="a0242-125">Use the following option to configure which parts of your codebase to run this rule on.</span></span>

- [<span data-ttu-id="a0242-126">Недопустимые имена типов исключений</span><span class="sxs-lookup"><span data-stu-id="a0242-126">Disallowed exception type names</span></span>](#disallowed-exception-type-names)

<span data-ttu-id="a0242-127">Этот параметр можно настроить только для некоторого правила, для всех правил или для всех правил в этой категории ([конструктор](design-warnings.md)).</span><span class="sxs-lookup"><span data-stu-id="a0242-127">You can configure this option for just this rule, for all rules, or for all rules in this category ([Design](design-warnings.md)).</span></span> <span data-ttu-id="a0242-128">Дополнительные сведения см. в статье [Параметры конфигурации правила качества кода](../code-quality-rule-options.md).</span><span class="sxs-lookup"><span data-stu-id="a0242-128">For more information, see [Code quality rule configuration options](../code-quality-rule-options.md).</span></span>

### <a name="disallowed-exception-type-names"></a><span data-ttu-id="a0242-129">Недопустимые имена типов исключений</span><span class="sxs-lookup"><span data-stu-id="a0242-129">Disallowed exception type names</span></span>

<span data-ttu-id="a0242-130">Вы можете настроить, какие типы исключений запрещены для перехвата.</span><span class="sxs-lookup"><span data-stu-id="a0242-130">You can configure which exception types are disallowed from being caught.</span></span> <span data-ttu-id="a0242-131">Например, чтобы указать, что правило должно помечать обработчики `catch` флагом `NullReferenceException`, добавьте следующую пару "ключ-значение" в файл *.editorconfig* в своем проекте:</span><span class="sxs-lookup"><span data-stu-id="a0242-131">For example, to specify that the rule should flag `catch` handlers with `NullReferenceException`, add the following key-value pair to an *.editorconfig* file in your project:</span></span>

```ini
dotnet_code_quality.CA1031.disallowed_symbol_names = NullReferenceException
```

<span data-ttu-id="a0242-132">Допустимые форматы имен типов в значении параметра (разделенные `|`):</span><span class="sxs-lookup"><span data-stu-id="a0242-132">Allowed type name formats in the option value (separated by `|`):</span></span>

- <span data-ttu-id="a0242-133">только имя типа (включает все символы с этим именем независимо от типа и пространства имен);</span><span class="sxs-lookup"><span data-stu-id="a0242-133">Type name only (includes all symbols with the name, regardless of the containing type or namespace)</span></span>
- <span data-ttu-id="a0242-134">полные имена в [формате идентификатора документации](../../../csharp/programming-guide/xmldoc/processing-the-xml-file.md#id-strings) для символа с префиксом `T:`.</span><span class="sxs-lookup"><span data-stu-id="a0242-134">Fully qualified names in the symbol's [documentation ID format](../../../csharp/programming-guide/xmldoc/processing-the-xml-file.md#id-strings) with a `T:` prefix.</span></span>

<span data-ttu-id="a0242-135">Примеры:</span><span class="sxs-lookup"><span data-stu-id="a0242-135">Examples:</span></span>

| <span data-ttu-id="a0242-136">Значение параметра</span><span class="sxs-lookup"><span data-stu-id="a0242-136">Option Value</span></span> | <span data-ttu-id="a0242-137">Итоги</span><span class="sxs-lookup"><span data-stu-id="a0242-137">Summary</span></span> |
| --- | --- |
|`dotnet_code_quality.CA1031.disallowed_symbol_names = ExceptionType` | <span data-ttu-id="a0242-138">Соответствует всем символам с именем "ExceptionType" в компиляции</span><span class="sxs-lookup"><span data-stu-id="a0242-138">Matches all symbols named 'ExceptionType' in the compilation</span></span>
|`dotnet_code_quality.CA1031.disallowed_symbol_names = ExceptionType1|ExceptionType2` | <span data-ttu-id="a0242-139">Соответствует всем символам с именем "ExceptionType1" или "ExceptionType2" в компиляции</span><span class="sxs-lookup"><span data-stu-id="a0242-139">Matches all symbols named either 'ExceptionType1' or 'ExceptionType2' in the compilation</span></span>
|`dotnet_code_quality.CA1031.disallowed_symbol_names = T:NS.ExceptionType` | <span data-ttu-id="a0242-140">Соответствует определенным типам с именем "ExceptionType" и заданным полным именем.</span><span class="sxs-lookup"><span data-stu-id="a0242-140">Matches specific types named 'ExceptionType' with given fully qualified name.</span></span>
|`dotnet_code_quality.CA1031.disallowed_symbol_names = T:NS1.ExceptionType1|T:NS1.ExceptionType2` | <span data-ttu-id="a0242-141">Соответствует типам с именами "ExceptionType1" и "ExceptionType2" с соответствующими полными именами</span><span class="sxs-lookup"><span data-stu-id="a0242-141">Matches types named 'ExceptionType1' and 'ExceptionType2' with respective fully qualified names</span></span>

<span data-ttu-id="a0242-142">Эти параметры можно настроить только для указанного правила, для всех правил или для всех правил в этой категории ([разработка](design-warnings.md)).</span><span class="sxs-lookup"><span data-stu-id="a0242-142">You can configure these options for just this rule, for all rules, or for all rules in this category ([Design](design-warnings.md)).</span></span> <span data-ttu-id="a0242-143">Дополнительные сведения см. в статье [Параметры конфигурации правила качества кода](../code-quality-rule-options.md).</span><span class="sxs-lookup"><span data-stu-id="a0242-143">For more information, see [Code quality rule configuration options](../code-quality-rule-options.md).</span></span>

## <a name="example"></a><span data-ttu-id="a0242-144">Пример</span><span class="sxs-lookup"><span data-stu-id="a0242-144">Example</span></span>

<span data-ttu-id="a0242-145">В следующем примере показан тип, который нарушает правило, и тип, который правильно реализует блок `catch`.</span><span class="sxs-lookup"><span data-stu-id="a0242-145">The following example shows a type that violates this rule and a type that correctly implements the `catch` block.</span></span>

:::code language="vb" source="snippets/vb/all-rules/ca1031-do-not-catch-general-exception-types_1.vb":::

:::code language="csharp" source="snippets/csharp/all-rules/ca1031.cs" id="snippet1":::

## <a name="related-rules"></a><span data-ttu-id="a0242-146">Связанные правила</span><span class="sxs-lookup"><span data-stu-id="a0242-146">Related rules</span></span>

[<span data-ttu-id="a0242-147">CA2200. Повторно порождайте исключения для сохранения сведений стека</span><span class="sxs-lookup"><span data-stu-id="a0242-147">CA2200: Rethrow to preserve stack details</span></span>](ca2200.md)
