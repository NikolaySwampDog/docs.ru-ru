---
title: 'CA1502: избегайте чрезмерной сложности (анализ кода)'
description: 'Сведения о правиле анализа кода "CA1502: избегайте чрезмерной сложности"'
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- AvoidExcessiveComplexity
- CA1502
helpviewer_keywords:
- CA1502
- AvoidExcessiveComplexity
author: gewarren
ms.author: gewarren
dev_langs:
- CSharp
- VB
ms.openlocfilehash: 86dfcf73070cefc71b7a94ea5f0de385f41d4834
ms.sourcegitcommit: 05d0087dfca85aac9ca2960f86c5efd218bf833f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/30/2021
ms.locfileid: "99777363"
---
# <a name="ca1502-avoid-excessive-complexity"></a><span data-ttu-id="f2a62-103">CA1502. Избегайте чрезмерной сложности</span><span class="sxs-lookup"><span data-stu-id="f2a62-103">CA1502: Avoid excessive complexity</span></span>

| | <span data-ttu-id="f2a62-104">Значение</span><span class="sxs-lookup"><span data-stu-id="f2a62-104">Value</span></span> |
|-|-|
| <span data-ttu-id="f2a62-105">**Идентификатор правила**</span><span class="sxs-lookup"><span data-stu-id="f2a62-105">**Rule ID**</span></span> |<span data-ttu-id="f2a62-106">CA1502</span><span class="sxs-lookup"><span data-stu-id="f2a62-106">CA1502</span></span>|
| <span data-ttu-id="f2a62-107">**Категория**</span><span class="sxs-lookup"><span data-stu-id="f2a62-107">**Category**</span></span> |[<span data-ttu-id="f2a62-108">Удобство обслуживания</span><span class="sxs-lookup"><span data-stu-id="f2a62-108">Maintainability</span></span>](maintainability-warnings.md)|
| <span data-ttu-id="f2a62-109">**Исправление является критическим или не критическим**</span><span class="sxs-lookup"><span data-stu-id="f2a62-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="f2a62-110">Не критическое</span><span class="sxs-lookup"><span data-stu-id="f2a62-110">Non-breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="f2a62-111">Причина</span><span class="sxs-lookup"><span data-stu-id="f2a62-111">Cause</span></span>

<span data-ttu-id="f2a62-112">Метод имеет чрезмерную цикломатическую сложность.</span><span class="sxs-lookup"><span data-stu-id="f2a62-112">A method has an excessive cyclomatic complexity.</span></span>

## <a name="rule-description"></a><span data-ttu-id="f2a62-113">Описание правила</span><span class="sxs-lookup"><span data-stu-id="f2a62-113">Rule description</span></span>

<span data-ttu-id="f2a62-114">*Цикломатическая сложность* измеряет число линейно независимых путей в методе, которое определяется числом и сложностью условных ветвей.</span><span class="sxs-lookup"><span data-stu-id="f2a62-114">*Cyclomatic complexity* measures the number of linearly independent paths through the method, which is determined by the number and complexity of conditional branches.</span></span> <span data-ttu-id="f2a62-115">Низкая цикломатическая сложность обычно указывает, что метод прост в понимании, тестировании и обслуживании.</span><span class="sxs-lookup"><span data-stu-id="f2a62-115">A low cyclomatic complexity generally indicates a method that is easy to understand, test, and maintain.</span></span> <span data-ttu-id="f2a62-116">Цикломатическая сложность вычисляется на основе графа потока управления метода следующим образом:</span><span class="sxs-lookup"><span data-stu-id="f2a62-116">The cyclomatic complexity is calculated from a control flow graph of the method and is given as follows:</span></span>

<span data-ttu-id="f2a62-117">цикломатическая сложность = количество краев − количество узлов + 1</span><span class="sxs-lookup"><span data-stu-id="f2a62-117">cyclomatic complexity = the number of edges - the number of nodes + 1</span></span>

<span data-ttu-id="f2a62-118">*Узел* представляет логическую точку ветвления, а *край* — линию между узлами.</span><span class="sxs-lookup"><span data-stu-id="f2a62-118">A *node* represents a logic branch point and an *edge* represents a line between nodes.</span></span>

<span data-ttu-id="f2a62-119">Правило сообщает о нарушении, если цикломатическая сложность превышает 25.</span><span class="sxs-lookup"><span data-stu-id="f2a62-119">The rule reports a violation when the cyclomatic complexity is more than 25.</span></span>

<span data-ttu-id="f2a62-120">Дополнительные сведения о метриках кода см. в разделе [Измерение сложности управляемого кода](/visualstudio/code-quality/code-metrics-values).</span><span class="sxs-lookup"><span data-stu-id="f2a62-120">You can learn more about code metrics at [Measure complexity of managed code](/visualstudio/code-quality/code-metrics-values).</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="f2a62-121">Устранение нарушений</span><span class="sxs-lookup"><span data-stu-id="f2a62-121">How to fix violations</span></span>

<span data-ttu-id="f2a62-122">Для устранения нарушения этого правила выполните рефакторинг метода, чтобы уменьшить его цикломатическую сложность.</span><span class="sxs-lookup"><span data-stu-id="f2a62-122">To fix a violation of this rule, refactor the method to reduce its cyclomatic complexity.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="f2a62-123">Условия для отключения предупреждений</span><span class="sxs-lookup"><span data-stu-id="f2a62-123">When to suppress warnings</span></span>

<span data-ttu-id="f2a62-124">Вы можете отключить предупреждение из этого правила, если сложность уменьшить затруднительно, а метод прост в понимании, тестировании и обслуживании.</span><span class="sxs-lookup"><span data-stu-id="f2a62-124">It is safe to suppress a warning from this rule if the complexity cannot easily be reduced and the method is easy to understand, test, and maintain.</span></span> <span data-ttu-id="f2a62-125">В частности, можно подумать об отключении для метода, содержащего большую инструкцию `switch` (`Select` в Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="f2a62-125">In particular, a method that contains a large `switch` (`Select` in Visual Basic) statement is a candidate for exclusion.</span></span> <span data-ttu-id="f2a62-126">Риск дестабилизации базы кода на последующих этапах цикла разработки или внесение неожиданных изменений в поведение во время выполнения в ранее поставленном коде может перевесить преимущества удобства обслуживания в результате рефакторинга кода.</span><span class="sxs-lookup"><span data-stu-id="f2a62-126">The risk of destabilizing the code base late in the development cycle or introducing an unexpected change in run-time behavior in previously shipped code might outweigh the maintainability benefits of refactoring the code.</span></span>

## <a name="how-cyclomatic-complexity-is-calculated"></a><span data-ttu-id="f2a62-127">Как вычисляется цикломатическая сложность</span><span class="sxs-lookup"><span data-stu-id="f2a62-127">How cyclomatic complexity is calculated</span></span>

<span data-ttu-id="f2a62-128">Цикломатическая сложность вычисляется путем добавления 1 к следующим значениям:</span><span class="sxs-lookup"><span data-stu-id="f2a62-128">The cyclomatic complexity is calculated by adding 1 to the following:</span></span>

- <span data-ttu-id="f2a62-129">количеству ветвей (например, `if`, `while` и `do`);</span><span class="sxs-lookup"><span data-stu-id="f2a62-129">Number of branches (such as `if`, `while`, and `do`)</span></span>

- <span data-ttu-id="f2a62-130">количеству инструкций `case` в `switch`.</span><span class="sxs-lookup"><span data-stu-id="f2a62-130">Number of `case` statements in a `switch`</span></span>

## <a name="examples"></a><span data-ttu-id="f2a62-131">Примеры</span><span class="sxs-lookup"><span data-stu-id="f2a62-131">Examples</span></span>

<span data-ttu-id="f2a62-132">В следующих примерах показаны методы с разной цикломатической сложностью.</span><span class="sxs-lookup"><span data-stu-id="f2a62-132">The following examples show methods that have varying cyclomatic complexities.</span></span>

### <a name="cyclomatic-complexity-of-1"></a><span data-ttu-id="f2a62-133">Цикломатическая сложность 1</span><span class="sxs-lookup"><span data-stu-id="f2a62-133">Cyclomatic complexity of 1</span></span>

```csharp
public void Method()
{
    Console.WriteLine("Hello World!");
}
```

```vb
Public Sub Method()
    Console.WriteLine("Hello World!")
End Sub
```

### <a name="cyclomatic-complexity-of-2"></a><span data-ttu-id="f2a62-134">Цикломатическая сложность 2</span><span class="sxs-lookup"><span data-stu-id="f2a62-134">Cyclomatic complexity of 2</span></span>

```csharp
void Method(bool condition)
{
    if (condition)
    {
        Console.WriteLine("Hello World!");
    }
}
```

```vb
Public Sub Method(ByVal condition As Boolean)
    If (condition) Then
        Console.WriteLine("Hello World!")
    End If
End Sub
```

### <a name="cyclomatic-complexity-of-3"></a><span data-ttu-id="f2a62-135">Цикломатическая сложность 3</span><span class="sxs-lookup"><span data-stu-id="f2a62-135">Cyclomatic complexity of 3</span></span>

```csharp
public void Method(bool condition1, bool condition2)
{
    if (condition1 || condition2)
    {
        Console.WriteLine("Hello World!");
    }
}
```

```vb
Public Sub Method(ByVal condition1 As Boolean, ByVal condition2 As Boolean)
    If (condition1 OrElse condition2) Then
        Console.WriteLine("Hello World!")
    End If
End Sub
```

### <a name="cyclomatic-complexity-of-8"></a><span data-ttu-id="f2a62-136">Цикломатическая сложность 8</span><span class="sxs-lookup"><span data-stu-id="f2a62-136">Cyclomatic complexity of 8</span></span>

```csharp
public void Method(DayOfWeek day)
{
    switch (day)
    {
        case DayOfWeek.Monday:
            Console.WriteLine("Today is Monday!");
            break;
        case DayOfWeek.Tuesday:
            Console.WriteLine("Today is Tuesday!");
            break;
        case DayOfWeek.Wednesday:
            Console.WriteLine("Today is Wednesday!");
            break;
        case DayOfWeek.Thursday:
            Console.WriteLine("Today is Thursday!");
            break;
        case DayOfWeek.Friday:
            Console.WriteLine("Today is Friday!");
            break;
        case DayOfWeek.Saturday:
            Console.WriteLine("Today is Saturday!");
            break;
        case DayOfWeek.Sunday:
            Console.WriteLine("Today is Sunday!");
            break;
    }
}
```

```vb
Public Sub Method(ByVal day As DayOfWeek)
    Select Case day
        Case DayOfWeek.Monday
            Console.WriteLine("Today is Monday!")
        Case DayOfWeek.Tuesday
            Console.WriteLine("Today is Tuesday!")
        Case DayOfWeek.Wednesday
            Console.WriteLine("Today is Wednesday!")
        Case DayOfWeek.Thursday
            Console.WriteLine("Today is Thursday!")
        Case DayOfWeek.Friday
            Console.WriteLine("Today is Friday!")
        Case DayOfWeek.Saturday
            Console.WriteLine("Today is Saturday!")
        Case DayOfWeek.Sunday
            Console.WriteLine("Today is Sunday!")
    End Select
End Sub
```

## <a name="related-rules"></a><span data-ttu-id="f2a62-137">Связанные правила</span><span class="sxs-lookup"><span data-stu-id="f2a62-137">Related rules</span></span>

[<span data-ttu-id="f2a62-138">CA1501. Избегайте излишнего наследования</span><span class="sxs-lookup"><span data-stu-id="f2a62-138">CA1501: Avoid excessive inheritance</span></span>](ca1501.md)

## <a name="see-also"></a><span data-ttu-id="f2a62-139">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="f2a62-139">See also</span></span>

- [<span data-ttu-id="f2a62-140">Оценка сложности и удобства сопровождения управляемого кода</span><span class="sxs-lookup"><span data-stu-id="f2a62-140">Measuring Complexity and Maintainability of Managed Code</span></span>](/visualstudio/code-quality/code-metrics-values)
