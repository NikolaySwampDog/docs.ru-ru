---
title: 'CA2109: проверьте видимые обработчики событий (анализ кода)'
description: 'Сведения о правиле анализа кода "CA2109: проверьте видимые обработчики событий"'
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- CA2109
- ReviewVisibleEventHandlers
helpviewer_keywords:
- ReviewVisibleEventHandlers
- CA2109
author: gewarren
ms.author: gewarren
ms.openlocfilehash: 27f245e2740f114b8d055dcefedc24982d354158
ms.sourcegitcommit: 05d0087dfca85aac9ca2960f86c5efd218bf833f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/30/2021
ms.locfileid: "99720011"
---
# <a name="ca2109-review-visible-event-handlers"></a>CA2109. Проверьте видимые обработчики событий

| | Значение |
|-|-|
| **Идентификатор правила** |CA2109|
| **Категория** |[Безопасность](security-warnings.md)|
| **Исправление является критическим или не критическим** |Критическое|

## <a name="cause"></a>Причина

Обнаружен открытый или защищенный метод обработки событий.

## <a name="rule-description"></a>Описание правила

Видимый извне метод обработки событий представляет собой проблему безопасности, требующую проверки.

Не предоставляйте методы обработки событий, если это не является безусловной необходимостью. Обработчик событий, тип делегата, который вызывает предоставленный метод, может быть добавлен к любому событию, если сигнатуры обработчика и события совпадают. События могут быть вызваны любым кодом. Часто они вызываются системным кодом с высоким уровнем доверия в ответ на действия пользователя, такие как нажатие кнопки. Добавление проверки безопасности в метод обработки событий не мешает коду регистрировать обработчик событий, который вызывает метод.

Требование не может надежно защитить метод, вызываемый обработчиком событий. Требования безопасности помогают защитить код от недоверенного вызывающего объекта путем проверки вызывающих объектов в стеке вызовов. Код, добавляющий в событие обработчик событий, необязательно присутствует в стеке вызовов при запуске методов обработчика событий. Следовательно, при вызове метода обработчика событий стек вызовов может иметь только вызывающие объекты с высоким уровнем доверия. Это приводит к успешному выполнению требований, сделанных методом обработчика событий. Кроме того, запрошенное разрешение может быть утверждено при вызове метода. По этим причинам риск того, что нарушение этого правила не будет устранено, можно оценить только после изучения метода обработки событий. При проверке своего кода необходимо учитывать следующее.

- Выполняет ли ваш обработчик событий какие-либо операции, которые могут быть опасными или подверженными злонамеренному использованию, например утверждение разрешений или отмена разрешения неуправляемого кода?

- Какие угрозы безопасности несет в себе ваш код, если он может запускаться в любое время только вызывающими объектами с высоким уровнем доверия в стеке?

## <a name="how-to-fix-violations"></a>Устранение нарушений

Чтобы устранить нарушение этого правила, проверьте метод и оцените следующие аспекты.

- Можно ли сделать этот метод обработки событий закрытым?

- Можете ли вы убрать все опасные функции из обработчика событий?

- Если накладывается требование безопасности, можно ли это сделать каким-либо другим способом?

## <a name="when-to-suppress-warnings"></a>Условия для отключения предупреждений

Отключайте предупреждение из этого правила только после тщательной проверки безопасности, которая показывает, что ваш код не представляет угрозы безопасности.

## <a name="example"></a>Пример

В следующем коде показан метод обработки событий, который может быть использован вредоносным кодом.

:::code language="csharp" source="snippets/csharp/all-rules/ca2109.cs" id="snippet1":::

## <a name="see-also"></a>См. также раздел

- <xref:System.Security.CodeAccessPermission.Demand%2A?displayProperty=fullName>
- <xref:System.EventArgs?displayProperty=fullName>
