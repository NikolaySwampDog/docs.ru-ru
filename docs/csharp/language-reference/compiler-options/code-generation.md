---
description: Параметры компилятора C# для управления созданием кода. Эти параметры влияют на код, создаваемый компилятором для указанной компиляции.
title: Параметры компилятора C# — параметры создания кода
ms.date: 03/12/2021
f1_keywords:
- cs.build.options
helpviewer_keywords:
- DebugType compiler option [C#]
- Optimize compiler option [C#]
- Deterministic compiler option [C#]
- ProduceOnlyReferenceAssembly compiler option [C#]
ms.openlocfilehash: 6b66c50b408f9615bc3c63ab4dd46dbc4215c62f
ms.sourcegitcommit: 0bb8074d524e0dcf165430b744bb143461f17026
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2021
ms.locfileid: "103482489"
---
# <a name="c-compiler-options-that-control-code-generation"></a><span data-ttu-id="06bac-104">Параметры компилятора C#, которые управляют созданием кода</span><span class="sxs-lookup"><span data-stu-id="06bac-104">C# Compiler Options that control code generation</span></span>

<span data-ttu-id="06bac-105">Следующие параметры управляют созданием кода в компиляторе.</span><span class="sxs-lookup"><span data-stu-id="06bac-105">The following options control code generation by the compiler.</span></span> <span data-ttu-id="06bac-106">Новый синтаксис MSBuild выделен **полужирным шрифтом**.</span><span class="sxs-lookup"><span data-stu-id="06bac-106">The new MSBuild syntax is shown in **Bold**.</span></span> <span data-ttu-id="06bac-107">Для старого синтаксиса *csc.exe* используется формат `code style`.</span><span class="sxs-lookup"><span data-stu-id="06bac-107">The older *csc.exe* syntax is shown in `code style`.</span></span>

- <span data-ttu-id="06bac-108">**DebugType** / `-debug`: выдача (или невыдача) отладочных сведений.</span><span class="sxs-lookup"><span data-stu-id="06bac-108">**DebugType** / `-debug`: Emit (or don't emit) debugging information.</span></span>
- <span data-ttu-id="06bac-109">**Optimize** / `-optimize`: включение оптимизаций.</span><span class="sxs-lookup"><span data-stu-id="06bac-109">**Optimize** / `-optimize`: Enable optimizations.</span></span>
- <span data-ttu-id="06bac-110">**Deterministic** / `-deterministic`: создание эквивалентных (побайтовое сравнение) выходных данных для одного источника входных данных.</span><span class="sxs-lookup"><span data-stu-id="06bac-110">**Deterministic** / `-deterministic`: Produce byte-for-byte equivalent output from the same input source.</span></span>
- <span data-ttu-id="06bac-111">**ProduceOnlyReferenceAssembly** / `-refonly`: создание базовой сборки вместо полной сборки в качестве основного выходного файла.</span><span class="sxs-lookup"><span data-stu-id="06bac-111">**ProduceOnlyReferenceAssembly** / `-refonly`: Produce a reference assembly, instead of a full assembly, as the primary output.</span></span>

## <a name="debugtype"></a><span data-ttu-id="06bac-112">DebugType</span><span class="sxs-lookup"><span data-stu-id="06bac-112">DebugType</span></span>

<span data-ttu-id="06bac-113">При использовании параметра **DebugType** компилятор создает отладочные сведения и помещает их в выходном файле или файлах.</span><span class="sxs-lookup"><span data-stu-id="06bac-113">The **DebugType** option causes the compiler to generate debugging information and place it in the output file or files.</span></span> <span data-ttu-id="06bac-114">Отладочные сведения добавляются по умолчанию для конфигурации сборки *отладки*.</span><span class="sxs-lookup"><span data-stu-id="06bac-114">Debugging information is added by default for the *Debug* build configuration.</span></span> <span data-ttu-id="06bac-115">По умолчанию этот параметр отключен для конфигурации сборки *выпуска*.</span><span class="sxs-lookup"><span data-stu-id="06bac-115">It is off by default for the *Release* build configuration.</span></span>

```xml
<DebugType>pdbonly</DebugType>
```

<span data-ttu-id="06bac-116">Для всех версий компилятора, начиная с C# 6.0, разницы между *pdbonly* и *full* нет.</span><span class="sxs-lookup"><span data-stu-id="06bac-116">For all compiler versions starting with C# 6.0, there is no difference between *pdbonly* and *full*.</span></span> <span data-ttu-id="06bac-117">Выберите *pdbonly*.</span><span class="sxs-lookup"><span data-stu-id="06bac-117">Choose *pdbonly*.</span></span> <span data-ttu-id="06bac-118">Чтобы изменить расположение файла с расширением *.pdb*, см. раздел [**PdbFile**](./advanced.md#pdbfile).</span><span class="sxs-lookup"><span data-stu-id="06bac-118">To change the location of the *.pdb* file, see [**PdbFile**](./advanced.md#pdbfile).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="06bac-119">Этот раздел относится только к компиляторам более ранних версий, чем C# 6.0.</span><span class="sxs-lookup"><span data-stu-id="06bac-119">This section applies only to compilers older than C# 6.0.</span></span>
> <span data-ttu-id="06bac-120">Значение этого элемента может быть либо `full`, либо `pdbonly`.</span><span class="sxs-lookup"><span data-stu-id="06bac-120">The value of this element can be either `full` or `pdbonly`.</span></span> <span data-ttu-id="06bac-121">Аргумент *full*, действующий при отсутствии *pdbonly*, позволяет присоединить отладчик к выполняющейся программе.</span><span class="sxs-lookup"><span data-stu-id="06bac-121">The *full* argument, which is in effect if you don't specify *pdbonly*, enables attaching a debugger to the running program.</span></span> <span data-ttu-id="06bac-122">Определение *pdbonly* позволяет выполнять отладку исходного кода при запуске программы в отладчике, но при этом ассемблер отображается только при подключении выполняющейся программы к отладчику.</span><span class="sxs-lookup"><span data-stu-id="06bac-122">Specifying *pdbonly* allows source code debugging when the program is started in the debugger but will only display assembler when the running program is attached to the debugger.</span></span> <span data-ttu-id="06bac-123">Используйте этот параметр для создания отладочных сборок.</span><span class="sxs-lookup"><span data-stu-id="06bac-123">Use this option to create debug builds.</span></span> <span data-ttu-id="06bac-124">При использовании параметра *full* нужно учитывать некоторое влияние на скорость и размер оптимизированного кода JIT и незначительное влияние на качество кода с *full*.</span><span class="sxs-lookup"><span data-stu-id="06bac-124">If you use *Full*, be aware that there's some impact on the speed and size of JIT optimized code and a small impact on code quality with *full*.</span></span> <span data-ttu-id="06bac-125">Для создания кода выпуска рекомендуется использовать *pdbonly* или не использовать PDB.</span><span class="sxs-lookup"><span data-stu-id="06bac-125">We recommend *pdbonly* or no PDB for generating release code.</span></span> <span data-ttu-id="06bac-126">Разница между *pdbonly* и *full* заключается в том, что компилятор с *full* создает <xref:System.Diagnostics.DebuggableAttribute>, чтобы сообщить JIT-компилятору о доступности отладочных сведений.</span><span class="sxs-lookup"><span data-stu-id="06bac-126">One difference between *pdbonly* and *full* is that with *full* the compiler emits a <xref:System.Diagnostics.DebuggableAttribute>, which is used to tell the JIT compiler that debug information is available.</span></span> <span data-ttu-id="06bac-127">Поэтому если при использовании *full* код содержит <xref:System.Diagnostics.DebuggableAttribute> со значением false, вы получите сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="06bac-127">Therefore, you will get an error if your code contains the <xref:System.Diagnostics.DebuggableAttribute> set to false if you use *full*.</span></span> <span data-ttu-id="06bac-128">Дополнительные сведения о настройке производительности отладки для приложения см. в разделе [Упрощение отладки образов](../../../framework/debug-trace-profile/making-an-image-easier-to-debug.md).</span><span class="sxs-lookup"><span data-stu-id="06bac-128">For more information on how to configure the debug performance of an application, see [Making an Image Easier to Debug](../../../framework/debug-trace-profile/making-an-image-easier-to-debug.md).</span></span>

## <a name="optimize"></a><span data-ttu-id="06bac-129">Оптимизация</span><span class="sxs-lookup"><span data-stu-id="06bac-129">Optimize</span></span>

<span data-ttu-id="06bac-130">Параметр **Optimize** включает или отключает оптимизацию кода компилятором, чтобы сделать код более быстрым, коротким и эффективным.</span><span class="sxs-lookup"><span data-stu-id="06bac-130">The **Optimize** option enables or disables optimizations performed by the compiler to make your output file smaller, faster, and more efficient.</span></span> <span data-ttu-id="06bac-131">Параметр *Optimize* включен по умолчанию для конфигурации сборки *выпуска*.</span><span class="sxs-lookup"><span data-stu-id="06bac-131">The *Optimize* option is enabled by default for a *Release* build configuration.</span></span> <span data-ttu-id="06bac-132">По умолчанию этот параметр отключен для конфигурации сборки *отладки*.</span><span class="sxs-lookup"><span data-stu-id="06bac-132">It is off by default for a *Debug* build configuration.</span></span>

```xml
<Optimize>true</Optimize>
```

<span data-ttu-id="06bac-133">Параметр **Optimize** можно задать на странице свойств **сборки** для проекта в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="06bac-133">You set the **Optimize** option from **Build** properties page for your project in Visual Studio.</span></span>

<span data-ttu-id="06bac-134">Кроме того, параметр **Optimize** включает оптимизацию кода во время выполнения в общеязыковой среде выполнения.</span><span class="sxs-lookup"><span data-stu-id="06bac-134">**Optimize** also tells the common language runtime to optimize code at runtime.</span></span> <span data-ttu-id="06bac-135">По умолчанию оптимизация отключена.</span><span class="sxs-lookup"><span data-stu-id="06bac-135">By default, optimizations are disabled.</span></span> <span data-ttu-id="06bac-136">Чтобы включить оптимизацию, укажите **Optimize+** .</span><span class="sxs-lookup"><span data-stu-id="06bac-136">Specify **Optimize+** to enable optimizations.</span></span> <span data-ttu-id="06bac-137">При создании модуля для сборки используйте те же настройки **Optimize**, что и для сборки.</span><span class="sxs-lookup"><span data-stu-id="06bac-137">When building a module to be used by an assembly, use the same **Optimize** settings as used by the assembly.</span></span> <span data-ttu-id="06bac-138">Параметры **Optimize** и [**Debug**](#debugtype) можно комбинировать.</span><span class="sxs-lookup"><span data-stu-id="06bac-138">It's possible to combine the **Optimize** and [**Debug**](#debugtype) options.</span></span>

## <a name="deterministic"></a><span data-ttu-id="06bac-139">Детерминированное</span><span class="sxs-lookup"><span data-stu-id="06bac-139">Deterministic</span></span>

<span data-ttu-id="06bac-140">Указывает компилятору на необходимость создания сборки, чьи побайтовые выходные данные идентичны в разных компиляциях, если входные данные идентичны.</span><span class="sxs-lookup"><span data-stu-id="06bac-140">Causes the compiler to produce an assembly whose byte-for-byte output is identical across compilations for identical inputs.</span></span>

```xml
<Deterministic></Deterministic>
```

<span data-ttu-id="06bac-141">По умолчанию выходные данные компилятора из заданного набора входных данных являются уникальными, так как компилятор добавляет метку времени и идентификатор MVID, который создается из случайных чисел.</span><span class="sxs-lookup"><span data-stu-id="06bac-141">By default, compiler output from a given set of inputs is unique, since the compiler adds a timestamp and an MVID that is generated from random numbers.</span></span> <span data-ttu-id="06bac-142">Вы можете использовать параметр `<Deterministic>` для создания *детерминированной сборки*, двоичное содержимое которой идентично в разных компиляциях при условии, что входные данные не изменяются.</span><span class="sxs-lookup"><span data-stu-id="06bac-142">You use the `<Deterministic>` option to produce a *deterministic assembly*, one whose binary content is identical across compilations as long as the input remains the same.</span></span> <span data-ttu-id="06bac-143">В такой сборке поля timestamp и MVID будут заменены значениями, полученными из хэша всех входных данных компиляции.</span><span class="sxs-lookup"><span data-stu-id="06bac-143">In such a build, the timestamp and MVID fields will be replaced with values derived from a hash of all the compilation inputs.</span></span> <span data-ttu-id="06bac-144">Компилятор рассматривает следующие входные данные, которые влияют на детерминированность:</span><span class="sxs-lookup"><span data-stu-id="06bac-144">The compiler considers the following inputs that affect determinism:</span></span>

- <span data-ttu-id="06bac-145">Последовательность параметров командной строки.</span><span class="sxs-lookup"><span data-stu-id="06bac-145">The sequence of command-line parameters.</span></span>
- <span data-ttu-id="06bac-146">Содержимое RSP-файла ответов в компиляторе.</span><span class="sxs-lookup"><span data-stu-id="06bac-146">The contents of the compiler's .rsp response file.</span></span>
- <span data-ttu-id="06bac-147">Точная версия компилятора и его связанные сборки.</span><span class="sxs-lookup"><span data-stu-id="06bac-147">The precise version of the compiler used, and its referenced assemblies.</span></span>
- <span data-ttu-id="06bac-148">Текущий путь к каталогу.</span><span class="sxs-lookup"><span data-stu-id="06bac-148">The current directory path.</span></span>
- <span data-ttu-id="06bac-149">Двоичное содержимое всех файлов, явным образом переданных компилятору прямо или косвенно, в том числе:</span><span class="sxs-lookup"><span data-stu-id="06bac-149">The binary contents of all files explicitly passed to the compiler either directly or indirectly, including:</span></span>
  - <span data-ttu-id="06bac-150">Исходные файлы</span><span class="sxs-lookup"><span data-stu-id="06bac-150">Source files</span></span>
  - <span data-ttu-id="06bac-151">Связанные сборки</span><span class="sxs-lookup"><span data-stu-id="06bac-151">Referenced assemblies</span></span>
  - <span data-ttu-id="06bac-152">Связанные модули</span><span class="sxs-lookup"><span data-stu-id="06bac-152">Referenced modules</span></span>
  - <span data-ttu-id="06bac-153">Ресурсы</span><span class="sxs-lookup"><span data-stu-id="06bac-153">Resources</span></span>
  - <span data-ttu-id="06bac-154">Файл ключа строгого имени</span><span class="sxs-lookup"><span data-stu-id="06bac-154">The strong name key file</span></span>
  - <span data-ttu-id="06bac-155">Файлы ответов @</span><span class="sxs-lookup"><span data-stu-id="06bac-155">@ response files</span></span>
  - <span data-ttu-id="06bac-156">Анализаторы</span><span class="sxs-lookup"><span data-stu-id="06bac-156">Analyzers</span></span>
  - <span data-ttu-id="06bac-157">Наборы правил</span><span class="sxs-lookup"><span data-stu-id="06bac-157">Rulesets</span></span>
  - <span data-ttu-id="06bac-158">Другие файлы, которые могут использоваться анализаторами</span><span class="sxs-lookup"><span data-stu-id="06bac-158">Other files that may be used by analyzers</span></span>
- <span data-ttu-id="06bac-159">Текущий язык и региональные параметры (для языка сообщений о диагностике и исключениях).</span><span class="sxs-lookup"><span data-stu-id="06bac-159">The current culture (for the language in which diagnostics and exception messages are produced).</span></span>
- <span data-ttu-id="06bac-160">Кодировка по умолчанию (или текущая кодовая страница), если кодировка не указана.</span><span class="sxs-lookup"><span data-stu-id="06bac-160">The default encoding (or the current code page) if the encoding isn't specified.</span></span>
- <span data-ttu-id="06bac-161">Наличие, отсутствие и содержимое файлов на пути поиска компилятора (задается, например, с помощью `-lib` или `-recurse`).</span><span class="sxs-lookup"><span data-stu-id="06bac-161">The existence, non-existence, and contents of files on the compiler's search paths (specified, for example, by `-lib` or `-recurse`).</span></span>
- <span data-ttu-id="06bac-162">Платформа общеязыковой среды выполнения (CLR), на которой выполняется компилятор.</span><span class="sxs-lookup"><span data-stu-id="06bac-162">The Common Language Runtime (CLR) platform on which the compiler is run.</span></span>
- <span data-ttu-id="06bac-163">Значение `%LIBPATH%`, которое может повлиять на загрузку зависимостей анализатора.</span><span class="sxs-lookup"><span data-stu-id="06bac-163">The value of `%LIBPATH%`, which can affect analyzer dependency loading.</span></span>

<span data-ttu-id="06bac-164">Детерминированную компиляцию можно использовать, чтобы определить, компилируются ли двоичные данные из надежного источника.</span><span class="sxs-lookup"><span data-stu-id="06bac-164">Deterministic compilation can be used for establishing whether a binary is compiled from a trusted source.</span></span> <span data-ttu-id="06bac-165">Детерминированные выходные данные могут быть полезны, если источник является общедоступным.</span><span class="sxs-lookup"><span data-stu-id="06bac-165">Deterministic output can be useful when the source is publicly available.</span></span> <span data-ttu-id="06bac-166">Также с их помощью можно определить, будут ли шаги сборки, зависящие от изменений в двоичном файле, использоваться в процессе сборки.</span><span class="sxs-lookup"><span data-stu-id="06bac-166">It can also determine whether build steps that are dependent on changes to binary used in the build process.</span></span>

## <a name="produceonlyreferenceassembly"></a><span data-ttu-id="06bac-167">ProduceOnlyReferenceAssembly</span><span class="sxs-lookup"><span data-stu-id="06bac-167">ProduceOnlyReferenceAssembly</span></span>

<span data-ttu-id="06bac-168">Параметр **ProduceOnlyReferenceAssembly** указывает на то, что в качестве основных выходных данных должна быть выведена базовая сборка, а не сборка реализации.</span><span class="sxs-lookup"><span data-stu-id="06bac-168">The **ProduceOnlyReferenceAssembly** option indicates that a reference assembly should be output instead of an implementation assembly, as the primary output.</span></span> <span data-ttu-id="06bac-169">Параметр **ProduceOnlyReferenceAssembly** автоматически отключает вывод PDB, так как базовые сборки не могут выполняться.</span><span class="sxs-lookup"><span data-stu-id="06bac-169">The **ProduceOnlyReferenceAssembly** parameter silently disables outputting PDBs, as reference assemblies cannot be executed.</span></span>

```xml
<ProduceOnlyReferenceAssembly></ProduceOnlyReferenceAssembly>
```

<span data-ttu-id="06bac-170">Базовые сборки являются особым типом сборки,</span><span class="sxs-lookup"><span data-stu-id="06bac-170">Reference assemblies are a special type of assembly.</span></span> <span data-ttu-id="06bac-171">которая содержит только минимальный объем метаданных, необходимый для представления общедоступного API библиотеки.</span><span class="sxs-lookup"><span data-stu-id="06bac-171">Reference assemblies contain only the minimum amount of metadata required to represent the library's public API surface.</span></span> <span data-ttu-id="06bac-172">Такие сборки включают в себя объявления для всех элементов, которые важны при указании ссылки на сборку в средствах сборки, но исключают все реализации элементов, а также объявления закрытых элементов, не имеющих наблюдаемого влияния на их контракт API.</span><span class="sxs-lookup"><span data-stu-id="06bac-172">They include declarations for all members that are significant when referencing an assembly in build tools, but exclude all member implementations and declarations of private members that have no observable impact on their API contract.</span></span> <span data-ttu-id="06bac-173">Дополнительные сведения см. в статье [Базовые сборки](../../../standard/assembly/reference-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="06bac-173">For more information, see [Reference assemblies](../../../standard/assembly/reference-assemblies.md).</span></span>

<span data-ttu-id="06bac-174">Параметры **ProduceOnlyReferenceAssembly** и [**ProduceReferenceAssembly**](output.md#producereferenceassembly) являются взаимоисключающими.</span><span class="sxs-lookup"><span data-stu-id="06bac-174">The **ProduceOnlyReferenceAssembly** and [**ProduceReferenceAssembly**](output.md#producereferenceassembly) options are mutually exclusive.</span></span>
