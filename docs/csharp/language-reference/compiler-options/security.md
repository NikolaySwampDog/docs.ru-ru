---
description: Параметры компилятора C# для обеспечения безопасности. Эти параметры управляют подписыванием сборок или размещением диапазона адресов.
title: Параметры компилятора C# — параметры безопасности
ms.date: 03/12/2021
f1_keywords:
- cs.build.options
helpviewer_keywords:
- PublicSign compiler option [C#]
- DelaySign compiler option [C#]
- KeyFile compiler option [C#]
- KeyContainer compiler option [C#]
- HighEntropyVA compiler option [C#]
ms.openlocfilehash: db7b612fa2e4ddb566ac2ba5ef9e4e66c5f0b0ab
ms.sourcegitcommit: 0bb8074d524e0dcf165430b744bb143461f17026
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2021
ms.locfileid: "103482470"
---
# <a name="c-compiler-options-for-security-options"></a><span data-ttu-id="b7510-104">Параметры компилятора C# для обеспечения безопасности</span><span class="sxs-lookup"><span data-stu-id="b7510-104">C# Compiler Options for security options</span></span>

<span data-ttu-id="b7510-105">Следующие параметры управляют параметрами безопасности компилятора.</span><span class="sxs-lookup"><span data-stu-id="b7510-105">The following options control compiler security options.</span></span> <span data-ttu-id="b7510-106">Новый синтаксис MSBuild выделен **полужирным шрифтом**.</span><span class="sxs-lookup"><span data-stu-id="b7510-106">The new MSBuild syntax is shown in **Bold**.</span></span> <span data-ttu-id="b7510-107">Для старого синтаксиса *csc.exe* используется формат `code style`.</span><span class="sxs-lookup"><span data-stu-id="b7510-107">The older *csc.exe* syntax is shown in `code style`.</span></span>

- <span data-ttu-id="b7510-108">**PublicSign** / `-publicsign`: публичное подписывание сборки.</span><span class="sxs-lookup"><span data-stu-id="b7510-108">**PublicSign** / `-publicsign`: Publicly sign the assembly.</span></span>
- <span data-ttu-id="b7510-109">**DelaySign** / `-delaysign`: отложить подпись для сборки, используя только открытую часть ключа строгого имени.</span><span class="sxs-lookup"><span data-stu-id="b7510-109">**DelaySign** / `-delaysign`: Delay-sign the assembly using only the public portion of the strong name key.</span></span>
- <span data-ttu-id="b7510-110">**KeyFile** / `-keyfile`: указание файла ключа строгого имени.</span><span class="sxs-lookup"><span data-stu-id="b7510-110">**KeyFile** / `-keyfile` : Specify a strong name key file.</span></span>
- <span data-ttu-id="b7510-111">**KeyContainer** / `-keycontainer`: указание контейнера ключа строгого имени.</span><span class="sxs-lookup"><span data-stu-id="b7510-111">**KeyContainer** / `-keycontainer`: Specify a strong name key container.</span></span>
- <span data-ttu-id="b7510-112">**HighEntropyVA** / `-highentropyva`: включить технологию ASLR с высокой энтропией.</span><span class="sxs-lookup"><span data-stu-id="b7510-112">**HighEntropyVA** / `-highentropyva`: Enable high-entropy Address Space Layout Randomization (ASLR)</span></span>

## <a name="publicsign"></a><span data-ttu-id="b7510-113">PublicSign</span><span class="sxs-lookup"><span data-stu-id="b7510-113">PublicSign</span></span>

<span data-ttu-id="b7510-114">Этот параметр указывает компилятору на необходимость применения открытого ключа, но фактически не подписывает сборку.</span><span class="sxs-lookup"><span data-stu-id="b7510-114">This option causes the compiler to apply a public key but doesn't actually sign the assembly.</span></span> <span data-ttu-id="b7510-115">Кроме того, параметр **PublicSign** задает в сборке бит, тем самым сообщая среде выполнения, что файл подписан.</span><span class="sxs-lookup"><span data-stu-id="b7510-115">The **PublicSign** option also sets a bit in the assembly that tells the runtime that the file is signed.</span></span>

```xml
<PublicSign>true</PublicSign>
```

<span data-ttu-id="b7510-116">С параметром **PublicSign** необходимо использовать параметр [**KeyFile**](#keyfile) или [**KeyContainer**](#keycontainer).</span><span class="sxs-lookup"><span data-stu-id="b7510-116">The **PublicSign** option requires the use of the [**KeyFile**](#keyfile) or [**KeyContainer**](#keycontainer) option.</span></span> <span data-ttu-id="b7510-117">Параметры **KeyFile** и **KeyContainer** определяют открытый ключ.</span><span class="sxs-lookup"><span data-stu-id="b7510-117">The **keyFile** and **KeyContainer** options specify the public key.</span></span> <span data-ttu-id="b7510-118">Параметры **KeyContainer** и **PublicSign** являются взаимоисключающими.</span><span class="sxs-lookup"><span data-stu-id="b7510-118">The **PublicSign** and **PublicSign** options are mutually exclusive.</span></span> <span data-ttu-id="b7510-119">При таком подписывании в сборку добавляется открытый ключ. Кроме того, в сборке устанавливается флаг "подписано". Такой подход иногда называют "фиктивным подписыванием" или "подписыванием OSS".</span><span class="sxs-lookup"><span data-stu-id="b7510-119">Sometimes called "fake sign" or "OSS sign", public signing includes the public key in an output assembly and sets the "signed" flag.</span></span> <span data-ttu-id="b7510-120">Но фактически сборка не подписывается закрытым ключом.</span><span class="sxs-lookup"><span data-stu-id="b7510-120">Public signing doesn't actually sign the assembly with a private key.</span></span> <span data-ttu-id="b7510-121">Разработчики используют публичное подписывание для проектов с открытым кодом.</span><span class="sxs-lookup"><span data-stu-id="b7510-121">Developers use public sign for open-source projects.</span></span>  <span data-ttu-id="b7510-122">Им нужно создавать сборки, которые совместимы с выпущенными "полностью подписанными" сборками, но у них нет доступа к закрытому ключу, который использовался для подписывания сборок.</span><span class="sxs-lookup"><span data-stu-id="b7510-122">People build assemblies that are compatible with the released "fully signed" assemblies when they don' have access to the private key used to sign the assemblies.</span></span> <span data-ttu-id="b7510-123">Так как потребителям редко нужно проверять, полностью ли подписана сборка, создаваемые сообществами сборки можно использовать практические во всех случаях, в которых может использоваться полностью подписанная сборка.</span><span class="sxs-lookup"><span data-stu-id="b7510-123">Since few consumers actually need to check if the assembly is fully signed, these publicly built assemblies are useable in almost every scenario where the fully signed one would be used.</span></span>

## <a name="delaysign"></a><span data-ttu-id="b7510-124">DelaySign</span><span class="sxs-lookup"><span data-stu-id="b7510-124">DelaySign</span></span>

<span data-ttu-id="b7510-125">Этот параметр указывает компилятору зарезервировать пространство в выходном файле, чтобы впоследствии добавить в него цифровую подпись.</span><span class="sxs-lookup"><span data-stu-id="b7510-125">This option causes the compiler to reserve space in the output file so that a digital signature can be added later.</span></span>

```xml
<DelaySign>true</DelaySign>
```

<span data-ttu-id="b7510-126">Если требуется полностью подписанная сборка, используйте параметр **DelaySign-** .</span><span class="sxs-lookup"><span data-stu-id="b7510-126">Use **DelaySign-** if you want a fully signed assembly.</span></span> <span data-ttu-id="b7510-127">Если нужно лишь поместить в сборку открытый ключ, используйте параметр **DelaySign**.</span><span class="sxs-lookup"><span data-stu-id="b7510-127">Use **DelaySign** if you only want to place the public key in the assembly.</span></span> <span data-ttu-id="b7510-128">Параметр **DelaySign** не действует, если не использовать его с [**KeyFile**](#keyfile) или [**KeyContainer**](#keycontainer).</span><span class="sxs-lookup"><span data-stu-id="b7510-128">The **DelaySign** option has no effect unless used with [**KeyFile**](#keyfile) or [**KeyContainer**](#keycontainer).</span></span> <span data-ttu-id="b7510-129">Параметры [**KeyContainer**](#keycontainer) и [**PublicSign**](#publicsign) являются взаимоисключающими.</span><span class="sxs-lookup"><span data-stu-id="b7510-129">The [**KeyContainer**](#keycontainer) and [**PublicSign**](#publicsign) options are mutually exclusive.</span></span> <span data-ttu-id="b7510-130">При запросе полностью подписанной сборки компилятор хэширует файл, содержащий манифест (метаданные сборки), и подписывает хэш закрытым ключом.</span><span class="sxs-lookup"><span data-stu-id="b7510-130">When you request a fully signed assembly, the compiler hashes the file that contains the manifest (assembly metadata) and signs that hash with the private key.</span></span> <span data-ttu-id="b7510-131">Эта операция предназначена для создания цифровой подписи, которая хранится в файле, содержащем манифест.</span><span class="sxs-lookup"><span data-stu-id="b7510-131">That operation creates a digital signature that is stored in the file that contains the manifest.</span></span> <span data-ttu-id="b7510-132">Если применяется отложенное подписывание сборки, компилятор не вычисляет и не сохраняет подпись,</span><span class="sxs-lookup"><span data-stu-id="b7510-132">When an assembly is delay signed, the compiler doesn't compute and store the signature.</span></span> <span data-ttu-id="b7510-133">но он резервирует пространство в файле, чтобы подпись можно было добавить позже.</span><span class="sxs-lookup"><span data-stu-id="b7510-133">Instead, the compiler but reserves space in the file so the signature can be added later.</span></span>

<span data-ttu-id="b7510-134">Параметр **DelaySign** позволяет поместить сборку в глобальный кэш при тестировании.</span><span class="sxs-lookup"><span data-stu-id="b7510-134">Using **DelaySign** allows a tester to put the assembly in the global cache.</span></span> <span data-ttu-id="b7510-135">После тестирования можно полностью подписать сборку, поместив в нее закрытый ключ с помощью [компоновщика сборок](../../../framework/tools/al-exe-assembly-linker.md).</span><span class="sxs-lookup"><span data-stu-id="b7510-135">After testing, you can fully sign the assembly by placing the private key in the assembly using the [Assembly Linker](../../../framework/tools/al-exe-assembly-linker.md) utility.</span></span> <span data-ttu-id="b7510-136">Дополнительные сведения см. в разделах [Создание и использование сборок со строгими именами](../../../standard/assembly/create-use-strong-named.md) и [Отложенная подпись сборки](../../../standard/assembly/delay-sign.md).</span><span class="sxs-lookup"><span data-stu-id="b7510-136">For more information, see [Creating and Using Strong-Named Assemblies](../../../standard/assembly/create-use-strong-named.md) and [Delay Signing an Assembly](../../../standard/assembly/delay-sign.md).</span></span>

## <a name="keyfile"></a><span data-ttu-id="b7510-137">KeyFile</span><span class="sxs-lookup"><span data-stu-id="b7510-137">KeyFile</span></span>

<span data-ttu-id="b7510-138">Задает имя файла, содержащего криптографический ключ.</span><span class="sxs-lookup"><span data-stu-id="b7510-138">Specifies the filename containing the cryptographic key.</span></span>

```xml
<KeyFile>filename</KeyFile>
```

<span data-ttu-id="b7510-139">`file` — это имя файла, содержащего ключ строгого имени.</span><span class="sxs-lookup"><span data-stu-id="b7510-139">`file` is the name of the file containing the strong name key.</span></span> <span data-ttu-id="b7510-140">При использовании этого параметра компилятор вставляет открытый ключ из указанного файла в манифест сборки и затем подписывает окончательную сборку закрытым ключом.</span><span class="sxs-lookup"><span data-stu-id="b7510-140">When this option is used, the compiler inserts the public key from the specified file into the assembly manifest and then signs the final assembly with the private key.</span></span> <span data-ttu-id="b7510-141">Чтобы создать файл ключа, в командной строке введите `sn -k file`.</span><span class="sxs-lookup"><span data-stu-id="b7510-141">To generate a key file, type `sn -k file` at the command line.</span></span> <span data-ttu-id="b7510-142">При компиляции с параметром [ **-target:module**](output.md#targettype) имя файла ключа сохраняется в модуле и включается в сборку, создаваемую при компиляции с параметром [**AddModules**](inputs.md#addmodules).</span><span class="sxs-lookup"><span data-stu-id="b7510-142">If you compile with [**-target:module**](output.md#targettype), the name of the key file is held in the module and incorporated into the assembly created when you compile an assembly with [**AddModules**](inputs.md#addmodules).</span></span> <span data-ttu-id="b7510-143">Также можно передать сведения о шифровании компилятору с помощью параметра [**Keycontainer**](#keycontainer).</span><span class="sxs-lookup"><span data-stu-id="b7510-143">You can also pass your encryption information to the compiler with [**Keycontainer**](#keycontainer).</span></span> <span data-ttu-id="b7510-144">Если требуется использовать частично подписанную сборку, укажите параметр [**DelaySign**](#delaysign).</span><span class="sxs-lookup"><span data-stu-id="b7510-144">Use [**DelaySign**](#delaysign) if you want a partially signed assembly.</span></span> <span data-ttu-id="b7510-145">Если для одной процедуры компиляции одновременно заданы параметры **KeyFile** и **KeyContainer**, сначала будет предпринята попытка использовать контейнер ключей.</span><span class="sxs-lookup"><span data-stu-id="b7510-145">In case both **KeyFile** and **KeyContainer** are specified in the same compilation, the compiler will first try the key container.</span></span> <span data-ttu-id="b7510-146">В случае успеха сборка подписывается данными контейнера ключей.</span><span class="sxs-lookup"><span data-stu-id="b7510-146">If that succeeds, then the assembly is signed with the information in the key container.</span></span> <span data-ttu-id="b7510-147">Если компилятору не удалось обнаружить контейнер ключей, будет предпринята попытка использовать файл, заданный параметром [**KeyFile**](#keyfile).</span><span class="sxs-lookup"><span data-stu-id="b7510-147">If the compiler doesn't find the key container, it will try the file specified with [**KeyFile**](#keyfile).</span></span> <span data-ttu-id="b7510-148">В случае успеха сборка подписывается данными из файла ключей, и эти данные о ключах будут помещены в контейнер ключей.</span><span class="sxs-lookup"><span data-stu-id="b7510-148">If that succeeds, the assembly is signed with the information in the key file and the key information will be installed in the key container.</span></span> <span data-ttu-id="b7510-149">Таким образом при следующей компиляции контейнер ключей будет действителен.</span><span class="sxs-lookup"><span data-stu-id="b7510-149">On the next compilation, the key container will be valid.</span></span> <span data-ttu-id="b7510-150">Файл ключей может содержать только открытый ключ.</span><span class="sxs-lookup"><span data-stu-id="b7510-150">A key file might contain only the public key.</span></span> <span data-ttu-id="b7510-151">Дополнительные сведения см. в разделах [Создание и использование сборок со строгими именами](../../../standard/assembly/create-use-strong-named.md) и [Отложенная подпись сборки](../../../standard/assembly/delay-sign.md).</span><span class="sxs-lookup"><span data-stu-id="b7510-151">For more information, see [Creating and Using Strong-Named Assemblies](../../../standard/assembly/create-use-strong-named.md) and [Delay Signing an Assembly](../../../standard/assembly/delay-sign.md).</span></span>

## <a name="keycontainer"></a><span data-ttu-id="b7510-152">KeyContainer</span><span class="sxs-lookup"><span data-stu-id="b7510-152">KeyContainer</span></span>

<span data-ttu-id="b7510-153">Задает имя контейнера криптографического ключа.</span><span class="sxs-lookup"><span data-stu-id="b7510-153">Specifies the name of the cryptographic key container.</span></span>

```xml
<KeyContainer>container</KeyContainer>
```

<span data-ttu-id="b7510-154">`container` — это имя контейнера ключа строгого имени.</span><span class="sxs-lookup"><span data-stu-id="b7510-154">`container` is the name of the strong name key container.</span></span> <span data-ttu-id="b7510-155">Если используется параметр **KeyContainer**, компилятор создает совместно используемый компонент.</span><span class="sxs-lookup"><span data-stu-id="b7510-155">When the **KeyContainer** option is used, the compiler creates a sharable component.</span></span> <span data-ttu-id="b7510-156">Компилятор вставляет открытый ключ из указанного контейнера в манифест сборки, после чего подписывает финальную сборку закрытым ключом.</span><span class="sxs-lookup"><span data-stu-id="b7510-156">The compiler inserts a public key from the specified container into the assembly manifest and signs the final assembly with the private key.</span></span> <span data-ttu-id="b7510-157">Чтобы создать файл ключа, в командной строке введите `sn -k file`.</span><span class="sxs-lookup"><span data-stu-id="b7510-157">To generate a key file, type `sn -k file` at the command line.</span></span> <span data-ttu-id="b7510-158">Команда `sn -i` устанавливает пару ключей в контейнер.</span><span class="sxs-lookup"><span data-stu-id="b7510-158">`sn -i` installs the key pair into a container.</span></span> <span data-ttu-id="b7510-159">Этот параметр не поддерживается, если компилятор работает в CoreCLR.</span><span class="sxs-lookup"><span data-stu-id="b7510-159">This option isn't supported when the compiler runs on CoreCLR.</span></span> <span data-ttu-id="b7510-160">Чтобы подписать сборку при компиляции в CoreCLR, используйте параметр [**KeyFile**](#keyfile).</span><span class="sxs-lookup"><span data-stu-id="b7510-160">To sign an assembly when building on CoreCLR, use the [**KeyFile**](#keyfile) option.</span></span> <span data-ttu-id="b7510-161">При компиляции с параметром [**TargetType**](output.md#targettype) имя файла ключа сохраняется в модуле и включается в сборку при компиляции этого модуля с параметром [**AddModules**](inputs.md#addmodules).</span><span class="sxs-lookup"><span data-stu-id="b7510-161">If you compile with [**TargetType**](output.md#targettype), the name of the key file is held in the module and incorporated into the assembly when you compile this module into an assembly with [**AddModules**](inputs.md#addmodules).</span></span> <span data-ttu-id="b7510-162">Этот параметр можно также указать в исходном коде любого модуля MSIL в качестве настраиваемого атрибута (<xref:System.Reflection.AssemblyKeyNameAttribute?displayProperty=nameWithType>).</span><span class="sxs-lookup"><span data-stu-id="b7510-162">You can also specify this option as a custom attribute (<xref:System.Reflection.AssemblyKeyNameAttribute?displayProperty=nameWithType>) in the source code for any Microsoft intermediate language (MSIL) module.</span></span> <span data-ttu-id="b7510-163">Также можно передать сведения о шифровании компилятору с помощью параметра [**KeyFile**](#keyfile).</span><span class="sxs-lookup"><span data-stu-id="b7510-163">You can also pass your encryption information to the compiler with [**KeyFile**](#keyfile).</span></span> <span data-ttu-id="b7510-164">Если нужно добавить в манифест сборки открытый ключ, но при этом отложить подпись сборки до завершения ее тестирования, используйте параметр [**DelaySign**](#delaysign).</span><span class="sxs-lookup"><span data-stu-id="b7510-164">Use [**DelaySign**](#delaysign) to add the public key  to the assembly manifest but signing the assembly until it has been tested.</span></span> <span data-ttu-id="b7510-165">Дополнительные сведения см. в разделах [Создание и использование сборок со строгими именами](../../../standard/assembly/create-use-strong-named.md) и [Отложенная подпись сборки](../../../standard/assembly/delay-sign.md).</span><span class="sxs-lookup"><span data-stu-id="b7510-165">For more information, see [Creating and Using Strong-Named Assemblies](../../../standard/assembly/create-use-strong-named.md) and [Delay Signing an Assembly](../../../standard/assembly/delay-sign.md).</span></span>

## <a name="highentropyva"></a><span data-ttu-id="b7510-166">HighEntropyVA</span><span class="sxs-lookup"><span data-stu-id="b7510-166">HighEntropyVA</span></span>

<span data-ttu-id="b7510-167">Параметр компилятора **HighEntropyVA** сообщает ядру Windows, поддерживает ли указанный исполняемый файл технологию Address Space Layout Randomization (ASLR) с высокой энтропией.</span><span class="sxs-lookup"><span data-stu-id="b7510-167">The **HighEntropyVA** compiler option tells the Windows kernel whether a particular executable supports high entropy Address Space Layout Randomization (ASLR).</span></span>

```xml
<HighEntropyVA>true</HighEntropyVA>
```

<span data-ttu-id="b7510-168">Этот параметр указывает, что 64-битный исполняемый файл или исполняемый файл, отмеченный параметром компилятора [**PlatformTarget**](output.md#platformtarget), поддерживает виртуальный диапазон адресов с высокой энтропией.</span><span class="sxs-lookup"><span data-stu-id="b7510-168">This option specifies that a 64-bit executable or an executable that is marked by the [**PlatformTarget**](output.md#platformtarget) compiler option supports a high entropy virtual address space.</span></span> <span data-ttu-id="b7510-169">Этот параметр отключен по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="b7510-169">The option is disabled by default.</span></span> <span data-ttu-id="b7510-170">Чтобы включить его, используйте параметр **HighEntropyVA**.</span><span class="sxs-lookup"><span data-stu-id="b7510-170">Use **HighEntropyVA** to enable it.</span></span>

<span data-ttu-id="b7510-171">Параметр **HighEntropyVA** позволяет совместимым версиям ядра Windows использовать более высокие степени энтропии во время рандомизации размещения диапазона адресов в рамках ASLR.</span><span class="sxs-lookup"><span data-stu-id="b7510-171">The **HighEntropyVA** option enables compatible versions of the Windows kernel to use higher degrees of entropy when randomizing the address space layout of a process as part of ASLR.</span></span> <span data-ttu-id="b7510-172">Использование более высоких степеней энтропии означает, что можно выделить больше адресов таким областям памяти, как стеки и кучи.</span><span class="sxs-lookup"><span data-stu-id="b7510-172">Using higher degrees of entropy means a larger number of addresses can be allocated to memory regions such as stacks and heaps.</span></span> <span data-ttu-id="b7510-173">Из-за этого сложнее подобрать расположение определенной области памяти.</span><span class="sxs-lookup"><span data-stu-id="b7510-173">As a result, it's more difficult to guess the location of a particular memory region.</span></span> <span data-ttu-id="b7510-174">Если указан параметр компилятора **HighEntropyVA**, целевой исполняемый файл и все модули, от которых он зависит, должны иметь возможность обработать значения указателя, размер которых превышает 4 гигабайта (ГБ), если они выполняются как 64-разрядный процесс.</span><span class="sxs-lookup"><span data-stu-id="b7510-174">The **HighEntropyVA** compiler option requires the target executable and any modules that it depends can handle pointer values larger than 4 gigabytes (GB) when they're running as a 64-bit process.</span></span>
