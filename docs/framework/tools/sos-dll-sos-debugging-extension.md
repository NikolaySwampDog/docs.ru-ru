---
title: SOS.dll (расширение отладки SOS)
description: Вы можете использовать SOS.dll, расширение отладки SOS, для отладки управляемых программ в Visual Studio и в WinDbg.exe, получая сведения о внутренней среде CLR.
ms.date: 03/30/2017
helpviewer_keywords:
- debugging extensions
- SOS debugging extensions
- SOS.dll
ms.assetid: 9ac1b522-77ab-4cdc-852a-20fcdc9ae498
ms.openlocfilehash: 33f75003e18abce95778ddea8e3163211e3bfa5c
ms.sourcegitcommit: 1dbe25ff484a02025d5c34146e517c236f7161fb
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "104653638"
---
# <a name="sosdll-sos-debugging-extension"></a>SOS.dll (расширение отладки SOS)

Расширение отладки SOS (SOS.dll) позволяет выполнять отладку управляемых программ в Visual Studio и отладчике Windows (WinDbg.exe), предоставляя информацию о внутренней среде CLR. Для работы этой программы в проекте необходимо включить отладку неуправляемого кода. Библиотека SOS.dll автоматически устанавливается с .NET Framework. Для работы с библиотекой SOS.dll в Visual Studio установите [Комплект разработки драйверов для Windows (WDK)](/windows-hardware/drivers/download-the-wdk).

## <a name="syntax"></a>Синтаксис

```console
![command] [options]
```

## <a name="commands"></a>Команды

|Команда|Описание|
|-------------|-----------------|
|**AnalyzeOOM** (**ao**)|Отображает сведения по последнему событию "Недостаточно памяти" (OOM), произошедшему при запросе на выделение памяти в куче для сборки мусора. (В сборке мусора сервера отображает произошедшее событие OOM для каждой кучи сборки мусора.)|
|**BPMD** [ **-nofuturemodule**] [\<*module name*> \<*method name*>] [ **-md** <`MethodDesc`>] **-list** **-clear** \<*pending breakpoint number*> **-clearall**|Создает точку останова в указанном методе указанного модуля.<br /><br /> Если указанные модуль и метод не загружены, команда ожидает уведомления о загрузке модуля и выполнении JIT-компиляции, прежде чем создавать точку останова.<br /><br /> Списком ожидающих точек останова можно управлять с помощью параметров **-list**, **-clear** и **-clearall**.<br /><br /> Параметр **-list** создает список всех ожидающих точек останова. Если ожидающая точка останова имеет идентификатор модуля, отличный от нуля, эта точка останова связана с функцией в конкретном загруженном модуле. Если ожидающая точка останова имеет нулевой идентификатор модуля, такая точка останова применяется к еще не загруженным модулям.<br /><br /> Чтобы удалить из списка ожидающие точки останова, следует использовать параметр **-clear** или **-clearall**.|
|**CLRStack** [ **-a**] [ **-l**] [ **-p**] [ **-n**]|Обеспечивает трассировку стека только для управляемого кода.<br /><br /> Параметр **-p** задает отображение аргументов управляемой функции.<br /><br /> Параметр **-l** задает отображение сведений о локальных переменных в кадре. Расширение отладки SOS не позволяет извлекать локальные имена, поэтому выходные данные для локальных имен выводятся в формате \<*local address*> **=** \<*value*>.<br /><br /> Параметр **-a** (все) заменяет собой комбинацию параметров **-l** и **-p**.<br /><br /> Параметр **-n** отключает отображение имен исходных файлов и номеров строк. Если для отладчика указан параметр "SYMOPT_LOAD_LINES", расширение отладки SOS ищет символы для каждого управляемого кадра и в случае успеха отображает соответствующее имя исходного файла и номер строки. Такое поведение можно отключить, задав параметр **-n** (без номеров строк).<br /><br /> Расширение отладки SOS не отображает переходные кадры на платформах x64 и IA-64.|
|**COMState**|Выдает список моделей контейнера COM для каждого потока и указатель `Context`, если он имеется.|
|**DumpArray** [ **-start** \<*startIndex*>] [ **-length** \<*length*>] [ **-details**] [ **-nofields**] \<*array object address*><br /><br /> -или-<br /><br /> **DA** [ **-start** \<*startIndex*>] [ **-length** \<*length*>] [ **-detail**] [ **-nofields**] *адрес объекта массива*>|Анализирует элементы объекта массива.<br /><br /> Параметр **-start** задает индекс, начиная с которого отображаются элементы.<br /><br /> Параметр **-length** задает количество отображаемых элементов.<br /><br /> Параметр **-details** задает отображение сведений об элементе в формате **DumpObj** и **DumpVC**.<br /><br /> Параметр **-nofields** отменяет отображение массивов. Этот параметр можно использовать, только если задан параметр **-detail**.|
|**DumpAssembly** \<*assembly address*>|Отображает сведения о сборке.<br /><br /> Команда **DumpAssembly** выводит список модулей, если они существуют.<br /><br /> Адрес сборки можно получить с помощью команды **DumpDomain**.|
|**DumpClass** \<*EEClass address*>|Отображает сведения о структуре `EEClass`, связанной с типом.<br /><br /> Команда **DumpClass** отображает значения статических полей, но значения нестатических полей не отображаются.<br /><br /> Используйте команду **DumpMT**, **DumpObj**, **Name2EE** или **Token2EE**, чтобы получить адрес структуры `EEClass`.|
|**DumpDomain** [\<*domain address*>]|Перечисляет все объекты <xref:System.Reflection.Assembly>, загруженные по указанному адресу объекта <xref:System.AppDomain>.  При вызове без параметров команда **DumpDomain** выводит список всех объектов <xref:System.AppDomain> в составе процесса.|
|**DumpHeap** [ **-stat**] [ **-strings**] [ **-short**] [ **-min** \<*size*>] [ **-max** \<*size*>] [ **-thinlock**] [ **-startAtLowerBound**] [ **-mt** \<*MethodTable address*>] [ **-type** \<*partial type name*>][*start* [*end*]]|Отображает сведения о куче со сборкой мусора и статистику сбора мусора по объектам.<br /><br /> В случае чрезмерной фрагментации кучи сборщика мусора команда **DumpHeap** выдает соответствующее предупреждение.<br /><br /> Параметр **-stat** ограничивает выводимую информацию статистической сводкой по типам.<br /><br /> Параметр **-strings** ограничивает выводимую информацию статистической сводкой по значениям строк.<br /><br /> Параметр **-short** ограничивает вывод только адресом каждого объекта. Благодаря такому подходу можно легко передавать результат из одной команды отладчика в другую команду с целью автоматизации.<br /><br /> Параметр **-min** задает пропуск объектов, размер которых меньше значения параметра `size`, указанного в байтах.<br /><br /> Параметр **-max** задает пропуск объектов, размер которых больше значения параметра `size`, указанного в байтах.<br /><br /> Параметр **-thinlock** сообщает о блокировках ThinLock.  Дополнительные сведения см. в описании команды **SyncBlk**.<br /><br /> Параметр `-startAtLowerBound` приводит к тому, что обход кучи начинается с нижней границы предоставленного диапазона адресов. На стадии планирования куча часто является неанализируемой, поскольку объекты перемещаются. Этот параметр заставляет **DumpHeap** начать проверку с указанной нижней границы. Чтобы задействовать этот параметр, необходимо указать адрес допустимого объекта в качестве нижней границы. Можно отобразить память по адресу неверного объекта, чтобы вручную найти следующую таблицу методов. Если сборка мусора выполняется в момент вызова `memcopy`, также можно найти адрес следующего объекта путем добавления размера к начальному адресу, который указан как параметр.<br /><br /> Параметр **-mt** задает вывод только тех объектов, которые соответствуют указанной структуре `MethodTable`.<br /><br /> Параметр **-type** задает вывод только тех объектов, имя типа которых содержит указанную строку.<br /><br /> Параметр `start` задает составление списка, начиная с указанного адреса.<br /><br /> Параметр `end` прекращает составление списка на указанном адресе.|
|**DumpIL** \<*Managed DynamicMethod object*> &#124;       \<*DynamicMethodDesc pointer*> &#124;        \<*MethodDesc pointer*>|Отображает язык CIL, связанный с управляемым методом.<br /><br /> Следует иметь в виду, что динамический язык CIL генерируется иначе, чем язык CIL, загруженный из сборки. Динамический язык CIL ссылается на объекты в массиве управляемых объектов, а не на токены метаданных.|
|**DumpLog** [ **-addr** \<*addressOfStressLog*>] [<*Filenam*`e`>]|Записывает в указанный файл содержимое журнала нагрузок, хранящегося в памяти. Если имя не указано, команда создает файл "StressLog.txt" в текущем каталоге.<br /><br /> Хранящийся в памяти журнал нагрузок помогает при диагностике сбоев, вызываемых нагрузкой, без использования блокировки или ввода-вывода. Чтобы разрешить ведение журнала нагрузок, задайте следующие значения в разделе HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\\.NETFramework.<br /><br /> (DWORD) StressLog = 1<br /><br /> (DWORD) LogFacility = 0xffffffff<br /><br /> (DWORD) StressLogSize = 65536<br /><br /> С помощью необязательного параметра `-addr` можно указать журнал нагрузки, отличный от журнала по умолчанию.|
|**DumpMD** \<*MethodDesc address*>|Отображает сведения о структуре `MethodDesc`, находящейся по указанному адресу.<br /><br /> Чтобы получить адрес структуры `MethodDesc` из управляемой функции, можно использовать команду **IP2MD**.|
|**DumpMT** [ **-MD**] \<*MethodTable address*>|Отображает сведения о таблице методов, расположенной по указанному адресу. Параметр **-MD** задает вывод списка всех методов, определенных вместе с объектом.<br /><br /> Каждый управляемый объект содержит указатель на таблицу методов.|
|**DumpMethodSig** \<*sigaddr*> <*moduleadd*`r`>|Отображает сведения о структуре `MethodSig`, находящейся по указанному адресу.|
|**DumpModule** [ **-mt**] \<*Module address*>|Отображает информацию о модуле, находящемся по указанному адресу. Параметр **-mt** задает отображение типов, определенных в модуле, и типов, на которые имеются ссылки в модуле<br /><br /> Чтобы получить адрес модуля, можно использовать команду **DumpDomain** или **DumpAssembly**.|
|**DumpObj** [ **-nofields**] \<*object address*><br /><br /> -или-<br /><br /> **DO** \<*object address*>|Отображает сведения об объекте, находящемся по указанному адресу. Команда **DumpObj** отображает список полей, сведения о структуре `EEClass`, таблицу методов и размер объекта.<br /><br /> Чтобы получить адрес объекта, можно использовать команду **DumpStackObjects**.<br /><br /> Следует иметь в виду, что команду **DumpObj** можно выполнять для полей типа `CLASS`, поскольку они также являются объектами.<br /><br /> Параметр `-`**nofields** не предотвращает отображение полей объекта, что удобно для таких объектов, как String.|
|**DumpRuntimeTypes**|Отображает объекты типы среды выполнения в куче сборщика мусора и выводит список связанных с ними имен типов и таблиц методов.|
|**DumpStack** [ **-EE**] [ **-n**] [`top` *stack* [`bottom` *stac*`k`]]|Отображает трассировку стека.<br /><br /> Параметр **-EE** команды **DumpStack** задает отображение только управляемых функций. Параметры `top` и `bottom` позволяют ограничить состав отображаемых кадров стека на платформах x86.<br /><br /> Параметр **-n** отключает отображение имен исходных файлов и номеров строк. Если для отладчика указан параметр "SYMOPT_LOAD_LINES", расширение отладки SOS ищет символы для каждого управляемого кадра и в случае успеха отображает соответствующее имя исходного файла и номер строки. Такое поведение можно отключить, задав параметр **-n** (без номеров строк).<br /><br /> На платформах x86 и x64 команда **DumpStack** создает подробную трассировку стека.<br /><br /> На платформах IA-64 команда **DumpStack** действует аналогично команде отладчика **K**. На платформах IA-64 параметры `top` и `bottom` игнорируются.|
|**DumpSig** \<*sigaddr*> \<*moduleaddr*>|Отображает сведения о структуре `Sig`, находящейся по указанному адресу.|
|**DumpSigElem** \<*sigaddr*> \<*moduleaddr*>|Отображает единственный элемент объекта сигнатуры. В большинстве случаев следует использовать **DumpSig** для просмотра отдельных объектов сигнатур. Тем не менее, если сигнатура каким-либо образом повреждена, можно использовать **DumpSigElem** для чтения ее допустимых частей.|
|**DumpStackObjects** [ **-verify**] [`top` *stack* [`bottom` *stack*]]<br /><br /> -или-<br /><br /> **DSO** [ **-verify**] [`top` *stack* [`bottom` *stack*]]|Отображает все управляемые объекты, обнаруженные в пределах границ текущего стека.<br /><br /> Параметр **-verify** задает проверку каждого нестатического поля `CLASS` в поле объекта.<br /><br /> Для определения значений локальных переменных и параметров используйте команду **DumpStackObject** вместе с командами трассировки стека, такими как **K** и **CLRStack**.|
|**DumpVC** \<*MethodTable address*> \<*Address*>|Отображает сведения о полях класса значений, находящегося по указанному адресу.<br /><br /> Параметр **MethodTable** позволяет команде **DumpVC** правильно интерпретировать поля. В классах значений первое поле не содержит таблицу методов.|
|**EEHeap** [ **-gc**] [ **-loader**]|Отображает сведения о памяти процессов, занимаемой внутренними структурами данных среды CLR.<br /><br /> Параметры **-gc** и **-loader** ограничивают выходные данные этой команды только сведениями о структурах данных сборщика мусора и загрузчика.<br /><br /> Сведения о сборщике мусора включает в себя диапазоны каждого сегмента в управляемой куче.  Если указатель попадает в диапазон сегмента, заданный параметром **-gc**, значит, он является указателем объекта.|
|**EEStack** [ **-short**] [ **-EE**]|Выполняет команду **DumpStack** для всех потоков в составе процесса.<br /><br /> Параметр **-EE** передается непосредственно в команду **DumpStack**. Параметр **-short** ограничивает выходные данные следующими видами потоков.<br /><br /> Потоки с блокировкой.<br /><br /> Потоки, остановленные для сбора мусора.<br /><br /> Потоки, которые в данный момент находятся в управляемом коде.|
|**EEVersion**|Отображает версию среды CLR.|
|**EHInfo** [\<*MethodDesc address*>] [\<*Code address*>]|Отображает блоки обработки исключений в указанном методе.  Данная команда выводит адреса кода и смещения для блока предложений (блока `try`) и блока обработчика (блока `catch`).|
|**FAQ**|Отображает вопросы и ответы.|
|**FinalizeQueue** [ **-detail**] &#124; [ **-allReady**] [ **-short**]|Отображает все объекты, зарегистрированные для заключительной обработки.<br /><br /> Параметр **-detail** задает вывод дополнительной информации обо всех блоках `SyncBlocks`, которые необходимо очистить, и оболочках `RuntimeCallableWrappers`, ожидающих очистки. Поток завершения кэширует и очищает обе эти структуры данных.<br /><br /> Параметр `-allReady` отображает все объекты, которые уже готовы к завершению без учета того, помечены они для сборки мусора или будут помечены следующей сборкой мусора. Объекты, отсутствующие в списке "готовые для завершения", — это завершаемые объекты, которые больше не являются корневым. Применение этого параметра может быть очень затратным, поскольку проверяется, все ли объекты в завершаемых очередях по-прежнему являются корневыми.<br /><br /> Параметр `-short` ограничивает вывод адресом каждого объекта. При использовании в сочетании с **-allReady** он перечисляет все объекты с методом завершения, которые больше не являются корневыми. При независимом использовании создает список всех объектов в очередях "поддерживающие завершение" и "готовые для завершения".|
|**FindAppDomain** \<*Object address*>|Определяет домен приложения для объекта, находящегося по указанному адресу.|
|**FindRoots** **-gen** \<*N*> &#124; **-gen any** &#124;\<*object address*>|Вызывает остановку отладчика в отлаживаемом объекте следующей коллекции заданного поколения. Эффект сбрасывается, как только произойдет останов. Чтобы остановиться на следующей коллекции, необходимо повторное выполнение команды. Форма *\<object address>* этой команды используется после возникновения останова, вызванного **-gen** или **-gen any**. В этот момент отлаживаемый объект находится в правильном состоянии для **FindRoots** для идентификации корневых элементов для объектов из поколений, уничтожаемых в данный момент.|
|**GCHandles** [ **-perdomain**]|Отображает статистику дескрипторов сборщика мусора в составе процесса.<br /><br /> Параметр **-perdomain** упорядочивает статистику по доменам приложений.<br /><br /> Команда **GCHandles** служит для поиска утечек памяти, вызываемых утечками дескрипторов сборщика мусора. Например, утечка памяти происходит, когда в коде продолжает использоваться большой массив, поскольку на него еще указывает строгий дескриптор сборщика мусора, а сам дескриптор удаляется без освобождения памяти.|
|**GCHandleLeaks**|Ищет в памяти ссылки на строгие и закрепленные дескрипторы сборщика мусора в рамках процесса и отображает результаты. При обнаружении дескриптора команда **GCHandleLeaks** отображает адрес ссылки. Если дескриптор в памяти не найден, выдается уведомление.|
|**GCInfo** \<*MethodDesc address*>\<*Code address*>|Отображает данные, показывающие, содержатся ли управляемые объекты в регистрах или ячейках стека. Если производится сбор мусора, сборщик должен знать расположение ссылок на объекты, чтобы их можно было обновить новыми значениями указателей объектов.|
|**GCRoot** [ **-nostacks**] \<*Object address*>|Отображает информацию о ссылках (или корневых элементах) объекта, находящегося по указанному адресу.<br /><br /> Команда **GCRoot** анализирует всю управляемую кучу и таблицу дескрипторов в поисках дескрипторов, находящихся в других объектах или в стеке. Затем каждый стек просматривается в поисках указателей на объекты; также просматривается и очередь метода завершения.<br /><br /> Данная команда не определяет, является ли корень стека допустимым или удален ли он. Используйте команды **CLRStack** и **U**, чтобы дизассемблировать кадр, к которому принадлежит локальное значение или значение аргумента, и определить, используется ли еще корень стека.<br /><br /> Параметр **-nostacks** ограничивает поиск дескрипторами сборщика мусора и достижимыми объектами.|
|**GCWhere**  *\<object address>*|Отображает расположение и размер переданного аргумента в куче для сборки мусора. Если аргумент располагается в управляемой куче, но не является адресом допустимого объекта, размер отображается как "0" (нуль).|
|**help** [\<*command*>] [`faq`]|Отображает все доступные команды при отсутствии параметров или, если указана команда, — подробные справочные сведения об этой команде.<br /><br /> Параметр `faq` задает отображение ответов на часто задаваемые вопросы.|
|**HeapStat** [ **- inclUnrooted** &#124; **-iu**]|Отображает размеры поколений для каждой кучи и общий объем свободного места в каждом поколении каждой кучи. Если указан параметр -**inclUnrooted**, отчет содержит сведения об управляемых объектах в куче для сборки мусора, которая больше не является корневой.|
|**HistClear**|Освобождает все ресурсы, используемые семейством команд `Hist`.<br /><br /> Как правило, прямой вызов `HistClear` не требуется, так как каждая команда `HistInit` очищает предыдущие ресурсы.|
|**HistInit**|Инициализирует структуры SOS из журнала нагрузки, сохраненного в отлаживаемом объекте.|
|**HistObj** *\<obj_address>*|Проверяет все записи журнала перемещения нагрузки и отображает цепочку перемещений сборки мусора, которые могли привести к адресу, переданному в качестве аргумента.|
|**HistObjFind**  *\<obj_address>*|Отображает все записи журнала, ссылающиеся на объект по указанному адресу.|
|**HistRoot** *\<root>*|Отображает сведения о повышениях и перемещениях указанного корневого элемента.<br /><br /> Корневое значение можно использовать для отслеживания движения объекта в сборках мусора.|
|**IP2MD** \<*Code address*>|Отображает структуру `MethodDesc` по указанному адресу в коде после его JIT-компиляции.|
|`ListNearObj` (`lno`) *\<obj_address>*|Отображает объекты перед указанным адресом и после него. Команда находит в куче для сборки мусора адрес, напоминающий допустимое начало управляемого объекта (в зависимости от таблицы допустимых методов), и объект, следующий за адресом аргумента.|
|**MinidumpMode** [**0**] [**1**]|Запрещает выполнение небезопасных команд при использовании минидампа.<br /><br /> Значение **0** отключает этот режим, а значение **1** включает его. По умолчанию значение **MinidumpMode** равно **0**.<br /><br /> Минидампы, созданные с помощью команды **.dump /m** или **.dump**, содержат ограниченный набор данных, связанных с CLR, и позволяют корректно выполнять лишь часть команд SOS. Выполнение некоторых команд может завершаться сбоем из-за непредвиденных ошибок, вызываемых тем, что требуемые области памяти не сопоставлены или сопоставлены лишь частично. Данный параметр блокирует запуск небезопасных команд для минидампов.|
|**Name2EE** \<*module name*> \<*type or method name*><br /><br /> -или-<br /><br /> **Name2EE** \<*module name*> **!** \<*type or method name*>|Отображает структуры `MethodTable` и `EEClass` для указанного типа или метода в указанном модуле.<br /><br /> Указанный модуль должен быть загружен в процесс.<br /><br /> Чтобы получить правильное имя типа, просмотрите модуль с помощью [Ildasm.exe (дизассемблера IL)](ildasm-exe-il-disassembler.md). Можно также передать `*` в качестве параметра имени модуля, чтобы просматривались все загруженные управляемые модули. Параметр *имя модуля* может также содержать имя отладчика для модуля, например `mscorlib` или `image00400000`.<br /><br /> Данная команда поддерживает следующий синтаксис отладчика Windows: <`module`>`!`<`type`>. Имя типа должно быть полным.|
|**ObjSize** [\<*Object address*>] &#124; [ **-aggregate**] [ **-stat**]|Отображает размер указанного объекта. Если параметры не указаны, команда **ObjSize** отображает размеры всех объектов, найденных в управляемых потоках, все дескрипторы сборщика мусора в данном процессе, а также общий размер всех объектов, указываемых этими дескрипторами. Команда **ObjSize** включает в размер каждого родительского объекта размер всех его дочерних объектов.<br /><br /> Параметр **-aggregate** можно использовать в сочетании с аргументом **-stat**, чтобы получить подробное представление типов, которые по-прежнему являются корневыми. С помощью **!dumpheap -stat** и **!objsize -aggregate -stat** можно определить, какие объекты больше не являются корневыми, и провести диагностику различных проблем с памятью.|
|**PrintException** [ **-nested**] [ **-lines**] [\<*Exception object address*>]<br /><br /> -или-<br /><br /> **PE** [ **-nested**] [\<*Exception object address*>]|Отображает и форматирует поля всех производных объектов класса <xref:System.Exception>, находящегося по указанному адресу. Если адрес не задан, команда **PrintException** отображает последнее исключение, возникшее в текущем потоке.<br /><br /> Параметр **-nested** задает отображение сведений о вложенных объектах исключений.<br /><br /> Если доступен, параметр **-lines** отображает сведения об источнике.<br /><br /> С помощью этой команды можно форматировать и просматривать поле `_stackTrace`, представляющее собой двоичный массив.|
|**ProcInfo** [ **-env**] [ **-time**] [ **-mem**]|Отображает переменные среды для статистики процесса, процессорного времени ядра и использования памяти.|
|**RCWCleanupList** \<*RCWCleanupList address*>|Отображает список вызываемых оболочек среды выполнения по указанному адресу, ожидающих очистки.|
|**SaveModule** \<*Base address*> \<*Filename*>|Записывает в указанный файл образ, загруженный в память по указанному адресу.|
|**SOSFlush**|Очищает внутренний кэш SOS.|
|**StopOnException** [ **-derived**] [ **-create** &#124; **-create2**] \<*Exception*> \<*Pseudo-register number*>|Предписывает отладчику остановиться при возникновении указанного исключения и продолжать работу при возникновении других исключений.<br /><br /> Параметр **-derived** задает перехват указанного исключения и всех производных от него исключений.|
|**SyncBlk** [ **-all** &#124; \<*syncblk number*>]|Отображает указанную структуру `SyncBlock` или все структуры `SyncBlock`.  При отсутствии аргументов команда **SyncBlk** отображает структуру `SyncBlock`, соответствующую объектам, владельцем которых является поток.<br /><br /> Структура `SyncBlock` представляет собой контейнер для дополнительной информации, которую необязательно создавать для каждого объекта. Она может включать данные COM-взаимодействия и сведения о блокировке для потокобезопасных операций.|
|**ThreadPool**|Отображает сведения о пуле управляемых потоков, включая число рабочих запросов в очереди, число потоков портов завершения и число таймеров.|
|**Token2EE** \<*module name*> \<*token*>|Преобразует указанный токен метаданных указанного модуля в структуру `MethodTable` или `MethodDesc`.<br /><br /> В качестве параметра имени модуля можно указать `*`, чтобы узнать, с чем сопоставляется токен в каждом из загруженных управляемых модулей. Можно также задать имя отладчика для модуля, например `mscorlib` или `image00400000`.|
|**Threads** [ **-live**] [ **-special**]|Отображает все управляемые потоки в процессе.<br /><br /> Команда **Threads** отображает сокращенный идентификатор отладчика, идентификатор потока среды CLR и идентификатор потока операционной системы.  Кроме того, команда **Threads** отображает столбец Domain, содержащий домен приложения, в котором выполняется поток, столбец APT, в котором показан режим COM-контейнера, и столбец Exception, где указано последнее исключение, возникшее в потоке.<br /><br /> Параметр **-live** задает отображение потоков, связанных с активным потоком.<br /><br /> Параметр **-special** задает отображение всех специальных потоков, созданных средой CLR. К специальным потокам относятся потоки сборки мусора (для параллельной сборки мусора и серверной сборки мусора), вспомогательные потоки отладчика, потоки метода завершения, потоки выгрузки <xref:System.AppDomain> и потоки таймера пула потоков.|
|**ThreadState \<** *State value field* **>**|Отображает состояние потока. Параметр `value` представляет собой значение поля `State` в выводе отчета **Потоки**.<br /><br /> Пример.<br /><br /> `0:003> !Threads     ThreadCount:      2     UnstartedThread:  0     BackgroundThread: 1     PendingThread:    0     DeadThread:       0     Hosted Runtime:   no                                           PreEmptive   GC Alloc           Lock            ID OSID ThreadOBJ    State     GC       Context       Domain   Count APT Exception        0    1  250 0019b068      a020 Disabled 02349668:02349fe8 0015def0     0 MTA        2    2  944 001a6020      b220 Enabled  00000000:00000000 0015def0     0 MTA (Finalizer)     0:003> !ThreadState b220         Legal to Join         Background         CLR Owns         CoInitialized         In Multi Threaded Apartment`|
|**TraverseHeap** [ **-xml**] \<*filename*>|Записывает данные кучи в указанный файл в формате, распознаваемом профилировщиком CLR. Параметр **-xml** предписывает команде **TraverseHeap** преобразовать файл в формат XML.<br /><br /> Профилировщик CLR можно скачать в [центре загрузки Майкрософт](https://go.microsoft.com/fwlink/?LinkID=67325).|
|**U** [ **-gcinfo**] [ **-ehinfo**] [ **-n**] \<*MethodDesc address*> &#124; \<*Code address*>|Отображает дизассемблированный код с примечаниями для управляемого метода, заданного указателем структуры `MethodDesc` или адресом кода в теле метода. Команда **U** отображает весь метод от начала до конца, с примечаниями, преобразующими токены метаданных в имена.<br /><br /> Параметр **-gcinfo** предписывает команде **U** отобразить структуру `GCInfo` метода.<br /><br /> Параметр **-ehinfo** задает отображение сведений об исключениях в методе. Эту информацию можно также получить с помощью команды **EHInfo**.<br /><br /> Параметр **-n** отключает отображение имен исходных файлов и номеров строк. Если для отладчика указан параметр "SYMOPT_LOAD_LINES", расширение отладчика SOS ищет символы для каждого управляемого кадра и в случае успеха отображает соответствующее имя исходного файла и номер строки. Чтобы отключить это поведение, можно указать параметр **-n**.|
|**VerifyHeap**|Проверяет кучу сборщика мусора на наличие признаков повреждения и отображает обнаруженные ошибки.<br /><br /> Повреждения кучи могут быть вызваны неправильно созданными вызовами неуправляемого кода.|
|**VerifyObj** \<*object address*>|Проверяет объект, передаваемый в качестве аргумента, на наличие повреждений.|
|**VMMap**|Выполняет обход виртуального адресного пространства и отображает тип защиты для каждого региона.|
|**VMStat**|Создает сводное представление виртуального адресного пространства, упорядоченное по типам защиты соответствующих видов памяти (свободная, зарезервированная, выделенная, закрытая, отображаемая, образ). В столбце "TOTAL" содержится результат умножения значения в столбце "AVERAGE" на значение в столбце "BLK COUNT".|

## <a name="remarks"></a>Примечания

Расширение отладки SOS позволяет просматривать сведения о коде, выполняемом в среде CLR. Например, с помощью расширения отладки SOS можно получать сведения об управляемой куче, искать повреждения кучи, отображать внутренние типы данных, используемые средой выполнения, и просматривать информацию о любом управляемом коде, запущенном в среде выполнения.

Для работы с расширением отладчика SOS в Visual Studio установите [Комплект разработки драйверов для Windows (WDK)](/windows-hardware/drivers/download-the-wdk). Дополнительные сведения об интегрированной среде отладки в Visual Studio см. в статье [Debugging Environments](/windows-hardware/drivers/debugger/debuggers-in-the-debugging-tools-for-windows-package) (Среды отладки).

Расширение отладки SOS можно также загрузить в [отладчик WinDbg.exe](/windows-hardware/drivers/debugger/debugger-download-tools) и выполнять команды в этом отладчике.

Чтобы загрузить расширение отладки SOS в отладчик WinDbg.exe, выполните в программе следующую команду.

```console
.loadby sos clr
```

Отладчик WinDbg.exe и Visual Studio используют версию библиотеки "SOS.dll", которая соответствует текущей версии "Mscorwks.dll". По умолчанию следует использовать версию библиотеки "SOS.dll", которая соответствует текущей версии "Mscorwks.dll".

Чтобы использовать файл дампа, созданный на другом компьютере, убедитесь, что файл "Mscorwks.dll", поступивший вместе с этой установленной копией, указан в пути к символам в данной системе, и загрузите соответствующую версию библиотеки "SOS.dll".

Чтобы загрузить определенную версию библиотеки "SOS.dll", введите в окне отладчика Windows следующую команду.

```console
.load <full path to sos.dll>
```

## <a name="examples"></a>Примеры

Следующая команда отображает содержимое массива по адресу `00ad28d0`.  Отображаются данные для пяти элементов массива, начиная со второго.

```console
!dumparray -start 2 -length 5 -detail 00ad28d0
```

Следующая команда отображает содержимое сборки по адресу `1ca248`.

```console
!dumpassembly 1ca248
```

Следующая команда отображает сведения о куче сборщика мусора.

```console
!dumpheap
```

Следующая команда записывает содержимое журнала нагрузок в памяти в файл "StressLog.txt" (по умолчанию), расположенный в текущем каталоге.

```console
!DumpLog
```

Следующая команда отображает структуру `MethodDesc` по адресу `902f40`.

```console
!dumpmd 902f40
```

Следующая команда отображает сведения о модуле по адресу `1caa50`.

```console
!dumpmodule 1caa50
```

Следующая команда отображает сведения об объекте по адресу `a79d40`.

```console
!DumpObj a79d40
```

Следующая команда отображает поля класса значений по адресу `00a79d9c`, используя таблицу методов по адресу `0090320c`.

```console
!DumpVC 0090320c 00a79d9c
```

Следующая команда отображает память процесса, используемую сборщиком мусора.

```console
!eeheap -gc
```

Следующая команда отображает все объекты, запланированные для заключительной обработки.

```console
!finalizequeue
```

Следующая команда находит домен приложения для объекта по адресу `00a79d98`.

```console
!findappdomain 00a79d98
```

Следующая команда отображает все дескрипторы сборщика мусора в текущем процессе.

```console
!gcinfo 5b68dbb8
```

Следующая команда отображает структуры `MethodTable` и `EEClass` для метода `Main` класса `MainClass` в модуле `unittest.exe`.

```console
!name2ee unittest.exe MainClass.Main
```

Следующая команда отображает сведения о токене метаданных по адресу `02000003` в модуле `unittest.exe`.

```console
!token2ee unittest.exe 02000003
```

## <a name="see-also"></a>См. также

- [Инструменты](index.md)
- [Оболочки командной строки для разработчиков](/visualstudio/ide/reference/command-prompt-powershell)
