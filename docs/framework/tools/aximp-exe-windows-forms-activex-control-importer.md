---
title: Aximp.exe (программа импорта элементов ActiveX форм Windows)
description: Ознакомьтесь с Aximp.exe, программой импорта элементов ActiveX Windows Forms. Это средство преобразует определения типов в библиотеке типов COM для элемента управления ActiveX в Windows Forms.
ms.date: 03/30/2017
helpviewer_keywords:
- ActiveX controls, hosting in Windows Forms
- ActiveX Control Importer
- type definitions, converting
- Aximp.exe
- Windows Forms ActiveX Control Importer
ms.assetid: 482c0d83-7144-4497-b626-87d2351b78d0
ms.openlocfilehash: e0ee504f87eba811dab3422a367a60e235b3c51b
ms.sourcegitcommit: 1dbe25ff484a02025d5c34146e517c236f7161fb
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "104652923"
---
# <a name="aximpexe-windows-forms-activex-control-importer"></a><span data-ttu-id="e4b81-104">Aximp.exe (программа импорта элементов ActiveX форм Windows)</span><span class="sxs-lookup"><span data-stu-id="e4b81-104">Aximp.exe (Windows Forms ActiveX Control Importer)</span></span>

<span data-ttu-id="e4b81-105">Программа для импорта элементов управления ActiveX преобразует определения типов в библиотеке типов COM для элемента управления ActiveX в элемент управления Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="e4b81-105">The ActiveX Control Importer converts type definitions in a COM type library for an ActiveX control into a Windows Forms control.</span></span>  
  
 <span data-ttu-id="e4b81-106">В Windows Forms могут находиться только элементы управления Windows Forms, то есть классы, производные от класса <xref:System.Windows.Forms.Control>.</span><span class="sxs-lookup"><span data-stu-id="e4b81-106">Windows Forms can only host Windows Forms controls — that is, classes that are derived from <xref:System.Windows.Forms.Control>.</span></span> <span data-ttu-id="e4b81-107">Программа Aximp.exe создает класс-оболочку для элемента управления ActiveX, который может быть размещен в Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="e4b81-107">Aximp.exe generates a wrapper class for an ActiveX control that can be hosted on a Windows Form.</span></span> <span data-ttu-id="e4b81-108">Благодаря этому во время разработки можно использовать ту же методологию программирования и поддержки, что и для других элементов управления Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="e4b81-108">This allows you to use the same design-time support and programming methodology applicable to other Windows Forms controls.</span></span>  
  
 <span data-ttu-id="e4b81-109">Чтобы разместить элемент управления ActiveX, необходимо создать элемент управления-оболочку, производный от <xref:System.Windows.Forms.AxHost>.</span><span class="sxs-lookup"><span data-stu-id="e4b81-109">To host the ActiveX control, you must generate a wrapper control that derives from <xref:System.Windows.Forms.AxHost>.</span></span> <span data-ttu-id="e4b81-110">Этот элемент управления-оболочка содержит экземпляр базового элемента управления ActiveX.</span><span class="sxs-lookup"><span data-stu-id="e4b81-110">This wrapper control contains an instance of the underlying ActiveX control.</span></span> <span data-ttu-id="e4b81-111">Оболочка может взаимодействовать с элементом управления ActiveX, но выглядит как элемент управления Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="e4b81-111">It knows how to communicate with the ActiveX control, but it appears as a Windows Forms control.</span></span> <span data-ttu-id="e4b81-112">Созданный элемент управления размещает элемент управления ActiveX и представляет его свойства, методы и события как свои собственные.</span><span class="sxs-lookup"><span data-stu-id="e4b81-112">This generated control hosts the ActiveX control and exposes its properties, methods, and events as those of the generated control.</span></span>  
  
 <span data-ttu-id="e4b81-113">Эта программа автоматически устанавливается вместе с Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e4b81-113">This tool is automatically installed with Visual Studio.</span></span> <span data-ttu-id="e4b81-114">Для запуска этого средства используйте [Командную строку разработчика или PowerShell для разработчиков в Visual Studio](/visualstudio/ide/reference/command-prompt-powershell).</span><span class="sxs-lookup"><span data-stu-id="e4b81-114">To run the tool, use [Visual Studio Developer Command Prompt or Visual Studio Developer PowerShell](/visualstudio/ide/reference/command-prompt-powershell).</span></span>
  
 <span data-ttu-id="e4b81-115">В командной строке введите следующее.</span><span class="sxs-lookup"><span data-stu-id="e4b81-115">At the command prompt, type the following:</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="e4b81-116">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="e4b81-116">Syntax</span></span>  
  
```console  
aximp [options]{file.dll | file.ocx}  
```  
  
## <a name="remarks"></a><span data-ttu-id="e4b81-117">Remarks</span><span class="sxs-lookup"><span data-stu-id="e4b81-117">Remarks</span></span>  
  
|<span data-ttu-id="e4b81-118">Аргумент</span><span class="sxs-lookup"><span data-stu-id="e4b81-118">Argument</span></span>|<span data-ttu-id="e4b81-119">Описание</span><span class="sxs-lookup"><span data-stu-id="e4b81-119">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="e4b81-120">*file*</span><span class="sxs-lookup"><span data-stu-id="e4b81-120">*file*</span></span>|<span data-ttu-id="e4b81-121">Имя исходного файла, содержащего преобразуемый элемент управления ActiveX.</span><span class="sxs-lookup"><span data-stu-id="e4b81-121">The name of the source file that contains the ActiveX control to convert.</span></span> <span data-ttu-id="e4b81-122">Аргумент файла должен иметь расширение DLL или OCX.</span><span class="sxs-lookup"><span data-stu-id="e4b81-122">The file argument must have the extension .dll or .ocx.</span></span>|  
  
|<span data-ttu-id="e4b81-123">Параметр</span><span class="sxs-lookup"><span data-stu-id="e4b81-123">Option</span></span>|<span data-ttu-id="e4b81-124">Описание:</span><span class="sxs-lookup"><span data-stu-id="e4b81-124">Description</span></span>|  
|------------|-----------------|  
|`/delaysign`|<span data-ttu-id="e4b81-125">Указывает программе Aximp.exe подписывать полученный элемент управления отложенной подписью.</span><span class="sxs-lookup"><span data-stu-id="e4b81-125">Specifies to Aximp.exe to sign the resulting control using delayed signing.</span></span> <span data-ttu-id="e4b81-126">Этот параметр необходимо задавать вместе с параметром `/keycontainer:`, `/keyfile:` или `/publickey:`.</span><span class="sxs-lookup"><span data-stu-id="e4b81-126">You must specify this option with either the `/keycontainer:`, `/keyfile:`, or `/publickey:` option.</span></span> <span data-ttu-id="e4b81-127">Дополнительные сведения о процессе отложенной подписи см. в разделе [Отложенная подпись сборки](../../standard/assembly/delay-sign.md).</span><span class="sxs-lookup"><span data-stu-id="e4b81-127">For more information on the delayed signing process, see [Delay Signing an Assembly](../../standard/assembly/delay-sign.md).</span></span>|  
|`/help`|<span data-ttu-id="e4b81-128">Отображает синтаксис команд и параметров программы.</span><span class="sxs-lookup"><span data-stu-id="e4b81-128">Displays command syntax and options for the tool.</span></span>|  
|<span data-ttu-id="e4b81-129">`/keycontainer:` *containerName*</span><span class="sxs-lookup"><span data-stu-id="e4b81-129">`/keycontainer:` *containerName*</span></span>|<span data-ttu-id="e4b81-130">Подписывает результирующий элемент управления строгим именем, используя пару ключей (открытый/закрытый) из контейнера ключей, заданного аргументом *containerName*.</span><span class="sxs-lookup"><span data-stu-id="e4b81-130">Signs the resulting control with a strong name using the public/private key pair found in the key container specified by *containerName*.</span></span>|  
|<span data-ttu-id="e4b81-131">`/keyfile:` *filename*</span><span class="sxs-lookup"><span data-stu-id="e4b81-131">`/keyfile:` *filename*</span></span>|<span data-ttu-id="e4b81-132">Подписывает полученный элемент управления строгим именем, используя официальную пару ключей издателя (открытый-закрытый) из *filename*.</span><span class="sxs-lookup"><span data-stu-id="e4b81-132">Signs the resulting control with a strong name using the publisher's official public/private key pair found in *filename*.</span></span>|  
|`/nologo`|<span data-ttu-id="e4b81-133">Отключает отображение эмблемы Майкрософт при запуске.</span><span class="sxs-lookup"><span data-stu-id="e4b81-133">Suppresses the Microsoft startup banner display.</span></span>|  
|<span data-ttu-id="e4b81-134">`/out:` *filename*</span><span class="sxs-lookup"><span data-stu-id="e4b81-134">`/out:` *filename*</span></span>|<span data-ttu-id="e4b81-135">Задает имя создаваемой сборки.</span><span class="sxs-lookup"><span data-stu-id="e4b81-135">Specifies the name of the assembly to create.</span></span>|  
|<span data-ttu-id="e4b81-136">`/publickey:` *filename*</span><span class="sxs-lookup"><span data-stu-id="e4b81-136">`/publickey:` *filename*</span></span>|<span data-ttu-id="e4b81-137">Подписывает полученный элемент управления строгим именем с помощью открытого ключа из *filename*.</span><span class="sxs-lookup"><span data-stu-id="e4b81-137">Signs the resulting control with a strong name using the public key found in the file specified by *filename*.</span></span>|  
|<span data-ttu-id="e4b81-138">`/rcw:` *filename*</span><span class="sxs-lookup"><span data-stu-id="e4b81-138">`/rcw:` *filename*</span></span>|<span data-ttu-id="e4b81-139">Использует указанную вызываемую оболочку времени выполнения вместо создания новой.</span><span class="sxs-lookup"><span data-stu-id="e4b81-139">Uses the specified runtime callable wrapper instead of generating a new one.</span></span> <span data-ttu-id="e4b81-140">Можно указать несколько экземпляров.</span><span class="sxs-lookup"><span data-stu-id="e4b81-140">You may specify multiple instances.</span></span> <span data-ttu-id="e4b81-141">Для относительных путей используется текущий каталог.</span><span class="sxs-lookup"><span data-stu-id="e4b81-141">The current directory is used for relative paths.</span></span> <span data-ttu-id="e4b81-142">Дополнительные сведения см. в разделе [Вызываемая оболочка времени выполнения](../../standard/native-interop/runtime-callable-wrapper.md).</span><span class="sxs-lookup"><span data-stu-id="e4b81-142">For more information, see [Runtime Callable Wrapper](../../standard/native-interop/runtime-callable-wrapper.md).</span></span>|  
|`/silent`|<span data-ttu-id="e4b81-143">Запрещает отображение сообщений об успешно выполненных операциях.</span><span class="sxs-lookup"><span data-stu-id="e4b81-143">Suppresses the display of success messages.</span></span>|  
|`/source`|<span data-ttu-id="e4b81-144">Создает исходный код оболочки Windows Forms на языке C#.</span><span class="sxs-lookup"><span data-stu-id="e4b81-144">Generates C# source code for the Windows Forms wrapper.</span></span>|  
|`/verbose`|<span data-ttu-id="e4b81-145">Включает режим отображения дополнительных сведений о ходе выполнения.</span><span class="sxs-lookup"><span data-stu-id="e4b81-145">Specifies verbose mode; displays additional progress information.</span></span>|  
|`/?`|<span data-ttu-id="e4b81-146">Отображает синтаксис команд и параметров программы.</span><span class="sxs-lookup"><span data-stu-id="e4b81-146">Displays command syntax and options for the tool.</span></span>|  
  
 <span data-ttu-id="e4b81-147">Программа Aximp.exe преобразует всю библиотеку типов элемента управления ActiveX и создает набор сборок, содержащих метаданные среды CLR, и реализацию элементов управления для типов, определенных в исходной библиотеке типов.</span><span class="sxs-lookup"><span data-stu-id="e4b81-147">Aximp.exe converts an entire ActiveX Control type library at one time and produces a set of assemblies that contain the common language runtime metadata and control implementation for the types defined in the original type library.</span></span> <span data-ttu-id="e4b81-148">Имена файлов создаются по следующему шаблону.</span><span class="sxs-lookup"><span data-stu-id="e4b81-148">The generated files are named according to the following pattern:</span></span>  
  
 <span data-ttu-id="e4b81-149">Прокси среды CLR для типов COM: *progid*.dll</span><span class="sxs-lookup"><span data-stu-id="e4b81-149">common language runtime proxy for COM types: *progid*.dll</span></span>  
  
 <span data-ttu-id="e4b81-150">Прокси Windows Forms для элементов управления ActiveX (Ax обозначает ActiveX): Ax *progid*.dll</span><span class="sxs-lookup"><span data-stu-id="e4b81-150">Windows Forms proxy for ActiveX controls (where Ax signifies ActiveX): Ax *progid*.dll</span></span>  
  
> [!NOTE]
> <span data-ttu-id="e4b81-151">Если имя члена элемента управления ActiveX совпадает с именем, заданным в .NET Framework, к имени члена при создании производного класса AxHost программа Aximp.exe добавит префикс "Ctl".</span><span class="sxs-lookup"><span data-stu-id="e4b81-151">If the name of a member of the ActiveX control matches a name defined in the .NET Framework, Aximp.exe will prefix the member name with "Ctl" when it creates the AxHost derived class.</span></span> <span data-ttu-id="e4b81-152">Например, если элемент управления ActiveX содержит член с именем "Layout", в производном классе "AxHost" он будет переименован в "CtlLayout", так как в .NET Framework задано событие "Layout".</span><span class="sxs-lookup"><span data-stu-id="e4b81-152">For example, if your ActiveX control has a member named "Layout," it is renamed "CtlLayout" in the AxHost derived class because the Layout event is defined within the .NET Framework.</span></span>  
  
 <span data-ttu-id="e4b81-153">Созданные файлы можно проверить с помощью таких программ, как [Ildasm.exe (дизассемблер IL)](ildasm-exe-il-disassembler.md).</span><span class="sxs-lookup"><span data-stu-id="e4b81-153">You can examine these generated files with tools such as [Ildasm.exe (IL Disassembler)](ildasm-exe-il-disassembler.md).</span></span>  
  
 <span data-ttu-id="e4b81-154">Использование программы Aximp.exe для создания сборки .NET для элемента управления ActiveX WebBrowser (shdocvw.dll) не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="e4b81-154">Using Aximp.exe to generate a .NET assembly for the ActiveX WebBrowser control (shdocvw.dll) is not supported.</span></span>  
  
 <span data-ttu-id="e4b81-155">Если программа Aximp.exe выполняется для "shdocvw.dll", она всегда создает другой файл с именем "shdocvw.dll" в каталоге, из которого запускается программа.</span><span class="sxs-lookup"><span data-stu-id="e4b81-155">When you run Aximp.exe over shdocvw.dll, it will always create another file named shdocvw.dll in the directory from which the tool is run.</span></span> <span data-ttu-id="e4b81-156">Помещение вновь созданного файла в каталог "Documents and Settings" может привести к сбоям в работе Microsoft Internet Explorer и проводника Windows.</span><span class="sxs-lookup"><span data-stu-id="e4b81-156">If this generated file is placed in the Documents and Settings directory, it causes problems for Microsoft Internet Explorer and Windows Explorer.</span></span> <span data-ttu-id="e4b81-157">При перезагрузке компьютера операционная система Windows сначала выполняет поиск копии "shdocvw.dll" в каталоге "Documents and Settings" и только затем — в каталоге "system32".</span><span class="sxs-lookup"><span data-stu-id="e4b81-157">When the computer is rebooted, Windows looks in the Documents and Settings directory before the system32 directory to find a copy of shdocvw.dll.</span></span> <span data-ttu-id="e4b81-158">Операционная система будет использовать копию, найденную в каталоге "Documents and Settings", и попытается загрузить управляемые оболочки.</span><span class="sxs-lookup"><span data-stu-id="e4b81-158">It will use the copy it finds in Documents and Settings and attempt to load the managed wrappers.</span></span> <span data-ttu-id="e4b81-159">Internet Explorer и Проводник Windows будут работать неправильно, поскольку они используют механизм отрисовки из версии "shdocvw.dll", расположенной в каталоге "system32".</span><span class="sxs-lookup"><span data-stu-id="e4b81-159">Internet Explorer and Windows Explorer will not function properly because they rely on the rendering engine in the version of shdocvw.dll located in the system32 directory.</span></span> <span data-ttu-id="e4b81-160">В случае возникновения этой проблемы удалите копию "shdocvw.dll" из каталога "Documents and Settings" и перезагрузите компьютер.</span><span class="sxs-lookup"><span data-stu-id="e4b81-160">If this problem occurs, delete the copy of shdocvw.dll in the Documents and Settings directory and reboot the computer.</span></span>  
  
 <span data-ttu-id="e4b81-161">Кроме того, проблемы могут возникнуть при использовании программы Aximp.exe с "shdocvw.dll" для создания сборки .NET, которая будет использоваться при разработке приложения.</span><span class="sxs-lookup"><span data-stu-id="e4b81-161">Using Aximp.exe with shdocvw.dll to create a .NET assembly for use in application development can also cause problems.</span></span> <span data-ttu-id="e4b81-162">В этом случае приложение загружает и системную версию "shdocvw.dll", и созданную версию, а также может задавать приоритет системной версии.</span><span class="sxs-lookup"><span data-stu-id="e4b81-162">In this case, your application will load both the system version of shdocvw.dll and the generated version, and may give the system version priority.</span></span> <span data-ttu-id="e4b81-163">В такой ситуации при попытке загрузить веб-страницу в элемент управления ActiveX WebBrowser пользователю может быть выведено диалоговое окно "Открыть/Сохранить".</span><span class="sxs-lookup"><span data-stu-id="e4b81-163">In this case, when you attempt to load a Web page inside the WebBrowser ActiveX control, users may be prompted with an Open/Save dialog box.</span></span> <span data-ttu-id="e4b81-164">Когда пользователь щелкает **Открыть**, веб-страница открывается в браузере Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="e4b81-164">When the user clicks **Open**, the Web page will be opened in Internet Explorer.</span></span> <span data-ttu-id="e4b81-165">Это происходит только на тех компьютерах, на которых установлен Internet Explorer версии 6 или более ранней версии.</span><span class="sxs-lookup"><span data-stu-id="e4b81-165">This occurs only with computers that are running Internet Explorer version 6 or earlier.</span></span> <span data-ttu-id="e4b81-166">Чтобы избежать этой проблемы, следует использовать управляемый элемент управления <xref:System.Windows.Forms.WebBrowser> или Visual Studio для создания управляемой библиотеки "shdocvw.dll", как описано в разделе [Практическое руководство. Добавление ссылок на библиотеки типов](../interop/how-to-add-references-to-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="e4b81-166">To prevent this problem, use the managed <xref:System.Windows.Forms.WebBrowser> control or use Visual Studio to generate the managed shdocvw.dll as described in [How to: Add References to Type Libraries](../interop/how-to-add-references-to-type-libraries.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="e4b81-167">Пример</span><span class="sxs-lookup"><span data-stu-id="e4b81-167">Example</span></span>  

 <span data-ttu-id="e4b81-168">При выполнении указанной ниже команды создаются библиотеки "MediaPlayer.dll" и "AxMediaPlayer.dll" для элемента управления Media Player `msdxm.ocx`.</span><span class="sxs-lookup"><span data-stu-id="e4b81-168">The following command generates MediaPlayer.dll and AxMediaPlayer.dll for the Media Player control `msdxm.ocx`.</span></span>  
  
```console
aximp c:\systemroot\system32\msdxm.ocx  
```  
  
## <a name="see-also"></a><span data-ttu-id="e4b81-169">См. также</span><span class="sxs-lookup"><span data-stu-id="e4b81-169">See also</span></span>

- [<span data-ttu-id="e4b81-170">Инструменты</span><span class="sxs-lookup"><span data-stu-id="e4b81-170">Tools</span></span>](index.md)
- [<span data-ttu-id="e4b81-171">Ildasm.exe (дизассемблер IL)</span><span class="sxs-lookup"><span data-stu-id="e4b81-171">Ildasm.exe (IL Disassembler)</span></span>](ildasm-exe-il-disassembler.md)
