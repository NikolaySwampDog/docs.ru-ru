---
title: Развертывание современных классических приложений
description: Все, что нужно знать о развертывании современных классических приложений.
ms.date: 05/12/2020
ms.openlocfilehash: ba47f09b27adf270734bbfff285fe44dd4175d29
ms.sourcegitcommit: 05d0087dfca85aac9ca2960f86c5efd218bf833f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/30/2021
ms.locfileid: "98615858"
---
# <a name="deploying-modern-desktop-applications"></a><span data-ttu-id="903ad-103">Развертывание современных классических приложений</span><span class="sxs-lookup"><span data-stu-id="903ad-103">Deploying Modern Desktop Applications</span></span>

<span data-ttu-id="903ad-104">При разработке классических приложений необходимо учитывать, как ваше приложение будет упаковываться и развертываться на компьютерах пользователей.</span><span class="sxs-lookup"><span data-stu-id="903ad-104">When you develop desktop applications, one thing to consider is how your application is going to be packaged and deployed to the users' machines.</span></span> <span data-ttu-id="903ad-105">Проблема, связанная с упаковкой, развертыванием и установкой, заключается в том, что ими обычно занимаются исключительно ИТ-специалисты, которых волнуют совсем не те вещи, что и разработчиков.</span><span class="sxs-lookup"><span data-stu-id="903ad-105">The problem with packaging, deployment, and installation is that it usually falls under the umbrella of the IT professionals, who care about different things than developers.</span></span>

<span data-ttu-id="903ad-106">Сегодня мы знакомы с концепцией DevOps, где разработчики и ИТ-специалисты тесно взаимодействуют друг с другом для переноса приложений в рабочие среды.</span><span class="sxs-lookup"><span data-stu-id="903ad-106">These days, we're all familiar with the DevOps concept, where developers and IT Pros work closely to move applications to their production environments.</span></span> <span data-ttu-id="903ad-107">Однако если вы занимаетесь разработкой классических приложений уже более 10 лет, то могли быть свидетелем следующей ситуации.</span><span class="sxs-lookup"><span data-stu-id="903ad-107">But if you've been in the desktop battle for more than 10 years, you might have seen the following story.</span></span> <span data-ttu-id="903ad-108">Команда разработчиков усиленно трудится для соблюдения крайних сроков проекта.</span><span class="sxs-lookup"><span data-stu-id="903ad-108">A team of developers works together hard to meet the project deadlines.</span></span> <span data-ttu-id="903ad-109">Руководители нервничают, так как для функционирования бизнеса им требуется система, работающая на множестве компьютеров пользователей.</span><span class="sxs-lookup"><span data-stu-id="903ad-109">Business people are nervous since they need the system working on many user's machines to run the company.</span></span> <span data-ttu-id="903ad-110">В день "Д" менеджер по проектам проверяет, правильно ли работает код каждого из разработчиков, чтобы можно было осуществлять доставку.</span><span class="sxs-lookup"><span data-stu-id="903ad-110">On "D-Day", the project manager checks with every developer that their code is working well and that everything is fine, so they can ship.</span></span> <span data-ttu-id="903ad-111">Затем в работу включается команда упаковки, которая создает для приложения программу установки, распространяет ее на каждый компьютер пользователя, после чего группа тестовых пользователей запускает приложение.</span><span class="sxs-lookup"><span data-stu-id="903ad-111">Then, the package team comes in generating the setup for the app, distribute it to every user machine and a set of test users run the application.</span></span> <span data-ttu-id="903ad-112">Ну, они пытаются, так как перед отображением пользовательского интерфейса приложение выдает исключение с сообщением "Сбой метода ~ объекта ~".</span><span class="sxs-lookup"><span data-stu-id="903ad-112">Well, they try, because before showing any UI, the application throws an exception that says "Method ~ of object ~ failed".</span></span> <span data-ttu-id="903ad-113">В воздухе появляется напряженность, и небольшое исследование приводит к молодому и уставшему разработчику, который внес сторонний элемент управления, который определенно "работал на компьютере разработки".</span><span class="sxs-lookup"><span data-stu-id="903ad-113">Panic starts flowing through the air and a brief investigation points to a young and tired developer that has introduced a third-party control, that certainly "worked on the dev machine".</span></span>

<span data-ttu-id="903ad-114">Установка классических приложений всегда была настоящим кошмаром по двум основным причинам:</span><span class="sxs-lookup"><span data-stu-id="903ad-114">Installing desktop applications have traditionally been a nightmare for two main reasons:</span></span>

- <span data-ttu-id="903ad-115">Отсутствие культуры тесного сотрудничества между разработчиками и ИТ-специалистами.</span><span class="sxs-lookup"><span data-stu-id="903ad-115">Lack of close collaboration culture between dev and IT teams.</span></span>
- <span data-ttu-id="903ad-116">Отсутствие единой технологии упаковки и развертывания, на которую можно положиться.</span><span class="sxs-lookup"><span data-stu-id="903ad-116">Lack of a solid packaging and deploying technology we can build upon.</span></span>

<span data-ttu-id="903ad-117">На самом деле нам приходилось мириться с тем фактом, что установка приложения могла вызвать только сожаление, так как:</span><span class="sxs-lookup"><span data-stu-id="903ad-117">In fact, we've been living with the fact that sometimes you regret that you installed an app because:</span></span>

- <span data-ttu-id="903ad-118">На вашем компьютере в работе приложения возникают нежелательные побочные эффекты.</span><span class="sxs-lookup"><span data-stu-id="903ad-118">It ends up having some undesired side effects on your machine.</span></span>
- <span data-ttu-id="903ad-119">Некоторые из установленных ранее приложений перестают работать.</span><span class="sxs-lookup"><span data-stu-id="903ad-119">Some applications that were previously installed stop working.</span></span>

<span data-ttu-id="903ad-120">Кроме того, вы не можете просто восстановить систему в исходное состояние путем удаления приложения.</span><span class="sxs-lookup"><span data-stu-id="903ad-120">Additionally, you can't just restore the system to its original state by uninstalling the app.</span></span> <span data-ttu-id="903ad-121">Мы постоянно сталкивались с подобной ситуацией, которую прозвали "DLL-путаницей", "захламлением" или "Winrot".</span><span class="sxs-lookup"><span data-stu-id="903ad-121">We're so used to live this situation that we've coined terms like "DLL Hell" or "Winrot".</span></span>

<span data-ttu-id="903ad-122">В этой главе мы поговорим о MSIX.</span><span class="sxs-lookup"><span data-stu-id="903ad-122">In this chapter, we'll talk about MSIX.</span></span> <span data-ttu-id="903ad-123">MSIX — это новая технология от корпорации Майкрософт, которая стремится взять лучшее из предыдущих технологий, чтобы обеспечить надежную основу для технологии упаковки будущего.</span><span class="sxs-lookup"><span data-stu-id="903ad-123">MSIX is the brand-new technology from Microsoft that tries to capture the best of previous technologies to provide a solid foundation for the packaging technology of the future.</span></span>

<span data-ttu-id="903ad-124">Как технология упаковки связана с модернизацией?</span><span class="sxs-lookup"><span data-stu-id="903ad-124">What does a packaging technology have to do with modernization?</span></span> <span data-ttu-id="903ad-125">Оказалось, что упаковка является основополагающей для корпоративных ИТ-служб, и в нее вкладываются значительные средства.</span><span class="sxs-lookup"><span data-stu-id="903ad-125">Well, it turns out that packaging is fundamental for the enterprise IT with lots of money invested there.</span></span> <span data-ttu-id="903ad-126">Модернизация не ограничивается использованием новейших технологий.</span><span class="sxs-lookup"><span data-stu-id="903ad-126">Modernization isn't only related to using the latest technologies.</span></span> <span data-ttu-id="903ad-127">Она также нацелена на сокращение времени выхода на рынок с момента определения бизнес-требования и до момента, когда ваша организация доставляет соответствующий компонент клиенту.</span><span class="sxs-lookup"><span data-stu-id="903ad-127">It's also related to reducing time to market from the moment a business requirement is defined until your company delivers the feature to your client.</span></span>

## <a name="the-modern-application-lifecycle"></a><span data-ttu-id="903ad-128">Жизненный цикл современного приложения</span><span class="sxs-lookup"><span data-stu-id="903ad-128">The modern application lifecycle</span></span>

<span data-ttu-id="903ad-129">Сейчас разработчики пишут и собирают код для приложения, после чего передают созданные ресурсы ИТ-специалистам.</span><span class="sxs-lookup"><span data-stu-id="903ad-129">Today, developers write and build the code for an app and then pass the generated assets to the IT Pros.</span></span> <span data-ttu-id="903ad-130">После этого ИТ-специалисты перестраивают приложение и переупаковывают его, как правило, в формате MSI или более новом App-V.</span><span class="sxs-lookup"><span data-stu-id="903ad-130">Then, the IT Pros reconfigure the app and repackage it, typically in an MSI or more recently in an App-V packaging format.</span></span> <span data-ttu-id="903ad-131">Затем приложение развертывают с помощью различных каналов и средств.</span><span class="sxs-lookup"><span data-stu-id="903ad-131">The app is then deployed through different channels and tools.</span></span> <span data-ttu-id="903ad-132">Одна из основных проблем такого подхода обычно называется 	"коллапсом упаковки".</span><span class="sxs-lookup"><span data-stu-id="903ad-132">One of the main problems with this approach is commonly known as "packaging paralysis".</span></span> <span data-ttu-id="903ad-133">Проблема заключается в том, что этот цикл повторяется каждый раз при обновлении приложения или операционной системы.</span><span class="sxs-lookup"><span data-stu-id="903ad-133">The problem is that this cycle repeats every time there's an app update or an OS update.</span></span>

<span data-ttu-id="903ad-134">Данный процесс проиллюстрирован на следующем рисунке:</span><span class="sxs-lookup"><span data-stu-id="903ad-134">You can see the process reflected on the following picture:</span></span>

![Схема, показывающая современный жизненный цикл ИТ](./media/deploy-modern-applications/modern-it-application-lifecycle.png)

<span data-ttu-id="903ad-136">Организациям требуется способ разбить этот цикл упаковки на три независимых цикла:</span><span class="sxs-lookup"><span data-stu-id="903ad-136">Companies need a way to break this packaging cycle into three independent cycles:</span></span>

- <span data-ttu-id="903ad-137">Обновления ОС</span><span class="sxs-lookup"><span data-stu-id="903ad-137">OS updates</span></span>
- <span data-ttu-id="903ad-138">Обновления приложений</span><span class="sxs-lookup"><span data-stu-id="903ad-138">Application updates</span></span>
- <span data-ttu-id="903ad-139">Настройка</span><span class="sxs-lookup"><span data-stu-id="903ad-139">Customization</span></span>

![Схема, показывающая современный эффективный цикл ИТ](./media/deploy-modern-applications/modern-it-virtuous-cycle.png)

<span data-ttu-id="903ad-141">На предыдущей схеме показано, что вам доступны следующие возможности:</span><span class="sxs-lookup"><span data-stu-id="903ad-141">The previous diagram shows that you can:</span></span>

- <span data-ttu-id="903ad-142">Обновление базовой ОС без необходимости переупаковки приложений.</span><span class="sxs-lookup"><span data-stu-id="903ad-142">Update the underlying OS without having to repackage your apps.</span></span>
- <span data-ttu-id="903ad-143">Реализация настроек со стороны ИТ-специалистов без необходимости переупаковки исходного пакета разработчика.</span><span class="sxs-lookup"><span data-stu-id="903ad-143">Enable customizations from IT without the need to repackage the original developer package.</span></span>

<span data-ttu-id="903ad-144">Это радикальное изменение приводит нас к новому и современному жизненному циклу ИТ, как показано на следующем рисунке:</span><span class="sxs-lookup"><span data-stu-id="903ad-144">This radical change leads us to the new and modern IT lifecycle as shown in the following picture:</span></span>

![Схема, показывающая жизненный цикл приложения при использовании средств Майкрософт](./media/deploy-modern-applications/microsoft-it-tools.png)

<span data-ttu-id="903ad-146">Разработчики создают приложение и формируют пакет MSIX, который ИТ-специалисты могут использовать и настраивать без переупаковки.</span><span class="sxs-lookup"><span data-stu-id="903ad-146">Developers create the app and generate an MSIX package that IT Pros can consume and configure without the need of repackaging.</span></span> <span data-ttu-id="903ad-147">Вместе с технологией MSIX корпорация Майкрософт создала средства, позволяющие ИТ-специалистам настраивать пакеты без переупаковки.</span><span class="sxs-lookup"><span data-stu-id="903ad-147">Along with the MSIX technology, Microsoft has created tools to allow IT to customize and configure packages without repackaging.</span></span>

## <a name="msix-the-next-generation-of-deployment"></a><span data-ttu-id="903ad-148">MSIX: следующее поколение развертывания</span><span class="sxs-lookup"><span data-stu-id="903ad-148">MSIX: The next generation of deployment</span></span>

<span data-ttu-id="903ad-149">До MSIX существовало несколько технологий упаковки, таких как мастера установки, MSI, ClickOnce, App-V и сценарии.</span><span class="sxs-lookup"><span data-stu-id="903ad-149">Before MSIX, there were several packaging technologies available like setup wizards, MSI, ClickOnce, App-V, and scripting.</span></span> <span data-ttu-id="903ad-150">Каждая из этих технологий имеет свои сильные стороны, и корпорация Майкрософт решила взять из них все лучшее для создания MSIX.</span><span class="sxs-lookup"><span data-stu-id="903ad-150">Each of these technologies has their own strengths and Microsoft has decided to pick the best of all to build MSIX.</span></span> <span data-ttu-id="903ad-151">Технология MSIX основана на этих существующих технологиях, вбирая в себя преимущества каждой из них:</span><span class="sxs-lookup"><span data-stu-id="903ad-151">MSIX is built on the foundations of these existing technologies picking the best of each:</span></span>

- <span data-ttu-id="903ad-152">App-V =\> контейнеризация</span><span class="sxs-lookup"><span data-stu-id="903ad-152">App-V =\> Containerization</span></span>
- <span data-ttu-id="903ad-153">ClickOnce =\> автоматическое обновление</span><span class="sxs-lookup"><span data-stu-id="903ad-153">ClickOnce =\> Auto updating</span></span>
- <span data-ttu-id="903ad-154">MSI =\> простота распространения</span><span class="sxs-lookup"><span data-stu-id="903ad-154">MSI =\> Easy to distribute</span></span>

<span data-ttu-id="903ad-155">Благодаря MSIX вы получаете одну технологию установщика со всеми этими функциями.</span><span class="sxs-lookup"><span data-stu-id="903ad-155">With MSIX, you get one installer technology with all these features.</span></span>

![Схема, показывающая различные технологии, которые оказывают влияние на создание MSIX](./media/deploy-modern-applications/msix.png)

### <a name="benefits-of-msix"></a><span data-ttu-id="903ad-157">Преимущества gRPC</span><span class="sxs-lookup"><span data-stu-id="903ad-157">Benefits of MSIX</span></span>

#### <a name="never-regret-installing-an-app"></a><span data-ttu-id="903ad-158">Установка приложений без сожалений</span><span class="sxs-lookup"><span data-stu-id="903ad-158">Never regret installing an app</span></span>

<span data-ttu-id="903ad-159">MSIX обеспечивает предсказуемое, надежное и безопасное развертывание.</span><span class="sxs-lookup"><span data-stu-id="903ad-159">MSIX provides a predictable, reliable, and safe deployment.</span></span> <span data-ttu-id="903ad-160">Декларативный метод, содержащийся в манифесте пакета, позволяет операционной системе отслеживать каждый из ресурсов, необходимых приложению.</span><span class="sxs-lookup"><span data-stu-id="903ad-160">The declarative method contained in the package manifest lets the OS keep track of every asset your application needs.</span></span> <span data-ttu-id="903ad-161">Он также обеспечивает действительно чистое удаление без побочных эффектов.</span><span class="sxs-lookup"><span data-stu-id="903ad-161">It also provides a true clean uninstall with no side effects.</span></span>

#### <a name="disk-space-optimization"></a><span data-ttu-id="903ad-162">Оптимизация дискового пространства</span><span class="sxs-lookup"><span data-stu-id="903ad-162">Disk space optimization</span></span>

<span data-ttu-id="903ad-163">Технология MSIX оптимизирована для уменьшения места, занимаемого приложением на диске компьютера пользователя.</span><span class="sxs-lookup"><span data-stu-id="903ad-163">MSIX is optimized to reduce the footprint that an application has on the user's machine disk space.</span></span> <span data-ttu-id="903ad-164">Она создает хранилище единственных копий ваших файлов.</span><span class="sxs-lookup"><span data-stu-id="903ad-164">It creates a single instance storage of your files.</span></span> <span data-ttu-id="903ad-165">То есть если у вас есть два разных пакета с одной и той же библиотекой DLL, она не устанавливается дважды.</span><span class="sxs-lookup"><span data-stu-id="903ad-165">That is, if you have two different packages with the same DLL, the DLL isn't installed twice.</span></span> <span data-ttu-id="903ad-166">Платформа может решить эту проблему, так как она знает обо всех файлах, установленных конкретным приложением, благодаря своей декларативной природе.</span><span class="sxs-lookup"><span data-stu-id="903ad-166">The platform takes care of that problem because it knows all the files that a particular app installed thanks to its declarative nature.</span></span> <span data-ttu-id="903ad-167">Она также позволяет использовать разные версии библиотеки DLL, работающие параллельно.</span><span class="sxs-lookup"><span data-stu-id="903ad-167">It also allows you to have different versions of a DLL working side by side.</span></span>

<span data-ttu-id="903ad-168">С помощью пакетов ресурсов можно легко создавать многоязычные приложения, и операционная система позаботится об установке нужных из них.</span><span class="sxs-lookup"><span data-stu-id="903ad-168">With the use of resource packages, you can easily create multilingual apps and the OS takes care of installing the ones that are used.</span></span>

#### <a name="network-optimization"></a><span data-ttu-id="903ad-169">Оптимизация сети</span><span class="sxs-lookup"><span data-stu-id="903ad-169">Network optimization</span></span>

<span data-ttu-id="903ad-170">MSIX обнаруживает различия в файлах на уровне байтового блока, позволяя использовать функцию разностных обновлений.</span><span class="sxs-lookup"><span data-stu-id="903ad-170">MSIX detects the differences on the files at the byte block level enabling a feature called differential updates.</span></span> <span data-ttu-id="903ad-171">Это означает, что при обновлениях приложения скачиваются только обновленные байтовые блоки.</span><span class="sxs-lookup"><span data-stu-id="903ad-171">What this means is that only the updated byte blocks are downloaded on application updates.</span></span>

![Схема, показывающая, как MSIX управляет разностными обновлениями](./media/deploy-modern-applications/msix-managing-updates.png)

<span data-ttu-id="903ad-173">Благодаря потоковой установке пользователь может быстро начать работу над приложением, пока другие части приложения скачиваются в фоновом режиме.</span><span class="sxs-lookup"><span data-stu-id="903ad-173">With streaming installation, the user can quickly start working on your application while other parts of the app are downloaded on the background.</span></span> <span data-ttu-id="903ad-174">Эта функция влияет на вовлечение пользователей в работу.</span><span class="sxs-lookup"><span data-stu-id="903ad-174">This feature contributes to an engaging experience for your users.</span></span>

<span data-ttu-id="903ad-175">С помощью дополнительных пакетов вы можете реализовать компонентное представление развертывания приложения, поэтому их можно скачивать по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="903ad-175">With the optional packages feature, you achieve componentization on your app deployment, so you can download them when needed.</span></span>

#### <a name="simple-packaging-and-deployment"></a><span data-ttu-id="903ad-176">Простота упаковки и развертывания</span><span class="sxs-lookup"><span data-stu-id="903ad-176">Simple packaging and deployment</span></span>

<span data-ttu-id="903ad-177">Манифест приложения объявляет управление версиями, нацеливание устройств и обеспечивает идентификацию стандартным образом для каждого приложения.</span><span class="sxs-lookup"><span data-stu-id="903ad-177">The AppManifest declares the versioning, device targeting and identify in a standard way for every application.</span></span> <span data-ttu-id="903ad-178">Он также позволяет подписывать активы, создавая надежную основу для системы безопасности.</span><span class="sxs-lookup"><span data-stu-id="903ad-178">It also provides a way to sign your assets providing a solid security foundation.</span></span>

#### <a name="os-managed"></a><span data-ttu-id="903ad-179">Управляемая операционная система</span><span class="sxs-lookup"><span data-stu-id="903ad-179">OS managed</span></span>

<span data-ttu-id="903ad-180">Операционная система обрабатывает все процессы по установке, обновлению и удалению приложения.</span><span class="sxs-lookup"><span data-stu-id="903ad-180">The OS handles all the processes for installing, updating, and removing an application.</span></span> <span data-ttu-id="903ad-181">Приложения устанавливаются для отдельных пользователей, но скачиваются только один раз, что сводит к минимуму используемое дисковое пространство.</span><span class="sxs-lookup"><span data-stu-id="903ad-181">Applications are installed per user but downloaded only once, minimizing the disk footprint.</span></span> <span data-ttu-id="903ad-182">Корпорация Майкрософт работает над предоставлением технологии MSIX также и в Windows 7.</span><span class="sxs-lookup"><span data-stu-id="903ad-182">Microsoft is working on providing the MSIX experience also on Windows 7.</span></span>

#### <a name="windows-provides-integrity-for-the-app"></a><span data-ttu-id="903ad-183">Обеспечение целостности приложения в Windows</span><span class="sxs-lookup"><span data-stu-id="903ad-183">Windows provides integrity for the app</span></span>

<span data-ttu-id="903ad-184">Цифровые подписи позволяют гарантированно предотвратить установку приложения из ненадежных источников.</span><span class="sxs-lookup"><span data-stu-id="903ad-184">With the use of digital signatures, you can guarantee that you don't install an application from untrusted sources.</span></span> <span data-ttu-id="903ad-185">Кроме того, система MSIX предотвращает незаконное изменение, поскольку:</span><span class="sxs-lookup"><span data-stu-id="903ad-185">MSIX also prevents tampering because:</span></span>

- <span data-ttu-id="903ad-186">хранит записи о хэшах файлов;</span><span class="sxs-lookup"><span data-stu-id="903ad-186">It keeps a record of file hashes.</span></span>
- <span data-ttu-id="903ad-187">определяет, был ли файл изменен после установки.</span><span class="sxs-lookup"><span data-stu-id="903ad-187">It detects if a file has been modified after installation.</span></span>

#### <a name="works-for-the-entire-app-catalog"></a><span data-ttu-id="903ad-188">Поддержка всего каталога приложений</span><span class="sxs-lookup"><span data-stu-id="903ad-188">Works for the entire App Catalog</span></span>

<span data-ttu-id="903ad-189">Одним из самых интересных аспектов технологии MSIX является то, что она работает для всего каталога приложений, Windows Forms, WPF, MFC/ATL, Delphi, даже если вы хотите выполнить развертывание xCopy, используете ClickOnce или переходите в Store, вы можете использовать один и тот же пакет MSIX.</span><span class="sxs-lookup"><span data-stu-id="903ad-189">One of the coolest things about MSIX is that it works for the entire application catalog, Windows Forms, WPF, MFC/ATL, Delphi, even if you want to do xCopy deployment, ClickOnce, or going to the Store, you can use the same MSIX package.</span></span>

### <a name="tools"></a><span data-ttu-id="903ad-190">Инструменты</span><span class="sxs-lookup"><span data-stu-id="903ad-190">Tools</span></span>

#### <a name="windows-application-packaging-project"></a><span data-ttu-id="903ad-191">Проект упаковки приложений Windows</span><span class="sxs-lookup"><span data-stu-id="903ad-191">Windows Application Packaging Project</span></span>

<span data-ttu-id="903ad-192">Для создания пакета для классического приложения в Visual Studio можно использовать **Проект упаковки приложений Windows**.</span><span class="sxs-lookup"><span data-stu-id="903ad-192">You can use the **Windows Application Packaging Project** project in Visual Studio to generate a package for your desktop app.</span></span> <span data-ttu-id="903ad-193">Затем можно опубликовать этот пакет в Microsoft Store или загрузить его в неопубликованном виде на один или несколько компьютеров.</span><span class="sxs-lookup"><span data-stu-id="903ad-193">Then, you can publish that package to the Microsoft Store or sideload it onto one or more PCs.</span></span>

#### <a name="msix-packaging-tool"></a><span data-ttu-id="903ad-194">Средство упаковки MSIX</span><span class="sxs-lookup"><span data-stu-id="903ad-194">MSIX Packaging Tool</span></span>

<span data-ttu-id="903ad-195">Средство упаковки MSIX позволяет повторно упаковывать существующие пакеты приложений Win32 в формате MSIX.</span><span class="sxs-lookup"><span data-stu-id="903ad-195">The MSIX Packaging Tool enables you to repackage your existing Win32 applications to the MSIX format.</span></span> <span data-ttu-id="903ad-196">Оно включает интерактивный пользовательский интерфейс и командную строку для преобразования, позволяя преобразовывать приложения без использования исходного кода.</span><span class="sxs-lookup"><span data-stu-id="903ad-196">It offers both an interactive UI and a command line for conversions and gives you the ability to convert an application without having the source code.</span></span>

![Средство упаковки MSIX](./media/deploy-modern-applications/msix-packaging-tool.png)

#### <a name="package-support-framework"></a><span data-ttu-id="903ad-198">Платформа поддержки пакетов</span><span class="sxs-lookup"><span data-stu-id="903ad-198">Package Support Framework</span></span>

<span data-ttu-id="903ad-199">Платформа поддержки пакетов представляет собой набор с открытым кодом, который помогает применять исправления к существующему приложению Win32, когда у вас нет доступа к исходному коду для работы в контейнере MSIX.</span><span class="sxs-lookup"><span data-stu-id="903ad-199">The Package Support Framework is an open-source kit that helps you apply fixes to your existing Win32 application when you don't have access to the source code, so that it can run in an MSIX container.</span></span> <span data-ttu-id="903ad-200">Платформа поддержки пакетов помогает настроить приложения в соответствии с требованиями современных сред выполнения.</span><span class="sxs-lookup"><span data-stu-id="903ad-200">The Package Support Framework helps your application follow the best practices of the modern runtime environment.</span></span>

#### <a name="app-installer"></a><span data-ttu-id="903ad-201">Установщик приложений</span><span class="sxs-lookup"><span data-stu-id="903ad-201">App Installer</span></span>

<span data-ttu-id="903ad-202">Установщик приложений позволяет устанавливать приложения Windows 10, дважды щелкнув пакет приложения.</span><span class="sxs-lookup"><span data-stu-id="903ad-202">App Installer allows Windows 10 apps to be installed by double-clicking the app package.</span></span> <span data-ttu-id="903ad-203">Это означает, что пользователям не нужно использовать PowerShell или другие средства разработчика для развертывания приложений Windows 10.</span><span class="sxs-lookup"><span data-stu-id="903ad-203">This means that users don't need to use PowerShell or other developer tools to deploy Windows 10 apps.</span></span> <span data-ttu-id="903ad-204">Кроме того, Установщик приложений может устанавливать приложения из Интернета, дополнительных пакетов и связанных наборов.</span><span class="sxs-lookup"><span data-stu-id="903ad-204">The App Installer can also install an app from the web, optional packages, and related sets.</span></span>

## <a name="how-to-create-an-msix-package-from-an-existing-win32-desktop-application"></a><span data-ttu-id="903ad-205">Создание пакета MSIX из существующего классического приложения Win32</span><span class="sxs-lookup"><span data-stu-id="903ad-205">How to create an MSIX package from an existing Win32 desktop application</span></span>

<span data-ttu-id="903ad-206">Давайте рассмотрим процесс создания пакета MSIX из существующего классического приложения Win32.</span><span class="sxs-lookup"><span data-stu-id="903ad-206">Let's go through the process to create an MSIX package from an existing Win32 application.</span></span> <span data-ttu-id="903ad-207">В этом примере мы будем использовать приложение Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="903ad-207">In this example, we'll use a Windows Forms app.</span></span>

<span data-ttu-id="903ad-208">Чтобы начать, добавьте в решение новый проект, выберите "Проект упаковки приложений Windows" и присвойте ему имя.</span><span class="sxs-lookup"><span data-stu-id="903ad-208">To start, add a new project to your solution, select the Windows Application Packaging Project, and give it a name.</span></span>

![Добавление нового Проекта упаковки приложений Windows](./media/deploy-modern-applications/add-packaging-project.png)

<span data-ttu-id="903ad-210">Вы увидите структуру проекта упаковки и заметите специальную папку *Applications*.</span><span class="sxs-lookup"><span data-stu-id="903ad-210">You'll see the structure of the packaging project and note a special folder called *Applications*.</span></span> <span data-ttu-id="903ad-211">В ней можно указать приложения, которые требуется включить в пакет.</span><span class="sxs-lookup"><span data-stu-id="903ad-211">Inside this folder, you can specify which applications you want to include in the package.</span></span> <span data-ttu-id="903ad-212">Их может быть несколько.</span><span class="sxs-lookup"><span data-stu-id="903ad-212">It can be more than one.</span></span>

![Структура проекта упаковки](./media/deploy-modern-applications/packaging-project.png)

<span data-ttu-id="903ad-214">Щелкните правой кнопкой мыши папку *Applications* и выберите проект Windows Forms, который хотите упаковать из решения Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="903ad-214">Right-click on the *Applications* folder and select the Windows Forms project you want to package from the Visual Studio solution.</span></span>

![Добавление проекта Windows Forms в проект упаковки](./media/deploy-modern-applications/add-winforms-project.png)

<span data-ttu-id="903ad-216">На этом этапе вы можете скомпилировать и создать пакет, но давайте рассмотрим несколько аспектов.</span><span class="sxs-lookup"><span data-stu-id="903ad-216">At this point, you can compile and generate the package but let's examine a couple of things.</span></span> <span data-ttu-id="903ad-217">Чтобы улучшить взаимодействие с пользователем, Visual Studio может автоматически создавать все визуальные ресурсы, необходимые современным приложениям для работы со значками, а также ресурсы плиток для панели плиток и меню "Пуск".</span><span class="sxs-lookup"><span data-stu-id="903ad-217">To have a better user experience, Visual Studio can autogenerate all the visual assets a modern application needs to handle icons and tile assets for the tile bar and start menu.</span></span> <span data-ttu-id="903ad-218">Откройте файл *Package.appxmanifest* для доступа к конструктору манифеста.</span><span class="sxs-lookup"><span data-stu-id="903ad-218">Open the *Package.appxmanifest* file to access the Manifest Designer.</span></span> <span data-ttu-id="903ad-219">После этого вы можете создать все визуальные ресурсы из заданного образа, присутствующего в проекте, просто нажав кнопку **Создать**.</span><span class="sxs-lookup"><span data-stu-id="903ad-219">You can then generate all the visual assets from a given image present on your project just by clicking **Create**.</span></span>

![Снимок экрана конструктора манифеста в Visual Studio](./media/deploy-modern-applications/manifest-designer.png)

<span data-ttu-id="903ad-221">Если открыть код для файла *Package.appxmanifest*, можно увидеть несколько интересных вещей.</span><span class="sxs-lookup"><span data-stu-id="903ad-221">If you open the code for the *Package.appxmanifest* file, you can see a couple of interesting things.</span></span>

<span data-ttu-id="903ad-222">Непосредственно под узлом `<Package>` находится узел `<Identity>`.</span><span class="sxs-lookup"><span data-stu-id="903ad-222">Right under `<Package>`, there's an `<Identity>` node.</span></span> <span data-ttu-id="903ad-223">Именно здесь упакованное приложение получит удостоверение, которым будет управлять операционная система.</span><span class="sxs-lookup"><span data-stu-id="903ad-223">This is where your packaged application is going to get its identity, which will be managed by the OS.</span></span>

![Узел "Identity"](./media/deploy-modern-applications/identity-node.png)

<span data-ttu-id="903ad-225">В узле `<Capabilities>` можно найти все требования, необходимые приложению, обращая особое внимание на элемент `<rescap:Capability Name="runFullTrust" \>`, который предписывает операционной системе запустить приложение в режиме полного доверия, так как это приложение Win32.</span><span class="sxs-lookup"><span data-stu-id="903ad-225">In the `<Capabilities>` node, you can find all the requirements the application needs, paying special attention to the `<rescap:Capability Name="runFullTrust" \>`, which tells the OS to run the app in full trust mode since it's a Win32 application.</span></span>

![Узел "Capabilities"](./media/deploy-modern-applications/capabilities-node.png)

<span data-ttu-id="903ad-227">Задайте проект упаковки в качестве запускаемого проекта для решения и выберите *Выполнить*.</span><span class="sxs-lookup"><span data-stu-id="903ad-227">Set the packaging project as the startup project for the solution and select *Run*.</span></span> <span data-ttu-id="903ad-228">Будут выполнены следующие операции:</span><span class="sxs-lookup"><span data-stu-id="903ad-228">This is going to:</span></span>

- <span data-ttu-id="903ad-229">Компиляция приложения Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="903ad-229">Compile the Windows Forms application.</span></span>
- <span data-ttu-id="903ad-230">Создание пакета MSIX из результатов сборки.</span><span class="sxs-lookup"><span data-stu-id="903ad-230">Create an MSIX package out of the build results.</span></span>
- <span data-ttu-id="903ad-231">Развертывание пакетов.</span><span class="sxs-lookup"><span data-stu-id="903ad-231">Deploy the packages.</span></span>
- <span data-ttu-id="903ad-232">Локальная установка на компьютере разработки.</span><span class="sxs-lookup"><span data-stu-id="903ad-232">Install it locally on the development machine.</span></span>
- <span data-ttu-id="903ad-233">запуск приложения;</span><span class="sxs-lookup"><span data-stu-id="903ad-233">Launch the app.</span></span>

![Наше установленное приложение](./media/deploy-modern-applications/our-installed-application.png)

<span data-ttu-id="903ad-235">Благодаря этому вы получаете чистую процедуру установки и удаления, которую MSIX полностью интегрирует в Windows 10.</span><span class="sxs-lookup"><span data-stu-id="903ad-235">With this, you have the clean install and uninstall experience that MSIX provides fully integrated into Windows 10.</span></span>

<span data-ttu-id="903ad-236">Последним этапом является развертывание пакета MSIX на другом компьютере.</span><span class="sxs-lookup"><span data-stu-id="903ad-236">The final stage is about how you deploy the MSIX package to another machine.</span></span>

<span data-ttu-id="903ad-237">Щелкните проект упаковки правой кнопкой мыши, выберите меню **Store** и затем параметр **Создание пакетов приложения**.</span><span class="sxs-lookup"><span data-stu-id="903ad-237">Right-click on the packaging project, select the **Store** menu, and then select the **Create App Packages** option.</span></span>

<span data-ttu-id="903ad-238">После этого вы можете выбрать, будете ли вы создавать пакет для отправки в Store или создавать пакеты для загрузки неопубликованных приложений.</span><span class="sxs-lookup"><span data-stu-id="903ad-238">Then, you can choose between creating a package to upload to the store or creating packages for sideloading.</span></span> <span data-ttu-id="903ad-239">В большинстве сценариев модернизации вы выберете **Я хочу создать пакеты для загрузки неопубликованных приложений**.</span><span class="sxs-lookup"><span data-stu-id="903ad-239">In most modernization scenarios, you'll choose **I want to create packages for sideloading**.</span></span>

![Настройка пакетов](./media/deploy-modern-applications/configuring-packages.png)

<span data-ttu-id="903ad-241">В этом случае можно выбрать различные архитектуры, на которые нужно ориентироваться, так как в один пакет MSIX можно включить любое число архитектур.</span><span class="sxs-lookup"><span data-stu-id="903ad-241">There you can select the different architectures you want to target as you can include as many as you want into the same MSIX package.</span></span>

<span data-ttu-id="903ad-242">Последним шагом является объявление того, где вы хотите развернуть окончательные ресурсы установки.</span><span class="sxs-lookup"><span data-stu-id="903ad-242">The final step is to declare where you want to deploy the final installation assets.</span></span>

![Настройка параметров обновления](./media/deploy-modern-applications/configure-update-settings.png)

<span data-ttu-id="903ad-244">Вы можете использовать веб-сервер из общего UNC-пути на файловых серверах предприятия.</span><span class="sxs-lookup"><span data-stu-id="903ad-244">You can choose to use a web server of a shared UNC path on your enterprise file servers.</span></span> <span data-ttu-id="903ad-245">Обратите особое внимание на параметры, позволяющие указать способ обновления приложения.</span><span class="sxs-lookup"><span data-stu-id="903ad-245">Pay attention to the settings to specify how you want to update your application.</span></span> <span data-ttu-id="903ad-246">Обновления мы рассмотрим в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="903ad-246">We'll cover application updates in the next section.</span></span>

<span data-ttu-id="903ad-247">Подробное пошаговое руководство см. в разделе [Упаковка классического приложения из исходного кода с помощью Visual Studio](/windows/msix/desktop/desktop-to-uwp-packaging-dot-net).</span><span class="sxs-lookup"><span data-stu-id="903ad-247">For a detailed step-by-step guide, see [Package a desktop app from source code using Visual Studio](/windows/msix/desktop/desktop-to-uwp-packaging-dot-net).</span></span>

## <a name="auto-updates-in-msix"></a><span data-ttu-id="903ad-248">Автоматические обновления в MSIX</span><span class="sxs-lookup"><span data-stu-id="903ad-248">Auto Updates in MSIX</span></span>

<span data-ttu-id="903ad-249">В Microsoft Store есть отличный механизм обновления, использующий Центр обновления Windows.</span><span class="sxs-lookup"><span data-stu-id="903ad-249">The Windows Store has a great updating mechanism using Windows Update.</span></span> <span data-ttu-id="903ad-250">В большинстве корпоративных сценариев магазин Store для распространения классических приложений не используется.</span><span class="sxs-lookup"><span data-stu-id="903ad-250">In most enterprise scenarios, you don't use the Store to distribute your desktop apps.</span></span> <span data-ttu-id="903ad-251">Поэтому вам нужен аналогичный способ настройки обновлений для приложения и отправки их пользователям.</span><span class="sxs-lookup"><span data-stu-id="903ad-251">So, you need a similar way to configure updates for your application and pull them to your users.</span></span>

<span data-ttu-id="903ad-252">Используя сочетание функций Windows 10 и пакетов MSIX, вы можете предоставить пользователям удобную процедуру обновления.</span><span class="sxs-lookup"><span data-stu-id="903ad-252">Using a combination of Windows 10 features and MSIX packages, you can provide a great updating experience for your users.</span></span> <span data-ttu-id="903ad-253">Фактически пользователь может совершенно не разбираться в технических аспектах, но при этом пользоваться преимуществами беспрепятственного обновления приложения.</span><span class="sxs-lookup"><span data-stu-id="903ad-253">In fact, the user doesn't need to be technical at all but still benefit from a seamless application update experience.</span></span>

<span data-ttu-id="903ad-254">Вы можете настроить обновление для взаимодействия с пользователем двумя разными способами:</span><span class="sxs-lookup"><span data-stu-id="903ad-254">You can configure your updates to interact with the user in two different ways:</span></span>

- <span data-ttu-id="903ad-255">Обновления, запрошенные пользователем: операционная система отображает автоматически сформированный удобный пользовательский интерфейс для уведомления пользователя о том, что приложение готово к установке.</span><span class="sxs-lookup"><span data-stu-id="903ad-255">User prompted updates: The OS shows some autogenerated nice UI to notify the user about the application is about to install.</span></span> <span data-ttu-id="903ad-256">Этот пользовательский интерфейс создается на основе свойств, указанных вами в файлах установки.</span><span class="sxs-lookup"><span data-stu-id="903ad-256">It builds this UI based on the properties you specify on your installation files.</span></span>

- <span data-ttu-id="903ad-257">Автоматические обновления в фоновом режиме:</span><span class="sxs-lookup"><span data-stu-id="903ad-257">Silent updates in the background.</span></span> <span data-ttu-id="903ad-258">в этом случае пользователям не нужно знать об обновлениях.</span><span class="sxs-lookup"><span data-stu-id="903ad-258">With this option, your users don't need to be aware of the updates.</span></span>

<span data-ttu-id="903ad-259">Вы также можете настроить время выполнения обновлений — при запуске приложения или на регулярной основе.</span><span class="sxs-lookup"><span data-stu-id="903ad-259">You can also configure when you want to perform updates, when the application launches or on a regular basis.</span></span> <span data-ttu-id="903ad-260">Благодаря функциям загрузки неопубликованных приложений эти обновления можно получать даже во время работы приложения.</span><span class="sxs-lookup"><span data-stu-id="903ad-260">Thanks to the side-loading features, you can even get these updates while the application is running.</span></span>

<span data-ttu-id="903ad-261">При использовании этого типа развертывания создается специальный файл *APPINSTALLER*.</span><span class="sxs-lookup"><span data-stu-id="903ad-261">When you use this type of deployment, a special file is created called *.appinstaller*.</span></span> <span data-ttu-id="903ad-262">Этот простой файл состоит из следующих разделов:</span><span class="sxs-lookup"><span data-stu-id="903ad-262">This simple file contains the following sections:</span></span>

- <span data-ttu-id="903ad-263">Расположение файла *APPINSTALLER*</span><span class="sxs-lookup"><span data-stu-id="903ad-263">The location of the *.appinstaller* file</span></span>
- <span data-ttu-id="903ad-264">Основные свойства пакета MSIX приложения</span><span class="sxs-lookup"><span data-stu-id="903ad-264">The application's main MSIX package properties</span></span>
- <span data-ttu-id="903ad-265">Поведение при обновлении</span><span class="sxs-lookup"><span data-stu-id="903ad-265">The update behavior</span></span>

![Файл APPINSTALLER](./media/deploy-modern-applications/appinstaller-file.png)

<span data-ttu-id="903ad-267">Совместно с этим файлом корпорация Майкрософт разработала специальный протокол URL-адресов для запуска процесса установки по ссылке:</span><span class="sxs-lookup"><span data-stu-id="903ad-267">In combination with this file, Microsoft has designed a special URL protocol to launch the installation process from a link:</span></span>

```xml
<a href="ms-appinstaller:?source=http://mywebservice.azureedge.net/MyApp.msix">Install app package </a>
```

<span data-ttu-id="903ad-268">Этот протокол работает во всех браузерах и запускает процесс установки в Windows 10 удобным для пользователя образом.</span><span class="sxs-lookup"><span data-stu-id="903ad-268">This protocol works on all browsers and launches the installation process with a great user experience on Windows 10.</span></span> <span data-ttu-id="903ad-269">Так как операционная система управляет процессом установки, она учитывает расположение, из которого было установлено это приложение, и отслеживает все файлы, затронутые этим процессом.</span><span class="sxs-lookup"><span data-stu-id="903ad-269">Since the OS manages the installation process, it's aware of the location this application was installed from and tracks all the files affected by the process.</span></span>

<span data-ttu-id="903ad-270">MSIX создает пользовательский интерфейс для автоматической установки, отображая некоторые свойства пакета.</span><span class="sxs-lookup"><span data-stu-id="903ad-270">MSIX creates a user interface for installation automatically showing some properties of the package.</span></span> <span data-ttu-id="903ad-271">Это обеспечивает единый процесс установки для каждого приложения.</span><span class="sxs-lookup"><span data-stu-id="903ad-271">This allows for a common installation experience for every app.</span></span>

<span data-ttu-id="903ad-272">После создания пакета MSIX и его перемещения на сервер развертывания вам нужно просто изменить файл *APPINSTALLER*, чтобы отразить эти изменения, главным образом версию и путь нового файла MSIX.</span><span class="sxs-lookup"><span data-stu-id="903ad-272">Once you've generated the new MSIX package and moved it to the deployment server, you just have to edit the *.appinstaller* file to reflect these changes, mainly the version and the path to the new MSIX file.</span></span> <span data-ttu-id="903ad-273">Когда пользователь запустит приложение в следующий раз, система обнаружит изменение и скачает файлы для новой версии в фоновом режиме.</span><span class="sxs-lookup"><span data-stu-id="903ad-273">The next time the user launches the application, the system is going to detect the change and download the files for the new version in the background.</span></span> <span data-ttu-id="903ad-274">После этого установка при запуске приложения будет осуществляться незаметно для пользователя.</span><span class="sxs-lookup"><span data-stu-id="903ad-274">When this is done, installation will execute on new application launch transparently for your user.</span></span>

>[!div class="step-by-step"]
>[<span data-ttu-id="903ad-275">Назад</span><span class="sxs-lookup"><span data-stu-id="903ad-275">Previous</span></span>](example-migration.md)
