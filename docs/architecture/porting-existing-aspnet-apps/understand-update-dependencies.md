---
title: Общие сведения о зависимостях и их обновление
description: Чтобы перенести платформа .NET Framework проект в .NET Core, его зависимости необходимо обновить для работы с .NET Core. В этом разделе рассматриваются средства и подходы, которые можно использовать для планирования миграции для больших приложений.
author: ardalis
ms.date: 11/13/2020
ms.openlocfilehash: 484691496d3691151fd3ca83ec776dbb31327c09
ms.sourcegitcommit: b5d2290673e1c91260c9205202dd8b95fbab1a0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/01/2021
ms.locfileid: "106122759"
---
# <a name="understand-and-update-dependencies"></a>Общие сведения о зависимостях и их обновление

После определения последовательности, в которой необходимо перенести отдельные проекты приложения, следует понять зависимости каждого проекта и при необходимости обновить их. Для зависимостей платформы лучше всего запустить [анализатор переносимости .NET](../../standard/analyzers/portability-analyzer.md) для рассматриваемой сборки, а затем просмотреть подробные полученные результаты. Вы настраиваете средство для указания одной или нескольких целевых платформ, таких как .NET Core 3,1 или .NET Standard 2,0. Результаты предоставляются с подробностями для каждой целевой платформы. На рис. 3-4 показан пример выходных данных средства.

![Сведения о отчете анализатора переносимости .NET](./media/Figure3-4.png)

**Рис. 3-4.** Сведения о отчете анализатора переносимости .NET.

## <a name="update-class-library-dependencies"></a>Обновить зависимости библиотеки классов

Крупные приложения обычно используют несколько проектов, и большинство проектов, отличных от веб-проекта ASP.NET MVC, скорее всего, являются библиотеками классов. Библиотеки классов, как правило, представляют собой самый простой способ переноса между платформами .NET, особенно по сравнению с проектами ASP.NET, которые являются наиболее сложными (и обычно требуют повторного создания).

Для переноса библиотек классов в .NET Core команды могут использовать [средство "try-Convert](https://github.com/dotnet/try-convert) " или " [Помощник по обновлению .NET](https://aka.ms/dotnet-upgrade-assistant) ". Эти средства анализируют файл проекта платформа .NET Framework и пытаются перенести его в формат файла проекта .NET Core, делая любые изменения, которые он может безопасно выполнять в процессе. Средствам может потребоваться ручная помощь по работе с проектами ASP.NET, но обычно они помогают ускорить процесс миграции библиотек классов.

Средства "попробовать-преобразовать" и "помощник по обновлению" развертываются в виде средств командной строки .NET Core. Они работают только в Windows, так как они предназначены для работы с платформа .NET Framework приложениями. Можно установить команду try-Convert, выполнив следующую команду из командной строки:

```dotnetcli
dotnet tool install -g try-convert
```

После успешной установки средства можно запустить `try-convert` в папке, в которой находится файл проекта библиотеки классов.

Установите помощник по обновлению .NET с помощью следующей команды (после установки try-Convert):

```dotnetcli
dotnet tool install -g upgrade-assistant
```

Запустите средство с помощью команды `upgrade-assistant <project>` в папке, в которой находится файл проекта.

## <a name="update-nuget-package-dependencies"></a>Обновление зависимостей пакета NuGet

Анализируйте использование сторонних пакетов NuGet и определите, не поддерживают ли они какие-либо из них .NET Standard (или они поддерживаются только с новой версией). Может быть полезно [обновить пакеты NuGet, чтобы использовать `<PackageReference>` синтаксис с помощью средства преобразования Visual Studio](/nuget/consume-packages/migrate-packages-config-to-package-reference), чтобы были видны зависимости верхнего уровня. Затем проверьте, поддерживают ли текущая или более поздние версии этих пакетов .NET Core или .NET Standard. Эти сведения можно найти в [nuget.org] или в Visual Studio для каждого пакета.

Если поддержка существует с использованием версии пакета, используемой в настоящее время приложением, отлично! Если это не так, проверьте, есть ли у более поздней версии пакета поддержка и исследование того, что будет вовлечено в обновление. В пакете могут присутствовать критические изменения, особенно если основной номер версии пакета изменяется между текущей используемой версией и той, до которой выполняется обновление.

В некоторых случаях версия данного пакета не работает с .NET Core. В этом случае команды имеют несколько вариантов. Они могут продолжать работу в зависимости от версии платформа .NET Framework, но это имеет ограничения. Приложение может работать только в Windows, и группа может захотеть запустить анализатор переносимости в двоичных файлах пакета, чтобы узнать, есть ли проблемы, которые могут возникнуть. Безусловно, команда будет тщательно тестироваться, так как при использовании платформа .NET Framework пакетов, которые ссылаются на API, недоступные в .NET Core, возникнет исключение времени выполнения. Другой вариант — найти другой пакет или, если требуемый пакет является открытым исходным кодом, обновите его до .NET Standard или .NET Core.

## <a name="migrate-aspnet-mvc-projects"></a>Миграция проектов ASP.NET MVC

`System.Web`Пространство имен и типы не существуют в .NET Core. При анализе зависимостей и использовании таких средств, как `try-convert` , вы обнаружите, что они не предлагают много предложений по автоматическому переносу проектов ASP.NET MVC и любому коду в них, на который ссылается `System.Web` . Для этих проектов необходимо начать с нового веб-проекта ASP.NET Core и вручную перенести файлы в этот проект.

Как правило, рекомендуется максимально точно ограничить объем бизнес-логики приложения на уровне пользовательского интерфейса. Также лучше использовать небольшие контроллеры и представления. Приложения, которые соблюдают это руководство, проще переносить, чем те, которые имеют значительный объем логики в веб-проекте ASP.NET. Если у вас есть приложение, которое вы планируете перенести, но еще не начали его, помните об этом при его обслуживании. Любые усилия, позволяющие свести к минимуму объем кода в проекте ASP.NET MVC или веб-API, скорее всего, приведут к меньшей работе, когда наступает время на перенос приложения.

В следующей главе углубляется сведения о переходе с проектов ASP.NET MVC и веб-API на ASP.NET Core проектов. В предыдущей главе назывались наиболее существенные различия между приложениями. После того как базовая структура проекта уже размещается, миграция отдельных контроллеров и представлений обычно выполняется просто, особенно если они в основном нацелены на веб-обязанности.

## <a name="references"></a>Ссылки

- [Помощник по обновлению .NET](https://aka.ms/dotnet-upgrade-assistant)
- [средство try-Convert](https://github.com/dotnet/try-convert)
- [средство apiport](https://github.com/microsoft/dotnet-apiport)

>[!div class="step-by-step"]
>[Назад](identify-migration-sequence.md)
>[Вперед](strategies-migrating-in-production.md)
