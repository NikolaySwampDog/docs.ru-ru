---
title: Введение в Справочное приложение Ешопондапр
description: Обзор эталонного приложения Ешопондапр и его журнала.
author: amolenk
ms.date: 02/07/2021
ms.openlocfilehash: d05d47399b9be539597778a4f7856e06d3b16a6c
ms.sourcegitcommit: 42d436ebc2a7ee02fc1848c7742bc7d80e13fc2f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2021
ms.locfileid: "102401864"
---
# <a name="dapr-reference-application"></a><span data-ttu-id="51e83-103">Эталонное приложение ДАПР</span><span class="sxs-lookup"><span data-stu-id="51e83-103">Dapr reference application</span></span>

<span data-ttu-id="51e83-104">Ранее в книге вы узнали о базовых преимуществах ДАПР.</span><span class="sxs-lookup"><span data-stu-id="51e83-104">Earlier in the book, you've learned about the foundational benefits of Dapr.</span></span> <span data-ttu-id="51e83-105">Вы узнали, как ДАПР может помочь вашей команде конструировать распределенные приложения, уменьшая сложность архитектуры и сложности.</span><span class="sxs-lookup"><span data-stu-id="51e83-105">You saw how Dapr can help your team construct distributed applications while reducing architectural and operational complexity.</span></span> <span data-ttu-id="51e83-106">Кстати, у вас есть возможность создавать небольшие ДАПР приложения.</span><span class="sxs-lookup"><span data-stu-id="51e83-106">Along the way, you've had the opportunity to build some small Dapr apps.</span></span> <span data-ttu-id="51e83-107">Теперь пора изучить комплексное приложение микрослужбы, демонстрирующее ДАПР стандартные блоки и компоненты.</span><span class="sxs-lookup"><span data-stu-id="51e83-107">Now, it's time to explore an end-to-end microservice application that demonstrates Dapr building blocks and components.</span></span>

<span data-ttu-id="51e83-108">Но сначала немного журнал.</span><span class="sxs-lookup"><span data-stu-id="51e83-108">But, first a little history.</span></span>

## <a name="eshop-on-containers"></a><span data-ttu-id="51e83-109">Ешоп в контейнерах</span><span class="sxs-lookup"><span data-stu-id="51e83-109">eShop on containers</span></span>

<span data-ttu-id="51e83-110">Несколько лет назад корпорация Майкрософт, в связи с ведущими экспертами сообщества, выпустила популярную книгу рекомендаций с [микрослужбами .NET для упакованных в контейнеры приложений .NET](https://dotnet.microsoft.com/download/e-book/microservices-architecture/pdf).</span><span class="sxs-lookup"><span data-stu-id="51e83-110">Several years ago, Microsoft, in partnership with leading community experts, released a popular guidance book, entitled [.NET Microservices for Containerized .NET Applications](https://dotnet.microsoft.com/download/e-book/microservices-architecture/pdf).</span></span> <span data-ttu-id="51e83-111">На рис. 3-1 показана книга:</span><span class="sxs-lookup"><span data-stu-id="51e83-111">Figure 3-1 shows the book:</span></span>

![Разработка контейнерных приложений .NET для микрослужб.](./media/reference-application/architecting-microservices-book.png)

<span data-ttu-id="51e83-113">**Рис. 3-1**.</span><span class="sxs-lookup"><span data-stu-id="51e83-113">**Figure 3-1**.</span></span> <span data-ttu-id="51e83-114">Микрослужбы .NET: архитектура для контейнерных приложений .NET.</span><span class="sxs-lookup"><span data-stu-id="51e83-114">.NET Microservices: Architecture for Containerized .NET Applications.</span></span>

<span data-ttu-id="51e83-115">В книге довеся принципы, шаблоны и рекомендации по созданию распределенных приложений.</span><span class="sxs-lookup"><span data-stu-id="51e83-115">The book dove deep into the principles, patterns, and best practices for building distributed applications.</span></span> <span data-ttu-id="51e83-116">В него входит полнофункциональное Справочное приложение по микрослужбам, в котором были показаны основные понятия архитектуры.</span><span class="sxs-lookup"><span data-stu-id="51e83-116">It included a full-featured microservice reference application that showcased the architectural concepts.</span></span> <span data-ttu-id="51e83-117">Право, [eShopOnContainers](https://github.com/dotnet-architecture/eShopOnContainers), приложение показывает магазин электронной коммерции, который продает различные элементы .NET, включая одежда и кофе кружки.</span><span class="sxs-lookup"><span data-stu-id="51e83-117">Entitled, [eShopOnContainers](https://github.com/dotnet-architecture/eShopOnContainers), the application shows an e-Commerce storefront that sells various .NET items, including clothing and coffee mugs.</span></span>  <span data-ttu-id="51e83-118">Приложение, встроенное в .NET Core, является межплатформенным и может работать в контейнерах Linux или Windows.</span><span class="sxs-lookup"><span data-stu-id="51e83-118">Built in .NET Core, the application is cross-platform and can run in either Linux or Windows containers.</span></span> <span data-ttu-id="51e83-119">На рис. 3-2 показана исходная архитектура Ешоп.</span><span class="sxs-lookup"><span data-stu-id="51e83-119">Figure 3-2 shows the original eShop architecture.</span></span>

![Эталонная архитектура приложения eShopOnContainers.](./media/reference-application/eshop-on-containers.png)

<span data-ttu-id="51e83-121">**Рис. 3-2**.</span><span class="sxs-lookup"><span data-stu-id="51e83-121">**Figure 3-2**.</span></span> <span data-ttu-id="51e83-122">Исходное `ShopOnContainers` эталонное приложение.</span><span class="sxs-lookup"><span data-stu-id="51e83-122">Original `ShopOnContainers` reference application.</span></span>

<span data-ttu-id="51e83-123">Как видите, eShopOnContainers включает множество движущихся частей:</span><span class="sxs-lookup"><span data-stu-id="51e83-123">As you can see, eShopOnContainers includes many moving parts:</span></span>

1. <span data-ttu-id="51e83-124">Три разных клиентского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="51e83-124">Three different front-end clients.</span></span>
1. <span data-ttu-id="51e83-125">Шлюз приложений для абстракции серверной части с внешнего интерфейса.</span><span class="sxs-lookup"><span data-stu-id="51e83-125">An application gateway to abstract the back end from the front end.</span></span>
1. <span data-ttu-id="51e83-126">Несколько внутренних основных микрослужб.</span><span class="sxs-lookup"><span data-stu-id="51e83-126">Several back-end core microservices.</span></span>
1. <span data-ttu-id="51e83-127">Компонент шины событий, обеспечивающий асинхронный общий обмен сообщениями.</span><span class="sxs-lookup"><span data-stu-id="51e83-127">An event bus component that enables asynchronous pub/sub messaging.</span></span>

<span data-ttu-id="51e83-128">Эталонное приложение eShopOnContainers широко принято в рамках сообщества .NET и используется для моделирования многих крупных коммерческих приложений микрослужб.</span><span class="sxs-lookup"><span data-stu-id="51e83-128">The eShopOnContainers reference application has been widely accepted across the .NET community and used to model many large commercial microservice applications.</span></span>

## <a name="eshop-on-dapr"></a><span data-ttu-id="51e83-129">Ешоп в ДАПР</span><span class="sxs-lookup"><span data-stu-id="51e83-129">eShop on Dapr</span></span>

<span data-ttu-id="51e83-130">Эта книга поставляется с альтернативной версией приложения Ешоп.</span><span class="sxs-lookup"><span data-stu-id="51e83-130">An alternative version of the eShop application accompanies this book.</span></span> <span data-ttu-id="51e83-131">Он называется [ешопондапр](https://github.com/dotnet-architecture/eShopOnDapr).</span><span class="sxs-lookup"><span data-stu-id="51e83-131">It's called [eShopOnDapr](https://github.com/dotnet-architecture/eShopOnDapr).</span></span> <span data-ttu-id="51e83-132">Обновленная версия развивается ранее eShopOnContainers приложение, интегрируя стандартные блоки и компоненты ДАПР.</span><span class="sxs-lookup"><span data-stu-id="51e83-132">The updated version evolves the earlier eShopOnContainers application by integrating Dapr building blocks and components.</span></span> <span data-ttu-id="51e83-133">На рис. 3-3 показана новая архитектура упрощенного решения:</span><span class="sxs-lookup"><span data-stu-id="51e83-133">Figure 3-3 shows the new streamlined solution architecture:</span></span>  

![Эталонная архитектура приложения Ешопондапр.](./media/reference-application/eshop-on-dapr.png)

<span data-ttu-id="51e83-135">**Рис. 3-3**.</span><span class="sxs-lookup"><span data-stu-id="51e83-135">**Figure 3-3**.</span></span> <span data-ttu-id="51e83-136">Эталонная архитектура приложения Ешопондапр.</span><span class="sxs-lookup"><span data-stu-id="51e83-136">eShopOnDapr reference application architecture.</span></span>

<span data-ttu-id="51e83-137">По мере того как фокус в эталонном приложении Ешопондапр находится на ДАПР, исходное приложение было обновлено.</span><span class="sxs-lookup"><span data-stu-id="51e83-137">As focus of the eShopOnDapr reference application is on Dapr, the original application has been updated.</span></span> <span data-ttu-id="51e83-138">Архитектура состоит из следующих компонентов:</span><span class="sxs-lookup"><span data-stu-id="51e83-138">The architecture consists of:</span></span>

1. <span data-ttu-id="51e83-139">Интерфейс [одностраничного приложения](/archive/msdn-magazine/2013/november/asp-net-single-page-applications-build-modern-responsive-web-apps-with-asp-net) , написанный на популярной платформе в угловом Spa.</span><span class="sxs-lookup"><span data-stu-id="51e83-139">A [Single Page Application](/archive/msdn-magazine/2013/november/asp-net-single-page-applications-build-modern-responsive-web-apps-with-asp-net) front end written in the popular Angular SPA framework.</span></span> <span data-ttu-id="51e83-140">Он отправляет запросы пользователей в микрослужбу шлюза API.</span><span class="sxs-lookup"><span data-stu-id="51e83-140">It sends user requests to an API gateway microservice.</span></span>

1. <span data-ttu-id="51e83-141">Шлюз API абстрагирует основные микрослужбы ядра серверной части от клиентского клиента.</span><span class="sxs-lookup"><span data-stu-id="51e83-141">The API gateway abstracts the back-end core microservices from the front-end client.</span></span> <span data-ttu-id="51e83-142">Он реализуется с помощью [делегата](https://www.envoyproxy.io/), высокопроизводительного прокси-сервера службы с открытым исходным кодом.</span><span class="sxs-lookup"><span data-stu-id="51e83-142">It's implemented using [Envoy](https://www.envoyproxy.io/), a high performant, open-source service proxy.</span></span> <span data-ttu-id="51e83-143">Представитель направляет входящие запросы к различным микрослужбам серверной части.</span><span class="sxs-lookup"><span data-stu-id="51e83-143">Envoy routes  incoming requests to various back-end microservices.</span></span> <span data-ttu-id="51e83-144">Большинство запросов являются простыми операциями CRUD (например, получить список торговых марок из каталога) и обрабатываться прямым вызовом серверной микрослужбы.</span><span class="sxs-lookup"><span data-stu-id="51e83-144">Most requests are simple CRUD operations (for example, get the list of brands from the catalog) and handled by a direct call to a back-end microservice.</span></span>

1. <span data-ttu-id="51e83-145">Другие запросы логически сложны и для совместной работы требуется несколько микрослужб.</span><span class="sxs-lookup"><span data-stu-id="51e83-145">Other requests are logically more complex and require multiple microservices to work together.</span></span> <span data-ttu-id="51e83-146">В таких случаях Ешопондапр реализует [микрослужбу агрегатора](../cloud-native/service-to-service-communication.md#service-aggregator-pattern) , которая координирует рабочий процесс по микрослужбам, необходимым для выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="51e83-146">For these cases, eShopOnDapr implements an [aggregator microservice](../cloud-native/service-to-service-communication.md#service-aggregator-pattern) that orchestrates a workflow across the microservices needed to complete the operation.</span></span>

1. <span data-ttu-id="51e83-147">Набор основных серверных микрослужб включает функции, необходимые для магазина электронной коммерции.</span><span class="sxs-lookup"><span data-stu-id="51e83-147">The set of core back-end microservices includes functionality required for an e-Commerce store.</span></span> <span data-ttu-id="51e83-148">Каждый из них самодостаточен и не зависит от других.</span><span class="sxs-lookup"><span data-stu-id="51e83-148">Each is self-contained and independent of the others.</span></span> <span data-ttu-id="51e83-149">В следующих широко принятых шаблонах разбиения доменов каждая микрослужба изолирует определенную *бизнес-возможность*:</span><span class="sxs-lookup"><span data-stu-id="51e83-149">Following widely accepted domain decomposing patterns, each microservice isolates a specific *business capability*:</span></span>

   - <span data-ttu-id="51e83-150">Служба корзины управляет возможностями покупательской корзины.</span><span class="sxs-lookup"><span data-stu-id="51e83-150">The basket service manages the customer's shopping basket experience.</span></span>
   - <span data-ttu-id="51e83-151">Служба каталога управляет элементами продуктов, доступными для продажи.</span><span class="sxs-lookup"><span data-stu-id="51e83-151">The catalog service manages product items available for sale.</span></span>
   - <span data-ttu-id="51e83-152">Служба удостоверений управляет проверкой подлинности и удостоверением.</span><span class="sxs-lookup"><span data-stu-id="51e83-152">The identity service manages authentication and identity.</span></span>
   - <span data-ttu-id="51e83-153">Служба упорядочения обрабатывает все аспекты размещения заказов и управления ими.</span><span class="sxs-lookup"><span data-stu-id="51e83-153">The ordering service handles all aspects of placing and managing orders.</span></span>
   - <span data-ttu-id="51e83-154">Служба платежей взаимодействует с оплатой клиента.</span><span class="sxs-lookup"><span data-stu-id="51e83-154">The payment service transacts the customer's payment.</span></span>

   <span data-ttu-id="51e83-155">Каждая служба имеет собственное постоянное хранилище.</span><span class="sxs-lookup"><span data-stu-id="51e83-155">Each service has its own persistent storage.</span></span> <span data-ttu-id="51e83-156">При соблюдении [рекомендаций](../cloud-native/distributed-data.md#database-per-microservice-why)по микрослужбам не существует общего хранилища данных, с которым взаимодействуют все службы.</span><span class="sxs-lookup"><span data-stu-id="51e83-156">Adhering to microservice [best practices](../cloud-native/distributed-data.md#database-per-microservice-why), there's not a shared datastore with which all services interact.</span></span>

   <span data-ttu-id="51e83-157">Проектирование каждой микрослужбы основано на индивидуальных требованиях.</span><span class="sxs-lookup"><span data-stu-id="51e83-157">The design of each microservice is based on its individual requirements.</span></span> <span data-ttu-id="51e83-158">Простые службы используют базовые операции CRUD для доступа к базовым хранилищам данных.</span><span class="sxs-lookup"><span data-stu-id="51e83-158">The simple services use basic CRUD operations to access to their underlying data stores.</span></span> <span data-ttu-id="51e83-159">Дополнительные службы, например упорядочение, используют подход Domain-Driven проектирования для управления сложными бизнес-процессами.</span><span class="sxs-lookup"><span data-stu-id="51e83-159">Advanced services, like Ordering, use a  Domain-Driven Design approach to manage business complexity.</span></span> <span data-ttu-id="51e83-160">При необходимости службы могут быть построены в различных технологических стеках, таких как .NET Core, Java, Go, NodeJS и т. д.</span><span class="sxs-lookup"><span data-stu-id="51e83-160">If necessary, services could be built across different technology stacks, such as .NET Core, Java, Go, NodeJS, and more.</span></span>

1. <span data-ttu-id="51e83-161">Наконец, шина событий создает оболочку для компонентов публикации и подписки ДАПР.</span><span class="sxs-lookup"><span data-stu-id="51e83-161">Finally, the event bus wraps the Dapr publish/subscribe components.</span></span> <span data-ttu-id="51e83-162">Она позволяет асинхронно публиковать и подписывать сообщения в микрослужбах.</span><span class="sxs-lookup"><span data-stu-id="51e83-162">It enables asynchronous publish/subscribe messaging across microservices.</span></span> <span data-ttu-id="51e83-163">Разработчики могут подключать любой брокер сообщений, поддерживаемый ДАПР.</span><span class="sxs-lookup"><span data-stu-id="51e83-163">Developers can plug in any Dapr-supported message broker.</span></span>

### <a name="application-of-dapr-building-blocks"></a><span data-ttu-id="51e83-164">Применение стандартных блоков ДАПР</span><span class="sxs-lookup"><span data-stu-id="51e83-164">Application of Dapr building blocks</span></span>

<span data-ttu-id="51e83-165">База кода Ешопондапр более рациональна, чем база кода eShopOnContainers.</span><span class="sxs-lookup"><span data-stu-id="51e83-165">The eShopOnDapr codebase is more streamlined than the eShopOnContainers codebase.</span></span> <span data-ttu-id="51e83-166">ДАПР стандартные блоки заменяют большой объем коммуникационного кода, подверженного ошибкам.</span><span class="sxs-lookup"><span data-stu-id="51e83-166">Dapr building blocks replace a large amount of error-prone plumbing code.</span></span>

<span data-ttu-id="51e83-167">На рис. 3-4 показана интеграция ДАПР в справочном приложении Ешоп.</span><span class="sxs-lookup"><span data-stu-id="51e83-167">Figure 3-4 shows the Dapr integration in the eShop reference application.</span></span>

![Архитектура эталонного приложения Ешопондапр](./media/reference-application/eshop-on-dapr-buildingblocks.png)

<span data-ttu-id="51e83-169">**Рис. 3-4**.</span><span class="sxs-lookup"><span data-stu-id="51e83-169">**Figure 3-4**.</span></span> <span data-ttu-id="51e83-170">Интеграция ДАПР в Ешопондапр.</span><span class="sxs-lookup"><span data-stu-id="51e83-170">Dapr integration in eShopOnDapr.</span></span>

<span data-ttu-id="51e83-171">На предыдущем рисунке видно, какие службы используют ДАПР стандартные блоки.</span><span class="sxs-lookup"><span data-stu-id="51e83-171">In the previous figure, you can see which services use which Dapr building blocks.</span></span>

1. <span data-ttu-id="51e83-172">Исходное приложение eShopOnContainers демонстрирует понятия и шаблоны DDD в службе упорядочения.</span><span class="sxs-lookup"><span data-stu-id="51e83-172">The original eShopOnContainers application demonstrates DDD concepts and patterns in the ordering service.</span></span> <span data-ttu-id="51e83-173">В обновленном Ешопондапр служба упорядочения использует *стандартный блок субъекта* в качестве альтернативной реализации.</span><span class="sxs-lookup"><span data-stu-id="51e83-173">In the updated eShopOnDapr, the ordering service uses the *actor building block* as an alternative implementation.</span></span> <span data-ttu-id="51e83-174">Модель доступа на основе поворачивания субъектов позволяет легко реализовать процесс упорядочения с отслеживанием состояния с поддержкой отмены.</span><span class="sxs-lookup"><span data-stu-id="51e83-174">The turn-based access model of actors makes it easy to implement a stateful ordering process with support for cancellation.</span></span>
1. <span data-ttu-id="51e83-175">Служба упорядочения отправляет сообщения электронной почты с подтверждением заказа с помощью [стандартного блока привязки](bindings.md).</span><span class="sxs-lookup"><span data-stu-id="51e83-175">The ordering service sends order confirmation e-mails using the [bindings building block](bindings.md).</span></span>
1. <span data-ttu-id="51e83-176">Серверные службы обмениваются данными асинхронно с помощью [стандартного блока publish & Subscribe](publish-subscribe.md).</span><span class="sxs-lookup"><span data-stu-id="51e83-176">The back-end services communicate asynchronously using the [publish & subscribe building block](publish-subscribe.md).</span></span>
1. <span data-ttu-id="51e83-177">Управление секретами выполняется в [стандартном блоке секретов](secrets.md).</span><span class="sxs-lookup"><span data-stu-id="51e83-177">Secret management is done by the [secrets building block](secrets.md).</span></span>
1. <span data-ttu-id="51e83-178">Службы "шлюз API" и "Статистическая обработка веб-покупок" используют [стандартный блок вызова службы](service-invocation.md) для вызова методов серверных служб.</span><span class="sxs-lookup"><span data-stu-id="51e83-178">The API gateway and web shopping aggregator services use the [service invocation building block](service-invocation.md) to invoke methods on the back-end services.</span></span>
1. <span data-ttu-id="51e83-179">Служба корзины использует [стандартный блок управления состоянием](state-management.md) для хранения состояния корзины покупателя.</span><span class="sxs-lookup"><span data-stu-id="51e83-179">The basket service uses the [state management building block](state-management.md) to store the state of the customer's shopping basket.</span></span>

### <a name="benefits-of-applying-dapr-to-eshop"></a><span data-ttu-id="51e83-180">Преимущества применения ДАПР к Ешоп</span><span class="sxs-lookup"><span data-stu-id="51e83-180">Benefits of applying Dapr to eShop</span></span>

<span data-ttu-id="51e83-181">Как правило, использование стандартных блоков ДАПР добавляет наблюдаемую и гибкую гибкость в приложение:</span><span class="sxs-lookup"><span data-stu-id="51e83-181">In general, the use of Dapr building blocks add observability and flexibility to the application:</span></span>

1. <span data-ttu-id="51e83-182">Наблюдаемость. используя стандартные блоки ДАПР, вы получаете широкие возможности распределенной трассировки для обоих вызовов между службами и для ДАПР компонентов без необходимости написания кода.</span><span class="sxs-lookup"><span data-stu-id="51e83-182">Observability: By using the Dapr building blocks, you gain rich distributed tracing for both calls between services and to Dapr components without having to write any code.</span></span> <span data-ttu-id="51e83-183">В eShopOnContainers для получения ценных сведений используется большое количество пользовательских журналов.</span><span class="sxs-lookup"><span data-stu-id="51e83-183">In eShopOnContainers, a large amount of custom logging is used to provide insight.</span></span>
1. <span data-ttu-id="51e83-184">Гибкость *. Теперь можно* отменять инфраструктуру, просто изменяя файл конфигурации компонента.</span><span class="sxs-lookup"><span data-stu-id="51e83-184">Flexibility: You can now *swap out* infrastructure simply by changing a component configuration file.</span></span> <span data-ttu-id="51e83-185">Изменения кода не требуются.</span><span class="sxs-lookup"><span data-stu-id="51e83-185">No code changes are necessary.</span></span>

<span data-ttu-id="51e83-186">Ниже приведены некоторые дополнительные примеры преимуществ, предоставляемых конкретными стандартными блоками.</span><span class="sxs-lookup"><span data-stu-id="51e83-186">Here are some more examples of benefits offered by specific building blocks:</span></span>

- <span data-ttu-id="51e83-187">**Вызов службы**</span><span class="sxs-lookup"><span data-stu-id="51e83-187">**Service Invocation**</span></span>
  - <span data-ttu-id="51e83-188">Благодаря поддержке ДАПР для [mTLS](https://blog.cloudflare.com/introducing-tls-client-auth/)службы теперь обмениваются данными через зашифрованные каналы.</span><span class="sxs-lookup"><span data-stu-id="51e83-188">With Dapr's support for [mTLS](https://blog.cloudflare.com/introducing-tls-client-auth/), services now communicate through encrypted channels.</span></span>
  - <span data-ttu-id="51e83-189">При возникновении временных ошибок вызовы служб автоматически повторяются.</span><span class="sxs-lookup"><span data-stu-id="51e83-189">When transient errors occur, service calls are automatically retried.</span></span>
  - <span data-ttu-id="51e83-190">Автоматическое обнаружение служб сокращает объем конфигурации, необходимой для того, чтобы службы нашли друг друга.</span><span class="sxs-lookup"><span data-stu-id="51e83-190">Automatic service discovery reduces the amount of configuration needed for services to find each other.</span></span>

- <span data-ttu-id="51e83-191">**Публикация и подписка**</span><span class="sxs-lookup"><span data-stu-id="51e83-191">**Publish/Subscribe**</span></span>
  - <span data-ttu-id="51e83-192">Ешопонконтаинер включал в себя большой объем пользовательского кода для поддержки служебной шины Azure и RabbitMQ.</span><span class="sxs-lookup"><span data-stu-id="51e83-192">eShopOnContainer included a large amount of custom code to support both Azure Service Bus and RabbitMQ.</span></span> <span data-ttu-id="51e83-193">Разработчики использовали служебную шину Azure для рабочей среды и RabbitMQ для локальной разработки и тестирования.</span><span class="sxs-lookup"><span data-stu-id="51e83-193">Developers used Azure Service Bus for production and RabbitMQ for local development and testing.</span></span> <span data-ttu-id="51e83-194">`IEventBus`Для включения переключения между этими брокерами сообщений был создан слой абстракции.</span><span class="sxs-lookup"><span data-stu-id="51e83-194">An `IEventBus` abstraction layer was created to enable swapping between these message brokers.</span></span> <span data-ttu-id="51e83-195">Этот слой состоит из приблизительно *700 строк кода, подверженного ошибкам*.</span><span class="sxs-lookup"><span data-stu-id="51e83-195">This layer consisted of approximately *700 lines of error-prone code*.</span></span> <span data-ttu-id="51e83-196">Для обновленной реализации с ДАПР требуется всего *35 строк кода*.</span><span class="sxs-lookup"><span data-stu-id="51e83-196">The updated implementation with Dapr requires only *35 lines of code*.</span></span> <span data-ttu-id="51e83-197">Это **5%** исходных строк кода!</span><span class="sxs-lookup"><span data-stu-id="51e83-197">That's **5%** of the original lines of code!</span></span> <span data-ttu-id="51e83-198">Что более важно, реализация проста и проста в понимании.</span><span class="sxs-lookup"><span data-stu-id="51e83-198">More importantly, the implementation is straightforward and easy to understand.</span></span>
  - <span data-ttu-id="51e83-199">Ешопондапр использует богатую ASP.NET Coreную интеграцию ДАПР для использования Pub/reby.</span><span class="sxs-lookup"><span data-stu-id="51e83-199">eShopOnDapr uses Dapr's rich ASP.NET Core integration to use pub/sub.</span></span> <span data-ttu-id="51e83-200">Добавьте `Topic` атрибуты в методы контроллера ASP.NET Core, чтобы подписываться на сообщения.</span><span class="sxs-lookup"><span data-stu-id="51e83-200">You add `Topic` attributes to ASP.NET Core controller methods to subscribe to messages.</span></span> <span data-ttu-id="51e83-201">Поэтому нет необходимости писать отдельный цикл обработчика сообщений для каждого брокера сообщений.</span><span class="sxs-lookup"><span data-stu-id="51e83-201">Therefore, there's no need to write a separate message handler loop for each message broker.</span></span>
  - <span data-ttu-id="51e83-202">Сообщения, направляемые в службу как вызовы HTTP, позволяют использовать по промежуточного слоя ASP.NET Core для добавления функциональных возможностей без введения новых концепций или пакетов SDK для изучения.</span><span class="sxs-lookup"><span data-stu-id="51e83-202">Messages routed to the service as HTTP calls enable the use of ASP.NET Core middleware to add functionality, without introducing new concepts or SDKs to learn.</span></span>

- <span data-ttu-id="51e83-203">**Привязки**</span><span class="sxs-lookup"><span data-stu-id="51e83-203">**Bindings**</span></span>
  - <span data-ttu-id="51e83-204">Решение eShopOnContainers содержало *готовый* элемент для отправки подтверждения заказа клиенту по электронной почте.</span><span class="sxs-lookup"><span data-stu-id="51e83-204">The eShopOnContainers solution contained a *to-do* item for e-mailing an order confirmation to the customer.</span></span> <span data-ttu-id="51e83-205">Казалось бы, что в конечном итоге реализовать сторонние API электронной почты, например SendGrid.</span><span class="sxs-lookup"><span data-stu-id="51e83-205">The thought was to eventually implement a third-party email API such as SendGrid.</span></span> <span data-ttu-id="51e83-206">В ДАПР реализация уведомления по электронной почте была так же простой, как и Настройка привязки ресурса.</span><span class="sxs-lookup"><span data-stu-id="51e83-206">With Dapr, implementing email notification was as easy as configuring a resource binding.</span></span> <span data-ttu-id="51e83-207">Не нужно изучать внешние API или пакеты SDK.</span><span class="sxs-lookup"><span data-stu-id="51e83-207">There wasn't any need to learn external APIs or SDKs.</span></span>

> [!NOTE]
> <span data-ttu-id="51e83-208">Стандартный блок субъектов не рассматривается в первой версии этой книги.</span><span class="sxs-lookup"><span data-stu-id="51e83-208">The Actors building block isn't covered in the first version of this book.</span></span> <span data-ttu-id="51e83-209">В обновление 1,1 будет включена обширная глава по стандартному блоку субъекта и его интеграции с Ешопондапр.</span><span class="sxs-lookup"><span data-stu-id="51e83-209">An extensive chapter on the Actor building block and its integration with eShopOnDapr will be included in the 1.1 update.</span></span>

## <a name="summary"></a><span data-ttu-id="51e83-210">Итоги</span><span class="sxs-lookup"><span data-stu-id="51e83-210">Summary</span></span>

<span data-ttu-id="51e83-211">В этой главе вы предоставили Справочное приложение Ешопондапр.</span><span class="sxs-lookup"><span data-stu-id="51e83-211">In this chapter, you're introduced to the eShopOnDapr reference application.</span></span> <span data-ttu-id="51e83-212">Это эволюция широко популярных справочных приложений на микрослужбах eShopOnContainers.</span><span class="sxs-lookup"><span data-stu-id="51e83-212">It's an evolution of the widely popular eShopOnContainers microservice reference application.</span></span> <span data-ttu-id="51e83-213">Ешопондапр заменяет большой объем пользовательских функций с помощью стандартных блоков и компонентов ДАПР, значительно упрощая сложность, необходимые для создания приложения микрослужб.</span><span class="sxs-lookup"><span data-stu-id="51e83-213">eShopOnDapr replaces a large amount of custom functionality with Dapr building blocks and components, dramatically simplifying the complexities required to build a microservices application.</span></span>

### <a name="references"></a><span data-ttu-id="51e83-214">Ссылки</span><span class="sxs-lookup"><span data-stu-id="51e83-214">References</span></span>

- [<span data-ttu-id="51e83-215">ешопондапр</span><span class="sxs-lookup"><span data-stu-id="51e83-215">eShopOnDapr</span></span>](https://github.com/dotnet-architecture/eShopOnDapr)

- [<span data-ttu-id="51e83-216">eShopOnContainers</span><span class="sxs-lookup"><span data-stu-id="51e83-216">eShopOnContainers</span></span>](https://github.com/dotnet-architecture/eShopOnContainers)

- [<span data-ttu-id="51e83-217">Микрослужбы .NET для упакованных в контейнеры приложений .NET</span><span class="sxs-lookup"><span data-stu-id="51e83-217">.NET Microservices for Containerized .NET Applications</span></span>](https://dotnet.microsoft.com/download/e-book/microservices-architecture/pdf)

- [<span data-ttu-id="51e83-218">Разработка архитектуры приложений Cloud-Native .NET для Azure</span><span class="sxs-lookup"><span data-stu-id="51e83-218">Architecting Cloud-Native .NET Apps for Azure</span></span>](https://dotnet.microsoft.com/download/e-book/cloud-native-azure/pdf)

> [!div class="step-by-step"]
> <span data-ttu-id="51e83-219">[Назад](getting-started.md)
> [Вперед](state-management.md)</span><span class="sxs-lookup"><span data-stu-id="51e83-219">[Previous](getting-started.md)
[Next](state-management.md)</span></span>
