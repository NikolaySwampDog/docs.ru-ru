---
title: Конфигурация в .NET
description: Узнайте, как использовать API конфигурации для настройки приложений .NET.
author: IEvangelist
ms.author: dapine
ms.date: 09/16/2020
ms.topic: overview
ms.openlocfilehash: 5955e46c2f5acb6776ada4e3fd6a65507d3faa1f
ms.sourcegitcommit: ecd9e9bb2225eb76f819722ea8b24988fe46f34c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/05/2020
ms.locfileid: "102402110"
---
# <a name="configuration-in-net"></a><span data-ttu-id="bca0e-103">Конфигурация в .NET</span><span class="sxs-lookup"><span data-stu-id="bca0e-103">Configuration in .NET</span></span>

<span data-ttu-id="bca0e-104">Настройка в .NET выполняется с помощью одного или нескольких [поставщиков конфигурации](#configuration-providers).</span><span class="sxs-lookup"><span data-stu-id="bca0e-104">Configuration in .NET is performed using one or more [configuration providers](#configuration-providers).</span></span> <span data-ttu-id="bca0e-105">Поставщики конфигурации получают данные конфигурации в парах "ключ-значение" из различных источников:</span><span class="sxs-lookup"><span data-stu-id="bca0e-105">Configuration providers read configuration data from key-value pairs using a variety of configuration sources:</span></span>

- <span data-ttu-id="bca0e-106">файлы параметров, например *appsettings.json*;</span><span class="sxs-lookup"><span data-stu-id="bca0e-106">Settings files, such as *appsettings.json*</span></span>
- <span data-ttu-id="bca0e-107">Переменные среды</span><span class="sxs-lookup"><span data-stu-id="bca0e-107">Environment variables</span></span>
- <span data-ttu-id="bca0e-108">[Azure Key Vault](/azure/key-vault/general/overview);</span><span class="sxs-lookup"><span data-stu-id="bca0e-108">[Azure Key Vault](/azure/key-vault/general/overview)</span></span>
- [<span data-ttu-id="bca0e-109">Конфигурация приложений Azure</span><span class="sxs-lookup"><span data-stu-id="bca0e-109">Azure App Configuration</span></span>](/azure/azure-app-configuration/overview)
- <span data-ttu-id="bca0e-110">аргументов командной строки;</span><span class="sxs-lookup"><span data-stu-id="bca0e-110">Command-line arguments</span></span>
- <span data-ttu-id="bca0e-111">пользовательские поставщики, установленные или созданные;</span><span class="sxs-lookup"><span data-stu-id="bca0e-111">Custom providers, installed or created</span></span>
- <span data-ttu-id="bca0e-112">справочных файлов;</span><span class="sxs-lookup"><span data-stu-id="bca0e-112">Directory files</span></span>
- <span data-ttu-id="bca0e-113">объектов .NET в памяти;</span><span class="sxs-lookup"><span data-stu-id="bca0e-113">In-memory .NET objects</span></span>

## <a name="configure-console-apps"></a><span data-ttu-id="bca0e-114">Конфигурация консольных приложений</span><span class="sxs-lookup"><span data-stu-id="bca0e-114">Configure console apps</span></span>

<span data-ttu-id="bca0e-115">Новые консольные приложения .NET, созданные с помощью команды [dotnet new](../tools/dotnet-new.md) или в Visual Studio по умолчанию, *не* предоставляют возможности конфигурации.</span><span class="sxs-lookup"><span data-stu-id="bca0e-115">New .NET console applications created using [dotnet new](../tools/dotnet-new.md) or Visual Studio by default *do not* expose configuration capabilities.</span></span> <span data-ttu-id="bca0e-116">Чтобы добавить конфигурацию в новое консольное приложение .NET, [добавьте ссылку на пакет](../tools/dotnet-add-package.md) в `Microsoft.Extensions.Hosting`.</span><span class="sxs-lookup"><span data-stu-id="bca0e-116">To add configuration in a new .NET console application, [add a package reference](../tools/dotnet-add-package.md) to `Microsoft.Extensions.Hosting`.</span></span> <span data-ttu-id="bca0e-117">Измените файл *Program.cs* в соответствии с приведенным ниже кодом:</span><span class="sxs-lookup"><span data-stu-id="bca0e-117">Modify the *Program.cs* file to match the following code:</span></span>

:::code language="csharp" source="snippets/configuration/console/Program.cs" highlight="18":::

<span data-ttu-id="bca0e-118">Метод <xref:Microsoft.Extensions.Hosting.Host.CreateDefaultBuilder(System.String[])?displayProperty=nameWithType> предоставляет конфигурацию по умолчанию для приложения в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="bca0e-118">The <xref:Microsoft.Extensions.Hosting.Host.CreateDefaultBuilder(System.String[])?displayProperty=nameWithType> method provides default configuration for the app in the following order:</span></span>

1. <span data-ttu-id="bca0e-119">[ChainedConfigurationProvider](xref:Microsoft.Extensions.Configuration.ChainedConfigurationSource): добавляет существующий `IConfiguration` в качестве источника.</span><span class="sxs-lookup"><span data-stu-id="bca0e-119">[ChainedConfigurationProvider](xref:Microsoft.Extensions.Configuration.ChainedConfigurationSource) : Adds an existing `IConfiguration` as a source.</span></span>
1. <span data-ttu-id="bca0e-120">Файл *appsettings.json*, использующий [поставщик конфигурации JSON](configuration-providers.md#file-configuration-provider).</span><span class="sxs-lookup"><span data-stu-id="bca0e-120">*appsettings.json* using the [JSON configuration provider](configuration-providers.md#file-configuration-provider).</span></span>
1. <span data-ttu-id="bca0e-121">Файл *appsettings.* `Environment` *.json*, использующий [поставщик конфигурации JSON](configuration-providers.md#file-configuration-provider).</span><span class="sxs-lookup"><span data-stu-id="bca0e-121">*appsettings.*`Environment`*.json* using the [JSON configuration provider](configuration-providers.md#file-configuration-provider).</span></span> <span data-ttu-id="bca0e-122">Например, *appsettings*.***Production\*\*_._json* и *appsettings*.\*\*\*Development** _._json\*.</span><span class="sxs-lookup"><span data-stu-id="bca0e-122">For example, *appsettings*.***Production\*\*_._json* and *appsettings*.\*\*\*Development** _._json\*.</span></span>
1. <span data-ttu-id="bca0e-123">Секреты приложения, когда приложение выполняется в среде `Development`.</span><span class="sxs-lookup"><span data-stu-id="bca0e-123">App secrets when the app runs in the `Development` environment.</span></span>
1. <span data-ttu-id="bca0e-124">Переменные среды, использующие [поставщик конфигурации переменных среды](configuration-providers.md#environment-variable-configuration-provider).</span><span class="sxs-lookup"><span data-stu-id="bca0e-124">Environment variables using the [Environment Variables configuration provider](configuration-providers.md#environment-variable-configuration-provider).</span></span>
1. <span data-ttu-id="bca0e-125">Аргументы командной строки, использующие [поставщик конфигурации командной строки](configuration-providers.md#command-line-configuration-provider).</span><span class="sxs-lookup"><span data-stu-id="bca0e-125">Command-line arguments using the [Command-line configuration provider](configuration-providers.md#command-line-configuration-provider).</span></span>

<span data-ttu-id="bca0e-126">Поставщики конфигурации, добавленные позже, переопределяют предыдущие параметры ключа.</span><span class="sxs-lookup"><span data-stu-id="bca0e-126">Configuration providers that are added later override previous key settings.</span></span> <span data-ttu-id="bca0e-127">Например, если `SomeKey` задан в *appsettings.json* и в среде, используется значение среды.</span><span class="sxs-lookup"><span data-stu-id="bca0e-127">For example, if `SomeKey` is set in both *appsettings.json* and the environment, the environment value is used.</span></span> <span data-ttu-id="bca0e-128">При использовании поставщиков конфигурации по умолчанию [поставщик конфигурации командной строки](configuration-providers.md#command-line-configuration-provider) переопределяет остальных поставщиков.</span><span class="sxs-lookup"><span data-stu-id="bca0e-128">Using the default configuration providers, the [Command-line configuration provider](configuration-providers.md#command-line-configuration-provider) overrides all other providers.</span></span>

### <a name="binding"></a><span data-ttu-id="bca0e-129">Привязка</span><span class="sxs-lookup"><span data-stu-id="bca0e-129">Binding</span></span>

<span data-ttu-id="bca0e-130">Одним из ключевых преимуществ конфигурации в .NET является возможность привязки значений конфигурации к экземплярам объектов .NET.</span><span class="sxs-lookup"><span data-stu-id="bca0e-130">One of the key advantages to configuration in .NET is the ability to bind configuration values to instances of .NET objects.</span></span> <span data-ttu-id="bca0e-131">Например, поставщика конфигурации JSON можно использовать для сопоставления файлов *appsettings.json* с объектами .NET и использовать с помощью внедрения зависимостей.</span><span class="sxs-lookup"><span data-stu-id="bca0e-131">For example, the JSON configuration provider can be used to map *appsettings.json* files to .NET objects and is used with dependency injection.</span></span> <span data-ttu-id="bca0e-132">Это позволяет применять шаблоны параметров, которые используют классы для обеспечения строго типизированного доступа к группам связанных параметров.</span><span class="sxs-lookup"><span data-stu-id="bca0e-132">This enables the options pattern, the options pattern uses classes to provide strongly typed access to groups of related settings.</span></span>

## <a name="configuration-providers"></a><span data-ttu-id="bca0e-133">Поставщики конфигурации</span><span class="sxs-lookup"><span data-stu-id="bca0e-133">Configuration providers</span></span>

<span data-ttu-id="bca0e-134">В следующей таблице показаны поставщики конфигурации, доступные для приложений .NET Core.</span><span class="sxs-lookup"><span data-stu-id="bca0e-134">The following table shows the configuration providers available to .NET Core apps.</span></span>

| <span data-ttu-id="bca0e-135">Поставщик</span><span class="sxs-lookup"><span data-stu-id="bca0e-135">Provider</span></span>                                                                                                               | <span data-ttu-id="bca0e-136">Предоставляет конфигурацию из</span><span class="sxs-lookup"><span data-stu-id="bca0e-136">Provides configuration from</span></span>        |
|------------------------------------------------------------------------------------------------------------------------|------------------------------------|
| [<span data-ttu-id="bca0e-137">Поставщик конфигурации приложения Azure</span><span class="sxs-lookup"><span data-stu-id="bca0e-137">Azure App configuration provider</span></span>](/azure/azure-app-configuration/quickstart-aspnet-core-app)                          | <span data-ttu-id="bca0e-138">конфигурация приложения Azure;</span><span class="sxs-lookup"><span data-stu-id="bca0e-138">Azure App Configuration</span></span>            |
| [<span data-ttu-id="bca0e-139">Поставщик конфигурации Azure Key Vault</span><span class="sxs-lookup"><span data-stu-id="bca0e-139">Azure Key Vault configuration provider</span></span>](/azure/key-vault/general/tutorial-net-virtual-machine)                        | <span data-ttu-id="bca0e-140">Хранилище ключей Azure;</span><span class="sxs-lookup"><span data-stu-id="bca0e-140">Azure Key Vault</span></span>                    |
| [<span data-ttu-id="bca0e-141">Поставщик конфигурации командной строки</span><span class="sxs-lookup"><span data-stu-id="bca0e-141">Command-line configuration provider</span></span>](configuration-providers.md#command-line-configuration-provider)                  | <span data-ttu-id="bca0e-142">Параметры командной строки</span><span class="sxs-lookup"><span data-stu-id="bca0e-142">Command-line parameters</span></span>            |
| [<span data-ttu-id="bca0e-143">Поставщик пользовательской конфигурации</span><span class="sxs-lookup"><span data-stu-id="bca0e-143">Custom configuration provider</span></span>](custom-configuration-provider.md)                                                      | <span data-ttu-id="bca0e-144">Источник пользователя</span><span class="sxs-lookup"><span data-stu-id="bca0e-144">Custom source</span></span>                      |
| [<span data-ttu-id="bca0e-145">Поставщик конфигурации переменных среды</span><span class="sxs-lookup"><span data-stu-id="bca0e-145">Environment Variables configuration provider</span></span>](configuration-providers.md#environment-variable-configuration-provider) | <span data-ttu-id="bca0e-146">Переменные среды</span><span class="sxs-lookup"><span data-stu-id="bca0e-146">Environment variables</span></span>              |
| [<span data-ttu-id="bca0e-147">Поставщик конфигурации файла</span><span class="sxs-lookup"><span data-stu-id="bca0e-147">File configuration provider</span></span>](configuration-providers.md#file-configuration-provider)                                  | <span data-ttu-id="bca0e-148">Файлы JSON, XML и INI</span><span class="sxs-lookup"><span data-stu-id="bca0e-148">JSON, XML, and INI files</span></span>           |
| [<span data-ttu-id="bca0e-149">Поставщик конфигурации ключа для каждого файла</span><span class="sxs-lookup"><span data-stu-id="bca0e-149">Key-per-file configuration provider</span></span>](configuration-providers.md#key-per-file-configuration-provider)                  | <span data-ttu-id="bca0e-150">справочных файлов;</span><span class="sxs-lookup"><span data-stu-id="bca0e-150">Directory files</span></span>                    |
| [<span data-ttu-id="bca0e-151">Поставщик конфигурации памяти</span><span class="sxs-lookup"><span data-stu-id="bca0e-151">Memory configuration provider</span></span>](configuration-providers.md#memory-configuration-provider)                              | <span data-ttu-id="bca0e-152">Коллекции оперативной памяти</span><span class="sxs-lookup"><span data-stu-id="bca0e-152">In-memory collections</span></span>              |
| [<span data-ttu-id="bca0e-153">Секреты приложения (диспетчер секретов)</span><span class="sxs-lookup"><span data-stu-id="bca0e-153">App secrets (Secret Manager)</span></span>](/aspnet/core/security/app-secrets)                                                      | <span data-ttu-id="bca0e-154">Файл в каталоге профиля пользователя</span><span class="sxs-lookup"><span data-stu-id="bca0e-154">File in the user profile directory</span></span> |

<span data-ttu-id="bca0e-155">Дополнительные сведения о различных поставщиках конфигурации см. в разделе [Поставщики конфигурации в .NET](configuration-providers.md).</span><span class="sxs-lookup"><span data-stu-id="bca0e-155">For more information on various configuration providers, see [Configuration providers in .NET](configuration-providers.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="bca0e-156">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="bca0e-156">See also</span></span>

- [<span data-ttu-id="bca0e-157">Поставщики конфигурации в .NET</span><span class="sxs-lookup"><span data-stu-id="bca0e-157">Configuration providers in .NET</span></span>](configuration-providers.md)
- [<span data-ttu-id="bca0e-158">Реализация пользовательского поставщика конфигурации</span><span class="sxs-lookup"><span data-stu-id="bca0e-158">Implement a custom configuration provider</span></span>](custom-configuration-provider.md)
- <span data-ttu-id="bca0e-159">Ошибки, связанные с конфигурацией, следует создавать в репозитории [github.com/dotnet/extensions](https://github.com/dotnet/extensions/issues)</span><span class="sxs-lookup"><span data-stu-id="bca0e-159">Configuration bugs should be created in the [github.com/dotnet/extensions](https://github.com/dotnet/extensions/issues) repo</span></span>
